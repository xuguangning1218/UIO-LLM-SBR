Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='diginetica', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=43)
model is on gpu
  0%|          | 0/719470 [00:00<?, ?it/s] 22%|██▏       | 159162/719470 [00:00<00:00, 1591541.83it/s] 44%|████▍     | 318317/719470 [00:00<00:00, 855852.24it/s]  67%|██████▋   | 480927/719470 [00:00<00:00, 1095574.90it/s] 85%|████████▍ | 611455/719470 [00:00<00:00, 864671.82it/s] 100%|██████████| 719470/719470 [00:00<00:00, 997992.52it/s]
the number of nodes is :43098
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.046690940856934
CL_Loss:0.15830513834953308
Loss:8.168973922729492
CL_Loss:0.2346045821905136
Loss:6.4526448249816895
CL_Loss:0.1279197335243225
Loss:6.645007133483887
CL_Loss:0.18064118921756744
Loss:5.897111892700195
CL_Loss:0.11115963757038116
Loss:5.866947650909424
CL_Loss:0.18217287957668304
Loss:5.806995391845703
CL_Loss:0.19753994047641754
Loss:5.589933395385742
CL_Loss:0.1965859979391098
-------------------Start Predicting---------------------:  2026-02-08 13:44:34.084371
Results of LocalSession:

Recall@20: 0.5140 Recall@10: 0.3882  Recall@5:0.2789
HiT@20: 0.5140 HiT@10: 0.3882  HiT@5:0.2789
MRR@20:0.1850 MRR@10:0.1762 MRR@5:0.1618


Best Results:

[0.27886226954549936, 0.3882151894574255, 0.5139669394327779, tensor(0.1618), tensor(0.1762), tensor(0.1850, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:4.610721111297607
CL_Loss:0.12243184447288513
Loss:4.866693019866943
CL_Loss:0.23934902250766754
Loss:5.186561584472656
CL_Loss:0.1569744497537613
Loss:5.108560085296631
CL_Loss:0.288102924823761
Loss:4.795957088470459
CL_Loss:0.18909308314323425
Loss:5.703442096710205
CL_Loss:0.30029261112213135
Loss:4.676340103149414
CL_Loss:0.16649745404720306
Loss:5.147287368774414
CL_Loss:0.17799216508865356
-------------------Start Predicting---------------------:  2026-02-08 13:54:46.499968
Results of LocalSession:

Recall@20: 0.5359 Recall@10: 0.4065  Recall@5:0.2929
HiT@20: 0.5359 HiT@10: 0.4065  HiT@5:0.2929
MRR@20:0.1899 MRR@10:0.1809 MRR@5:0.1658


Best Results:

[0.2929442308324296, 0.4064708008807388, 0.5359196818824148, tensor(0.1658), tensor(0.1809), tensor(0.1899, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:4.746884346008301
CL_Loss:0.255557656288147
Loss:4.790879726409912
CL_Loss:0.19445975124835968
Loss:4.881054878234863
CL_Loss:0.16975072026252747
Loss:4.442609786987305
CL_Loss:0.23463644087314606
Loss:5.176438331604004
CL_Loss:0.28077635169029236
Loss:4.871529579162598
CL_Loss:0.21136237680912018
Loss:5.092421531677246
CL_Loss:0.21833781898021698
Loss:4.393169403076172
CL_Loss:0.14264576137065887
-------------------Start Predicting---------------------:  2026-02-08 14:04:01.607845
Results of LocalSession:

Recall@20: 0.5426 Recall@10: 0.4123  Recall@5:0.2966
HiT@20: 0.5426 HiT@10: 0.4123  HiT@5:0.2966
MRR@20:0.1921 MRR@10:0.1831 MRR@5:0.1678


Best Results:

[0.2966084984718525, 0.4123369154425055, 0.5425745177297973, tensor(0.1678), tensor(0.1831), tensor(0.1921, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:4.301448345184326
CL_Loss:0.21542637050151825
Loss:4.643032550811768
CL_Loss:0.2037220001220703
Loss:4.758184432983398
CL_Loss:0.24795429408550262
Loss:4.2914628982543945
CL_Loss:0.26593446731567383
Loss:4.9098615646362305
CL_Loss:0.21152853965759277
Loss:4.541133403778076
CL_Loss:0.1656777411699295
Loss:4.765716075897217
CL_Loss:0.24483272433280945
Loss:4.71348237991333
CL_Loss:0.22776640951633453
-------------------Start Predicting---------------------:  2026-02-08 14:13:14.969700
Results of LocalSession:

Recall@20: 0.5465 Recall@10: 0.4150  Recall@5:0.2966
HiT@20: 0.5465 HiT@10: 0.4150  HiT@5:0.2966
MRR@20:0.1929 MRR@10:0.1838 MRR@5:0.1681


Best Results:

[0.29659206677840216, 0.4149824180880082, 0.5465181241578757, tensor(0.1681), tensor(0.1838), tensor(0.1929, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:4.673424243927002
CL_Loss:0.2964054346084595
Loss:4.625392913818359
CL_Loss:0.18144603073596954
Loss:4.3442063331604
CL_Loss:0.1987004280090332
Loss:4.778378486633301
CL_Loss:0.2540595829486847
Loss:4.706563472747803
CL_Loss:0.30487754940986633
Loss:4.765658378601074
CL_Loss:0.1893044412136078
Loss:4.593661308288574
CL_Loss:0.1524473875761032
Loss:4.623321533203125
CL_Loss:0.19581814110279083
-------------------Start Predicting---------------------:  2026-02-08 14:23:04.289309
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4154  Recall@5:0.2983
HiT@20: 0.5481 HiT@10: 0.4154  HiT@5:0.2983
MRR@20:0.1932 MRR@10:0.1840 MRR@5:0.1685


Best Results:

[0.2983173945906865, 0.415426073811167, 0.5480955667291071, tensor(0.1685), tensor(0.1840), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:4.217765808105469
CL_Loss:0.14098671078681946
Loss:4.043274402618408
CL_Loss:0.14968639612197876
Loss:4.566780090332031
CL_Loss:0.22292689979076385
Loss:4.908886909484863
CL_Loss:0.2667568624019623
Loss:4.914853096008301
CL_Loss:0.1903713494539261
Loss:4.180964946746826
CL_Loss:0.1450132578611374
Loss:4.399491310119629
CL_Loss:0.11559861898422241
Loss:4.684786796569824
CL_Loss:0.19528529047966003
-------------------Start Predicting---------------------:  2026-02-08 14:32:45.080505
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4156  Recall@5:0.2988
HiT@20: 0.5481 HiT@10: 0.4156  HiT@5:0.2988
MRR@20:0.1936 MRR@10:0.1844 MRR@5:0.1689


Best Results:

[0.2983173945906865, 0.415426073811167, 0.5480955667291071, tensor(0.1685), tensor(0.1840), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:4.590643882751465
CL_Loss:0.27601733803749084
Loss:4.668853759765625
CL_Loss:0.19388583302497864
Loss:4.3713603019714355
CL_Loss:0.15250903367996216
Loss:4.500638484954834
CL_Loss:0.15922251343727112
Loss:5.148233890533447
CL_Loss:0.19249697029590607
Loss:4.137736797332764
CL_Loss:0.2814089059829712
Loss:4.705876350402832
CL_Loss:0.17183208465576172
Loss:4.575342655181885
CL_Loss:0.1628277599811554
-------------------Start Predicting---------------------:  2026-02-08 14:41:59.212774
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4149  Recall@5:0.2993
HiT@20: 0.5481 HiT@10: 0.4149  HiT@5:0.2993
MRR@20:0.1934 MRR@10:0.1841 MRR@5:0.1688


Best Results:

[0.2992868645042558, 0.4149002596207565, 0.5481448618094581, tensor(0.1688), tensor(0.1841), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:5.063718795776367
CL_Loss:0.4473802447319031
Loss:4.605633735656738
CL_Loss:0.1423274725675583
Loss:4.304972171783447
CL_Loss:0.10805635899305344
Loss:4.118831634521484
CL_Loss:0.13414044678211212
Loss:4.852135181427002
CL_Loss:0.35781413316726685
Loss:4.626734733581543
CL_Loss:0.1790856570005417
Loss:4.397075653076172
CL_Loss:0.15270404517650604
Loss:4.335251808166504
CL_Loss:0.1482585221529007
-------------------Start Predicting---------------------:  2026-02-08 14:51:10.160888
Results of LocalSession:

Recall@20: 0.5480 Recall@10: 0.4150  Recall@5:0.2990
HiT@20: 0.5480 HiT@10: 0.4150  HiT@5:0.2990
MRR@20:0.1934 MRR@10:0.1842 MRR@5:0.1687


Best Results:

[0.2992868645042558, 0.4149002596207565, 0.5481448618094581, tensor(0.1688), tensor(0.1841), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:4.8926472663879395
CL_Loss:0.3215252161026001
Loss:4.294200897216797
CL_Loss:0.23908798396587372
Loss:4.545356273651123
CL_Loss:0.1706271767616272
Loss:4.895687580108643
CL_Loss:0.3567184507846832
Loss:4.484525680541992
CL_Loss:0.13078711926937103
Loss:4.154273986816406
CL_Loss:0.20703761279582977
Loss:4.601250171661377
CL_Loss:0.18977294862270355
Loss:4.412791728973389
CL_Loss:0.1010221540927887
-------------------Start Predicting---------------------:  2026-02-08 15:00:30.781312
Results of LocalSession:

Recall@20: 0.5482 Recall@10: 0.4150  Recall@5:0.2990
HiT@20: 0.5482 HiT@10: 0.4150  HiT@5:0.2990
MRR@20:0.1934 MRR@10:0.1842 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:4.392026424407959
CL_Loss:0.18241678178310394
Loss:4.070788860321045
CL_Loss:0.1489625722169876
Loss:4.179398536682129
CL_Loss:0.1022808626294136
Loss:4.454769611358643
CL_Loss:0.12794311344623566
Loss:4.508378982543945
CL_Loss:0.19176359474658966
Loss:4.478932857513428
CL_Loss:0.20549696683883667
Loss:4.6539506912231445
CL_Loss:0.17928409576416016
Loss:3.9736437797546387
CL_Loss:0.13805805146694183
-------------------Start Predicting---------------------:  2026-02-08 15:09:44.687893
Results of LocalSession:

Recall@20: 0.5478 Recall@10: 0.4151  Recall@5:0.2990
HiT@20: 0.5478 HiT@10: 0.4151  HiT@5:0.2990
MRR@20:0.1934 MRR@10:0.1841 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:4.197300910949707
CL_Loss:0.13655728101730347
Loss:4.475741863250732
CL_Loss:0.15834207832813263
Loss:4.362415790557861
CL_Loss:0.11807665228843689
Loss:4.134402751922607
CL_Loss:0.12264955043792725
Loss:4.326199531555176
CL_Loss:0.14130380749702454
Loss:4.4603681564331055
CL_Loss:0.20866653323173523
Loss:4.236278057098389
CL_Loss:0.13825909793376923
Loss:4.078832626342773
CL_Loss:0.14005185663700104
-------------------Start Predicting---------------------:  2026-02-08 15:18:50.513171
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4151  Recall@5:0.2991
HiT@20: 0.5476 HiT@10: 0.4151  HiT@5:0.2991
MRR@20:0.1933 MRR@10:0.1841 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:4.5926289558410645
CL_Loss:0.17974704504013062
Loss:4.228636264801025
CL_Loss:0.14377298951148987
Loss:4.206749439239502
CL_Loss:0.1556319147348404
Loss:4.396904468536377
CL_Loss:0.14627276360988617
Loss:4.617610931396484
CL_Loss:0.19461753964424133
Loss:4.574562072753906
CL_Loss:0.1103137731552124
Loss:4.664028644561768
CL_Loss:0.1458546668291092
Loss:4.942380905151367
CL_Loss:0.17554344236850739
-------------------Start Predicting---------------------:  2026-02-08 15:28:28.971368
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4151  Recall@5:0.2991
HiT@20: 0.5476 HiT@10: 0.4151  HiT@5:0.2991
MRR@20:0.1933 MRR@10:0.1841 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:4.0359930992126465
CL_Loss:0.18597857654094696
Loss:5.085102081298828
CL_Loss:0.33979472517967224
Loss:4.508337497711182
CL_Loss:0.14478962123394012
Loss:4.641525745391846
CL_Loss:0.15482032299041748
Loss:4.239473819732666
CL_Loss:0.17197445034980774
Loss:4.4137420654296875
CL_Loss:0.09206206351518631
Loss:4.880056858062744
CL_Loss:0.2661952078342438
Loss:4.752744197845459
CL_Loss:0.30212336778640747
-------------------Start Predicting---------------------:  2026-02-08 15:37:42.883613
Results of LocalSession:

Recall@20: 0.5475 Recall@10: 0.4152  Recall@5:0.2991
HiT@20: 0.5475 HiT@10: 0.4152  HiT@5:0.2991
MRR@20:0.1933 MRR@10:0.1842 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:4.596492767333984
CL_Loss:0.13177309930324554
Loss:4.143107891082764
CL_Loss:0.1918075829744339
Loss:4.429100513458252
CL_Loss:0.2186613380908966
Loss:3.8945059776306152
CL_Loss:0.20450139045715332
Loss:4.470490455627441
CL_Loss:0.12023530900478363
Loss:4.315414905548096
CL_Loss:0.22464141249656677
Loss:4.214298725128174
CL_Loss:0.16713525354862213
Loss:4.3289008140563965
CL_Loss:0.20440512895584106
-------------------Start Predicting---------------------:  2026-02-08 15:46:52.168193
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4153  Recall@5:0.2990
HiT@20: 0.5476 HiT@10: 0.4153  HiT@5:0.2990
MRR@20:0.1933 MRR@10:0.1841 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:4.393693923950195
CL_Loss:0.2475559562444687
Loss:4.103257656097412
CL_Loss:0.14958278834819794
Loss:4.176150321960449
CL_Loss:0.17160968482494354
Loss:4.764593124389648
CL_Loss:0.21200445294380188
Loss:4.256180763244629
CL_Loss:0.18861354887485504
Loss:4.038112640380859
CL_Loss:0.11944425106048584
Loss:4.1631903648376465
CL_Loss:0.20985503494739532
Loss:4.415632724761963
CL_Loss:0.17514462769031525
-------------------Start Predicting---------------------:  2026-02-08 15:56:25.426994
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4152  Recall@5:0.2990
HiT@20: 0.5476 HiT@10: 0.4152  HiT@5:0.2990
MRR@20:0.1933 MRR@10:0.1842 MRR@5:0.1687


Best Results:

[0.2989582306352493, 0.41496598639455784, 0.5482105885832594, tensor(0.1687), tensor(0.1842), tensor(0.1934, device='cuda:0')]
