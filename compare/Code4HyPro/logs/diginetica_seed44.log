Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='diginetica', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=44)
model is on gpu
  0%|          | 0/719470 [00:00<?, ?it/s] 22%|██▏       | 161839/719470 [00:00<00:00, 1618329.81it/s] 45%|████▍     | 323672/719470 [00:00<00:00, 935729.59it/s]  66%|██████▌   | 475345/719470 [00:00<00:00, 1125706.54it/s] 84%|████████▍ | 603901/719470 [00:00<00:00, 854685.58it/s] 100%|██████████| 719470/719470 [00:00<00:00, 1008594.66it/s]
the number of nodes is :43098
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.62845230102539
CL_Loss:0.17875099182128906
Loss:8.655782699584961
CL_Loss:0.20444068312644958
Loss:7.496574401855469
CL_Loss:0.4276586174964905
Loss:6.032118797302246
CL_Loss:0.16827091574668884
Loss:6.322894096374512
CL_Loss:0.2699448764324188
Loss:5.853306293487549
CL_Loss:0.28227290511131287
Loss:5.23127555847168
CL_Loss:0.15680091083049774
Loss:5.28718376159668
CL_Loss:0.2572539150714874
-------------------Start Predicting---------------------:  2026-02-08 16:05:58.544374
Results of LocalSession:

Recall@20: 0.5148 Recall@10: 0.3897  Recall@5:0.2787
HiT@20: 0.5148 HiT@10: 0.3897  HiT@5:0.2787
MRR@20:0.1835 MRR@10:0.1748 MRR@5:0.1601


Best Results:

[0.2787143843044464, 0.3897433369483059, 0.514772092411844, tensor(0.1601), tensor(0.1748), tensor(0.1835, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:5.037692070007324
CL_Loss:0.25357726216316223
Loss:4.30847692489624
CL_Loss:0.1923033446073532
Loss:4.623639106750488
CL_Loss:0.1361609548330307
Loss:4.422573089599609
CL_Loss:0.31374430656433105
Loss:5.231132984161377
CL_Loss:0.19543391466140747
Loss:4.692677974700928
CL_Loss:0.12010034918785095
Loss:4.976163864135742
CL_Loss:0.19731244444847107
Loss:4.827857494354248
CL_Loss:0.17765231430530548
-------------------Start Predicting---------------------:  2026-02-08 16:16:09.247996
Results of LocalSession:

Recall@20: 0.5350 Recall@10: 0.4062  Recall@5:0.2907
HiT@20: 0.5350 HiT@10: 0.4062  HiT@5:0.2907
MRR@20:0.1896 MRR@10:0.1807 MRR@5:0.1654


Best Results:

[0.2907423839100858, 0.40619146209208323, 0.5350488021295474, tensor(0.1654), tensor(0.1807), tensor(0.1896, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:4.599040985107422
CL_Loss:0.16878095269203186
Loss:4.495527744293213
CL_Loss:0.22157934308052063
Loss:4.698633670806885
CL_Loss:0.15638086199760437
Loss:4.417934894561768
CL_Loss:0.17174819111824036
Loss:5.11058235168457
CL_Loss:0.2893202602863312
Loss:4.369596004486084
CL_Loss:0.14480389654636383
Loss:4.859809875488281
CL_Loss:0.22675821185112
Loss:4.660717964172363
CL_Loss:0.1831614226102829
-------------------Start Predicting---------------------:  2026-02-08 16:25:27.938045
Results of LocalSession:

Recall@20: 0.5438 Recall@10: 0.4108  Recall@5:0.2949
HiT@20: 0.5438 HiT@10: 0.4108  HiT@5:0.2949
MRR@20:0.1916 MRR@10:0.1824 MRR@5:0.1670


Best Results:

[0.29486673896611787, 0.4107594728712741, 0.5438397581254724, tensor(0.1670), tensor(0.1824), tensor(0.1916, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:4.373875617980957
CL_Loss:0.1913025975227356
Loss:4.753512382507324
CL_Loss:0.22109144926071167
Loss:4.6465983390808105
CL_Loss:0.2200065404176712
Loss:4.401689052581787
CL_Loss:0.1499522626399994
Loss:4.876462936401367
CL_Loss:0.18434984982013702
Loss:4.841689109802246
CL_Loss:0.11840089410543442
Loss:4.557438373565674
CL_Loss:0.2112453430891037
Loss:5.06669807434082
CL_Loss:0.19520241022109985
-------------------Start Predicting---------------------:  2026-02-08 16:34:35.073707
Results of LocalSession:

Recall@20: 0.5461 Recall@10: 0.4143  Recall@5:0.2973
HiT@20: 0.5461 HiT@10: 0.4143  HiT@5:0.2973
MRR@20:0.1924 MRR@10:0.1832 MRR@5:0.1678


Best Results:

[0.29734792467711724, 0.4142758552696441, 0.5460580367412665, tensor(0.1678), tensor(0.1832), tensor(0.1924, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:4.52694845199585
CL_Loss:0.0999622493982315
Loss:4.569865703582764
CL_Loss:0.16348788142204285
Loss:4.11598014831543
CL_Loss:0.1269228458404541
Loss:4.650625705718994
CL_Loss:0.1555343121290207
Loss:4.622048854827881
CL_Loss:0.20343638956546783
Loss:4.932172775268555
CL_Loss:0.25720205903053284
Loss:4.976664066314697
CL_Loss:0.1781798154115677
Loss:4.74702262878418
CL_Loss:0.18658475577831268
-------------------Start Predicting---------------------:  2026-02-08 16:43:44.094730
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4146  Recall@5:0.2978
HiT@20: 0.5476 HiT@10: 0.4146  HiT@5:0.2978
MRR@20:0.1928 MRR@10:0.1836 MRR@5:0.1681


Best Results:

[0.2977751487068257, 0.41455519405829966, 0.547586184232147, tensor(0.1681), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:4.533639907836914
CL_Loss:0.1979006975889206
Loss:4.36965799331665
CL_Loss:0.22036835551261902
Loss:3.9277427196502686
CL_Loss:0.1227307841181755
Loss:4.2993621826171875
CL_Loss:0.1711738109588623
Loss:4.335778713226318
CL_Loss:0.15634863078594208
Loss:4.32600736618042
CL_Loss:0.16677208244800568
Loss:4.4589433670043945
CL_Loss:0.26775985956192017
Loss:4.603250503540039
CL_Loss:0.292948454618454
-------------------Start Predicting---------------------:  2026-02-08 16:52:49.241652
Results of LocalSession:

Recall@20: 0.5483 Recall@10: 0.4140  Recall@5:0.2981
HiT@20: 0.5483 HiT@10: 0.4140  HiT@5:0.2981
MRR@20:0.1933 MRR@10:0.1840 MRR@5:0.1686


Best Results:

[0.29807091918893164, 0.4139800847875382, 0.548292747050511, tensor(0.1686), tensor(0.1840), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:4.3439178466796875
CL_Loss:0.1977253258228302
Loss:4.2812323570251465
CL_Loss:0.24469412863254547
Loss:4.6341118812561035
CL_Loss:0.1686014086008072
Loss:4.316680908203125
CL_Loss:0.1729949563741684
Loss:4.590451717376709
CL_Loss:0.20546187460422516
Loss:4.5008039474487305
CL_Loss:0.12365744262933731
Loss:4.101711750030518
CL_Loss:0.10785412788391113
Loss:4.357001304626465
CL_Loss:0.23153023421764374
-------------------Start Predicting---------------------:  2026-02-08 17:02:00.143546
Results of LocalSession:

Recall@20: 0.5488 Recall@10: 0.4137  Recall@5:0.2985
HiT@20: 0.5488 HiT@10: 0.4137  HiT@5:0.2985
MRR@20:0.1932 MRR@10:0.1838 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:4.888923645019531
CL_Loss:0.2881414294242859
Loss:4.12246036529541
CL_Loss:0.1164795309305191
Loss:4.378921985626221
CL_Loss:0.17877525091171265
Loss:4.385396957397461
CL_Loss:0.1509454995393753
Loss:4.367314338684082
CL_Loss:0.12902449071407318
Loss:4.281895160675049
CL_Loss:0.20223219692707062
Loss:4.901010036468506
CL_Loss:0.2619800567626953
Loss:4.138424396514893
CL_Loss:0.15376481413841248
-------------------Start Predicting---------------------:  2026-02-08 17:12:07.758347
Results of LocalSession:

Recall@20: 0.5487 Recall@10: 0.4141  Recall@5:0.2986
HiT@20: 0.5487 HiT@10: 0.4141  HiT@5:0.2986
MRR@20:0.1933 MRR@10:0.1840 MRR@5:0.1686


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:4.690182685852051
CL_Loss:0.20510214567184448
Loss:4.557018756866455
CL_Loss:0.09717056155204773
Loss:4.19173526763916
CL_Loss:0.14696872234344482
Loss:4.835517883300781
CL_Loss:0.21534010767936707
Loss:4.378201007843018
CL_Loss:0.21118804812431335
Loss:4.981617450714111
CL_Loss:0.19229380786418915
Loss:4.398005962371826
CL_Loss:0.18641112744808197
Loss:4.433139801025391
CL_Loss:0.16104575991630554
-------------------Start Predicting---------------------:  2026-02-08 17:22:16.877318
Results of LocalSession:

Recall@20: 0.5486 Recall@10: 0.4142  Recall@5:0.2985
HiT@20: 0.5486 HiT@10: 0.4142  HiT@5:0.2985
MRR@20:0.1932 MRR@10:0.1838 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:4.09744930267334
CL_Loss:0.14621692895889282
Loss:4.727968215942383
CL_Loss:0.2165832668542862
Loss:4.068665027618408
CL_Loss:0.11785924434661865
Loss:4.70363187789917
CL_Loss:0.30514711141586304
Loss:4.385380744934082
CL_Loss:0.17985652387142181
Loss:4.445425510406494
CL_Loss:0.09509077668190002
Loss:4.812134742736816
CL_Loss:0.16466327011585236
Loss:4.169349193572998
CL_Loss:0.08615447580814362
-------------------Start Predicting---------------------:  2026-02-08 17:31:30.854298
Results of LocalSession:

Recall@20: 0.5486 Recall@10: 0.4141  Recall@5:0.2985
HiT@20: 0.5486 HiT@10: 0.4141  HiT@5:0.2985
MRR@20:0.1932 MRR@10:0.1839 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:4.303334712982178
CL_Loss:0.23857977986335754
Loss:4.062813758850098
CL_Loss:0.10881742089986801
Loss:4.114166259765625
CL_Loss:0.1435810625553131
Loss:4.429399490356445
CL_Loss:0.20503993332386017
Loss:4.621496677398682
CL_Loss:0.1803613305091858
Loss:4.363089084625244
CL_Loss:0.14000247418880463
Loss:4.553866863250732
CL_Loss:0.18778091669082642
Loss:4.467382907867432
CL_Loss:0.23126186430454254
-------------------Start Predicting---------------------:  2026-02-08 17:40:43.016140
Results of LocalSession:

Recall@20: 0.5486 Recall@10: 0.4141  Recall@5:0.2985
HiT@20: 0.5486 HiT@10: 0.4141  HiT@5:0.2985
MRR@20:0.1933 MRR@10:0.1839 MRR@5:0.1686


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:4.297257423400879
CL_Loss:0.19613046944141388
Loss:4.371249198913574
CL_Loss:0.15346117317676544
Loss:4.488804817199707
CL_Loss:0.21569165587425232
Loss:4.519797325134277
CL_Loss:0.19344741106033325
Loss:3.984954833984375
CL_Loss:0.1984306275844574
Loss:4.840732097625732
CL_Loss:0.20565307140350342
Loss:4.379334926605225
CL_Loss:0.12397212535142899
Loss:4.358380317687988
CL_Loss:0.1908813863992691
-------------------Start Predicting---------------------:  2026-02-08 17:49:54.206383
Results of LocalSession:

Recall@20: 0.5486 Recall@10: 0.4143  Recall@5:0.2984
HiT@20: 0.5486 HiT@10: 0.4143  HiT@5:0.2984
MRR@20:0.1932 MRR@10:0.1839 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:3.940631151199341
CL_Loss:0.14409799873828888
Loss:4.70767879486084
CL_Loss:0.2450646609067917
Loss:4.286489486694336
CL_Loss:0.13541293144226074
Loss:4.385201930999756
CL_Loss:0.11635732650756836
Loss:4.3888397216796875
CL_Loss:0.1938769817352295
Loss:4.33193302154541
CL_Loss:0.16217085719108582
Loss:4.8482866287231445
CL_Loss:0.21691657602787018
Loss:4.505027770996094
CL_Loss:0.137716144323349
-------------------Start Predicting---------------------:  2026-02-08 17:59:03.211471
Results of LocalSession:

Recall@20: 0.5487 Recall@10: 0.4142  Recall@5:0.2984
HiT@20: 0.5487 HiT@10: 0.4142  HiT@5:0.2984
MRR@20:0.1932 MRR@10:0.1839 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:3.8243064880371094
CL_Loss:0.1031501442193985
Loss:4.4067792892456055
CL_Loss:0.14296530187129974
Loss:4.456836700439453
CL_Loss:0.14934080839157104
Loss:3.9817662239074707
CL_Loss:0.10227899253368378
Loss:4.433724880218506
CL_Loss:0.2089906632900238
Loss:4.547887325286865
CL_Loss:0.1410057246685028
Loss:4.459229469299316
CL_Loss:0.15903066098690033
Loss:4.519315719604492
CL_Loss:0.27403703331947327
-------------------Start Predicting---------------------:  2026-02-08 18:09:26.894011
Results of LocalSession:

Recall@20: 0.5487 Recall@10: 0.4142  Recall@5:0.2984
HiT@20: 0.5487 HiT@10: 0.4142  HiT@5:0.2984
MRR@20:0.1933 MRR@10:0.1839 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:4.54689359664917
CL_Loss:0.2686859667301178
Loss:4.228989124298096
CL_Loss:0.09282998740673065
Loss:4.60435676574707
CL_Loss:0.1838584989309311
Loss:4.254419803619385
CL_Loss:0.13539791107177734
Loss:4.581207752227783
CL_Loss:0.2513284683227539
Loss:4.150643825531006
CL_Loss:0.10706204921007156
Loss:4.461544990539551
CL_Loss:0.21621394157409668
Loss:4.266960144042969
CL_Loss:0.13624030351638794
-------------------Start Predicting---------------------:  2026-02-08 18:18:33.302929
Results of LocalSession:

Recall@20: 0.5486 Recall@10: 0.4142  Recall@5:0.2984
HiT@20: 0.5486 HiT@10: 0.4142  HiT@5:0.2984
MRR@20:0.1933 MRR@10:0.1839 MRR@5:0.1685


Best Results:

[0.2984652798317395, 0.4137336093857833, 0.5488349929343718, tensor(0.1685), tensor(0.1838), tensor(0.1932, device='cuda:0')]
