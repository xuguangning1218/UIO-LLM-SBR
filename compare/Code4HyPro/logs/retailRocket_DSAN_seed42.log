Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='retailRocket_DSAN', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=42)
model is on gpu
  0%|          | 0/433648 [00:00<?, ?it/s] 23%|██▎       | 98387/433648 [00:00<00:00, 442290.49it/s] 46%|████▌     | 199176/433648 [00:00<00:00, 662737.21it/s] 68%|██████▊   | 294340/433648 [00:00<00:00, 766204.50it/s] 88%|████████▊ | 379813/433648 [00:00<00:00, 626680.26it/s]100%|██████████| 433648/433648 [00:00<00:00, 672134.42it/s]
the number of nodes is :36969
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:16.93459701538086
CL_Loss:3.271987199783325
Loss:10.699601173400879
CL_Loss:3.329132556915283
Loss:10.298318862915039
CL_Loss:3.0592195987701416
Loss:9.019091606140137
CL_Loss:3.127976655960083
Loss:9.24675178527832
CL_Loss:3.5556983947753906
-------------------Start Predicting---------------------:  2026-02-08 18:36:07.030485
Results of LocalSession:

Recall@20: 0.5282 Recall@10: 0.4717  Recall@5:0.4089
HiT@20: 0.5282 HiT@10: 0.4717  HiT@5:0.4089
MRR@20:0.3013 MRR@10:0.2973 MRR@5:0.2888


Best Results:

[0.40886862278614855, 0.471715569653714, 0.528152260111023, tensor(0.2888), tensor(0.2973), tensor(0.3013, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.638525009155273
CL_Loss:3.2640583515167236
Loss:7.238415718078613
CL_Loss:2.874315023422241
Loss:8.080046653747559
CL_Loss:3.037296772003174
Loss:7.706378936767578
CL_Loss:3.0835399627685547
Loss:7.9792280197143555
CL_Loss:2.8347628116607666
-------------------Start Predicting---------------------:  2026-02-08 18:52:40.923442
Results of LocalSession:

Recall@20: 0.5515 Recall@10: 0.4870  Recall@5:0.4200
HiT@20: 0.5515 HiT@10: 0.4870  HiT@5:0.4200
MRR@20:0.3021 MRR@10:0.2976 MRR@5:0.2886


Best Results:

[0.42003700766587365, 0.48704731694422415, 0.5514803066349458, tensor(0.2886), tensor(0.2976), tensor(0.3021, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.880005836486816
CL_Loss:2.952547550201416
Loss:8.121011734008789
CL_Loss:3.2497670650482178
Loss:7.105525970458984
CL_Loss:2.8740146160125732
Loss:7.580582618713379
CL_Loss:3.0335419178009033
Loss:7.108671188354492
CL_Loss:3.051461935043335
-------------------Start Predicting---------------------:  2026-02-08 19:09:22.450415
Results of LocalSession:

Recall@20: 0.5595 Recall@10: 0.4898  Recall@5:0.4185
HiT@20: 0.5595 HiT@10: 0.4898  HiT@5:0.4185
MRR@20:0.3040 MRR@10:0.2992 MRR@5:0.2896


Best Results:

[0.41851704996034894, 0.489756806767116, 0.5594766058683585, tensor(0.2896), tensor(0.2992), tensor(0.3040, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.515572547912598
CL_Loss:3.370065212249756
Loss:6.787358283996582
CL_Loss:3.123706579208374
Loss:6.429150581359863
CL_Loss:2.851621627807617
Loss:6.7633867263793945
CL_Loss:2.8772192001342773
Loss:7.125430107116699
CL_Loss:2.9797699451446533
-------------------Start Predicting---------------------:  2026-02-08 19:27:24.708201
Results of LocalSession:

Recall@20: 0.5620 Recall@10: 0.4925  Recall@5:0.4200
HiT@20: 0.5620 HiT@10: 0.4925  HiT@5:0.4200
MRR@20:0.3032 MRR@10:0.2984 MRR@5:0.2885


Best Results:

[0.42003700766587365, 0.49246629659000796, 0.5619878403383558, tensor(0.2885), tensor(0.2984), tensor(0.3032, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.425459384918213
CL_Loss:2.715172290802002
Loss:6.654569625854492
CL_Loss:2.70529842376709
Loss:7.289380073547363
CL_Loss:2.900367021560669
Loss:6.807215690612793
CL_Loss:2.7706854343414307
Loss:6.866879940032959
CL_Loss:3.1603665351867676
-------------------Start Predicting---------------------:  2026-02-08 19:46:06.974450
Results of LocalSession:

Recall@20: 0.5638 Recall@10: 0.4935  Recall@5:0.4198
HiT@20: 0.5638 HiT@10: 0.4935  HiT@5:0.4198
MRR@20:0.3050 MRR@10:0.3002 MRR@5:0.2902


Best Results:

[0.4197726671953476, 0.4935236584721121, 0.5638382236320381, tensor(0.2902), tensor(0.3002), tensor(0.3050, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:7.473599433898926
CL_Loss:3.139963388442993
Loss:7.715676307678223
CL_Loss:3.1872880458831787
Loss:6.630449295043945
CL_Loss:2.935542345046997
Loss:6.827044486999512
CL_Loss:2.9069883823394775
Loss:7.20503568649292
CL_Loss:3.1505632400512695
-------------------Start Predicting---------------------:  2026-02-08 20:04:12.521431
Results of LocalSession:

Recall@20: 0.5642 Recall@10: 0.4943  Recall@5:0.4190
HiT@20: 0.5642 HiT@10: 0.4943  HiT@5:0.4190
MRR@20:0.3047 MRR@10:0.2999 MRR@5:0.2896


Best Results:

[0.4189796457837695, 0.4942505947660587, 0.5641686492201956, tensor(0.2896), tensor(0.2999), tensor(0.3047, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.583137035369873
CL_Loss:2.782095193862915
Loss:7.021160125732422
CL_Loss:3.017916202545166
Loss:7.5162835121154785
CL_Loss:3.0037660598754883
Loss:6.925512790679932
CL_Loss:2.70725154876709
Loss:7.47191047668457
CL_Loss:3.3019585609436035
-------------------Start Predicting---------------------:  2026-02-08 20:22:10.236428
Results of LocalSession:

Recall@20: 0.5642 Recall@10: 0.4937  Recall@5:0.4197
HiT@20: 0.5642 HiT@10: 0.4937  HiT@5:0.4197
MRR@20:0.3049 MRR@10:0.3001 MRR@5:0.2900


Best Results:

[0.4197065820777161, 0.49372191382500663, 0.5642347343378271, tensor(0.2900), tensor(0.3001), tensor(0.3049, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.60791540145874
CL_Loss:3.072429656982422
Loss:6.746607780456543
CL_Loss:2.815570116043091
Loss:7.446772575378418
CL_Loss:3.255216598510742
Loss:6.853475093841553
CL_Loss:2.791926860809326
Loss:7.036699295043945
CL_Loss:2.954129457473755
-------------------Start Predicting---------------------:  2026-02-08 20:40:15.036738
Results of LocalSession:

Recall@20: 0.5642 Recall@10: 0.4933  Recall@5:0.4199
HiT@20: 0.5642 HiT@10: 0.4933  HiT@5:0.4199
MRR@20:0.3047 MRR@10:0.2998 MRR@5:0.2898


Best Results:

[0.4197065820777161, 0.49372191382500663, 0.5642347343378271, tensor(0.2900), tensor(0.3001), tensor(0.3049, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.670222282409668
CL_Loss:2.8372926712036133
Loss:7.119847297668457
CL_Loss:3.1008410453796387
Loss:6.415759086608887
CL_Loss:2.7941627502441406
Loss:6.631035804748535
CL_Loss:2.8440184593200684
Loss:6.512889862060547
CL_Loss:2.703655242919922
-------------------Start Predicting---------------------:  2026-02-08 20:57:19.837908
Results of LocalSession:

Recall@20: 0.5650 Recall@10: 0.4935  Recall@5:0.4196
HiT@20: 0.5650 HiT@10: 0.4935  HiT@5:0.4196
MRR@20:0.3043 MRR@10:0.2993 MRR@5:0.2893


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.301511764526367
CL_Loss:2.657517671585083
Loss:6.766424179077148
CL_Loss:3.090289831161499
Loss:6.864251136779785
CL_Loss:2.8469560146331787
Loss:6.59390926361084
CL_Loss:2.912252187728882
Loss:6.681321144104004
CL_Loss:2.813894033432007
-------------------Start Predicting---------------------:  2026-02-08 21:14:09.894999
Results of LocalSession:

Recall@20: 0.5644 Recall@10: 0.4932  Recall@5:0.4196
HiT@20: 0.5644 HiT@10: 0.4932  HiT@5:0.4196
MRR@20:0.3046 MRR@10:0.2997 MRR@5:0.2897


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.334362030029297
CL_Loss:2.560637950897217
Loss:6.364681243896484
CL_Loss:2.8282876014709473
Loss:6.443997383117676
CL_Loss:2.855506420135498
Loss:6.1497697830200195
CL_Loss:2.7101151943206787
Loss:7.230923652648926
CL_Loss:3.0105559825897217
-------------------Start Predicting---------------------:  2026-02-08 21:32:43.857885
Results of LocalSession:

Recall@20: 0.5647 Recall@10: 0.4935  Recall@5:0.4196
HiT@20: 0.5647 HiT@10: 0.4935  HiT@5:0.4196
MRR@20:0.3045 MRR@10:0.2996 MRR@5:0.2896


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.789024829864502
CL_Loss:2.9762468338012695
Loss:6.1749420166015625
CL_Loss:2.5596718788146973
Loss:7.147134780883789
CL_Loss:3.0402863025665283
Loss:6.346521377563477
CL_Loss:2.659776210784912
Loss:6.951394557952881
CL_Loss:2.983633279800415
-------------------Start Predicting---------------------:  2026-02-08 21:51:38.665612
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4935  Recall@5:0.4196
HiT@20: 0.5648 HiT@10: 0.4935  HiT@5:0.4196
MRR@20:0.3047 MRR@10:0.2998 MRR@5:0.2897


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:5.975299835205078
CL_Loss:2.5399973392486572
Loss:6.741003036499023
CL_Loss:2.9134328365325928
Loss:7.229918003082275
CL_Loss:2.9204092025756836
Loss:6.407656669616699
CL_Loss:2.828403949737549
Loss:6.229177474975586
CL_Loss:2.487668514251709
-------------------Start Predicting---------------------:  2026-02-08 22:09:05.930057
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4937  Recall@5:0.4197
HiT@20: 0.5648 HiT@10: 0.4937  HiT@5:0.4197
MRR@20:0.3048 MRR@10:0.2999 MRR@5:0.2898


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.7113237380981445
CL_Loss:2.8495161533355713
Loss:6.784599781036377
CL_Loss:3.008309841156006
Loss:6.511853218078613
CL_Loss:2.845693588256836
Loss:7.5312700271606445
CL_Loss:3.114210844039917
Loss:6.523871421813965
CL_Loss:2.688019275665283
-------------------Start Predicting---------------------:  2026-02-08 22:27:24.564648
Results of LocalSession:

Recall@20: 0.5647 Recall@10: 0.4937  Recall@5:0.4197
HiT@20: 0.5647 HiT@10: 0.4937  HiT@5:0.4197
MRR@20:0.3049 MRR@10:0.3000 MRR@5:0.2899


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.700886249542236
CL_Loss:2.812992572784424
Loss:6.311593055725098
CL_Loss:2.866746425628662
Loss:6.126686096191406
CL_Loss:2.535299062728882
Loss:6.845090389251709
CL_Loss:2.875976085662842
Loss:6.114404678344727
CL_Loss:2.680070638656616
-------------------Start Predicting---------------------:  2026-02-08 22:45:59.547387
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4937  Recall@5:0.4194
HiT@20: 0.5648 HiT@10: 0.4937  HiT@5:0.4194
MRR@20:0.3049 MRR@10:0.3000 MRR@5:0.2899


Best Results:

[0.4196404969600846, 0.4935236584721121, 0.5649616706317737, tensor(0.2893), tensor(0.2993), tensor(0.3043, device='cuda:0')]
