Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Tmall', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=43)
model is on gpu
  0%|          | 0/351268 [00:00<?, ?it/s] 15%|█▍        | 52519/351268 [00:00<00:00, 525170.47it/s] 48%|████▊     | 169776/351268 [00:00<00:00, 682506.21it/s] 87%|████████▋ | 303953/351268 [00:00<00:00, 938054.62it/s]100%|██████████| 351268/351268 [00:00<00:00, 892563.30it/s]
the number of nodes is :40728
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:16.495681762695312
CL_Loss:2.330868721008301
Loss:9.832204818725586
CL_Loss:2.3288583755493164
Loss:9.057747840881348
CL_Loss:2.1444571018218994
Loss:9.63382339477539
CL_Loss:2.2419188022613525
-------------------Start Predicting---------------------:  2026-02-09 07:00:20.216150
Results of LocalSession:

Recall@20: 0.3795 Recall@10: 0.3324  Recall@5:0.2738
HiT@20: 0.3795 HiT@10: 0.3324  HiT@5:0.2738
MRR@20:0.1906 MRR@10:0.1873 MRR@5:0.1794


Best Results:

[0.2738435400417021, 0.33241949185265274, 0.3795273766314001, tensor(0.1794), tensor(0.1873), tensor(0.1906, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.329730033874512
CL_Loss:2.4406845569610596
Loss:8.352128982543945
CL_Loss:2.4454116821289062
Loss:7.7867584228515625
CL_Loss:2.2696807384490967
Loss:8.174371719360352
CL_Loss:2.4615395069122314
-------------------Start Predicting---------------------:  2026-02-09 07:04:26.824528
Results of LocalSession:

Recall@20: 0.3918 Recall@10: 0.3366  Recall@5:0.2724
HiT@20: 0.3918 HiT@10: 0.3366  HiT@5:0.2724
MRR@20:0.1889 MRR@10:0.1850 MRR@5:0.1764


Best Results:

[0.272376245269905, 0.3365510850258707, 0.3918063170901228, tensor(0.1764), tensor(0.1850), tensor(0.1889, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:7.271156311035156
CL_Loss:2.42594313621521
Loss:6.563505172729492
CL_Loss:2.233025312423706
Loss:7.460980415344238
CL_Loss:2.532060384750366
Loss:7.266229152679443
CL_Loss:2.2448477745056152
-------------------Start Predicting---------------------:  2026-02-09 07:08:32.405277
Results of LocalSession:

Recall@20: 0.3966 Recall@10: 0.3385  Recall@5:0.2710
HiT@20: 0.3966 HiT@10: 0.3385  HiT@5:0.2710
MRR@20:0.1881 MRR@10:0.1840 MRR@5:0.1750


Best Results:

[0.2710247895590393, 0.3385203490617036, 0.39655571858830796, tensor(0.1750), tensor(0.1840), tensor(0.1881, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.185487270355225
CL_Loss:2.385438919067383
Loss:6.998091697692871
CL_Loss:2.3380119800567627
Loss:6.747346878051758
CL_Loss:2.30501389503479
Loss:7.585199356079102
CL_Loss:2.4916880130767822
-------------------Start Predicting---------------------:  2026-02-09 07:12:39.080005
Results of LocalSession:

Recall@20: 0.3994 Recall@10: 0.3375  Recall@5:0.2717
HiT@20: 0.3994 HiT@10: 0.3375  HiT@5:0.2717
MRR@20:0.1873 MRR@10:0.1830 MRR@5:0.1742


Best Results:

[0.27168121090431696, 0.33751641053363196, 0.3994130820912812, tensor(0.1742), tensor(0.1830), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.571981430053711
CL_Loss:2.31414794921875
Loss:6.886219024658203
CL_Loss:2.2493813037872314
Loss:7.152736663818359
CL_Loss:2.321904182434082
Loss:6.866142272949219
CL_Loss:2.3793747425079346
-------------------Start Predicting---------------------:  2026-02-09 07:16:45.010971
Results of LocalSession:

Recall@20: 0.3989 Recall@10: 0.3385  Recall@5:0.2701
HiT@20: 0.3989 HiT@10: 0.3385  HiT@5:0.2701
MRR@20:0.1865 MRR@10:0.1823 MRR@5:0.1731


Best Results:

[0.27168121090431696, 0.33751641053363196, 0.3994130820912812, tensor(0.1742), tensor(0.1830), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.398639678955078
CL_Loss:2.409464120864868
Loss:7.003178596496582
CL_Loss:2.646453380584717
Loss:7.362995147705078
CL_Loss:2.440117120742798
Loss:6.961085319519043
CL_Loss:2.575089693069458
-------------------Start Predicting---------------------:  2026-02-09 07:20:50.682998
Results of LocalSession:

Recall@20: 0.3988 Recall@10: 0.3378  Recall@5:0.2698
HiT@20: 0.3988 HiT@10: 0.3378  HiT@5:0.2698
MRR@20:0.1863 MRR@10:0.1821 MRR@5:0.1729


Best Results:

[0.27168121090431696, 0.33751641053363196, 0.3994130820912812, tensor(0.1742), tensor(0.1830), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:5.826344966888428
CL_Loss:2.1749420166015625
Loss:6.856216907501221
CL_Loss:2.452162265777588
Loss:6.711243629455566
CL_Loss:2.5794692039489746
Loss:6.525300979614258
CL_Loss:2.202336311340332
-------------------Start Predicting---------------------:  2026-02-09 07:24:55.534348
Results of LocalSession:

Recall@20: 0.3994 Recall@10: 0.3379  Recall@5:0.2696
HiT@20: 0.3994 HiT@10: 0.3379  HiT@5:0.2696
MRR@20:0.1863 MRR@10:0.1820 MRR@5:0.1728


Best Results:

[0.27168121090431696, 0.33751641053363196, 0.3994130820912812, tensor(0.1742), tensor(0.1830), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.284552574157715
CL_Loss:2.337188482284546
Loss:6.753796100616455
CL_Loss:2.378568649291992
Loss:6.863748550415039
CL_Loss:2.5011065006256104
Loss:5.998899936676025
CL_Loss:2.0970659255981445
-------------------Start Predicting---------------------:  2026-02-09 07:29:03.983107
Results of LocalSession:

Recall@20: 0.3999 Recall@10: 0.3374  Recall@5:0.2695
HiT@20: 0.3999 HiT@10: 0.3374  HiT@5:0.2695
MRR@20:0.1863 MRR@10:0.1819 MRR@5:0.1728


Best Results:

[0.26948026874662134, 0.33736195845239014, 0.3998764383350066, tensor(0.1728), tensor(0.1819), tensor(0.1863, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.996562957763672
CL_Loss:2.3250436782836914
Loss:6.583850383758545
CL_Loss:2.376004695892334
Loss:6.487838268280029
CL_Loss:2.334585189819336
Loss:7.106334686279297
CL_Loss:2.5197691917419434
-------------------Start Predicting---------------------:  2026-02-09 07:33:10.775732
Results of LocalSession:

Recall@20: 0.3996 Recall@10: 0.3379  Recall@5:0.2696
HiT@20: 0.3996 HiT@10: 0.3379  HiT@5:0.2696
MRR@20:0.1864 MRR@10:0.1821 MRR@5:0.1729


Best Results:

[0.26948026874662134, 0.33736195845239014, 0.3998764383350066, tensor(0.1728), tensor(0.1819), tensor(0.1863, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.662668228149414
CL_Loss:2.2525577545166016
Loss:6.654081344604492
CL_Loss:2.1906955242156982
Loss:6.484317779541016
CL_Loss:2.223417043685913
Loss:6.30367374420166
CL_Loss:2.3325743675231934
-------------------Start Predicting---------------------:  2026-02-09 07:37:15.632285
Results of LocalSession:

Recall@20: 0.4000 Recall@10: 0.3376  Recall@5:0.2692
HiT@20: 0.4000 HiT@10: 0.3376  HiT@5:0.2692
MRR@20:0.1862 MRR@10:0.1819 MRR@5:0.1727


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.222925186157227
CL_Loss:2.438783645629883
Loss:6.391284942626953
CL_Loss:2.2981927394866943
Loss:6.229294776916504
CL_Loss:2.362196683883667
Loss:6.214620113372803
CL_Loss:2.220118761062622
-------------------Start Predicting---------------------:  2026-02-09 07:41:25.768966
Results of LocalSession:

Recall@20: 0.4000 Recall@10: 0.3377  Recall@5:0.2692
HiT@20: 0.4000 HiT@10: 0.3377  HiT@5:0.2692
MRR@20:0.1863 MRR@10:0.1819 MRR@5:0.1727


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.395958423614502
CL_Loss:2.398376226425171
Loss:6.138967514038086
CL_Loss:2.1022403240203857
Loss:6.42069149017334
CL_Loss:2.1438567638397217
Loss:6.902911186218262
CL_Loss:2.4288527965545654
-------------------Start Predicting---------------------:  2026-02-09 07:45:37.076481
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3377  Recall@5:0.2691
HiT@20: 0.3998 HiT@10: 0.3377  HiT@5:0.2691
MRR@20:0.1862 MRR@10:0.1819 MRR@5:0.1726


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:7.072504043579102
CL_Loss:2.5867559909820557
Loss:6.82943058013916
CL_Loss:2.2196223735809326
Loss:7.098729133605957
CL_Loss:2.4874050617218018
Loss:6.352921485900879
CL_Loss:2.2521145343780518
-------------------Start Predicting---------------------:  2026-02-09 07:49:47.076436
Results of LocalSession:

Recall@20: 0.3997 Recall@10: 0.3379  Recall@5:0.2693
HiT@20: 0.3997 HiT@10: 0.3379  HiT@5:0.2693
MRR@20:0.1861 MRR@10:0.1818 MRR@5:0.1725


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.488376617431641
CL_Loss:2.356806516647339
Loss:6.4000091552734375
CL_Loss:2.434382915496826
Loss:6.496453285217285
CL_Loss:2.374783515930176
Loss:6.564786911010742
CL_Loss:2.18695068359375
-------------------Start Predicting---------------------:  2026-02-09 07:53:57.980368
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3379  Recall@5:0.2692
HiT@20: 0.3998 HiT@10: 0.3379  HiT@5:0.2692
MRR@20:0.1862 MRR@10:0.1818 MRR@5:0.1726


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.580292701721191
CL_Loss:2.410964250564575
Loss:6.3100738525390625
CL_Loss:2.420686960220337
Loss:7.13777494430542
CL_Loss:2.4837169647216797
Loss:6.176858901977539
CL_Loss:2.4129669666290283
-------------------Start Predicting---------------------:  2026-02-09 07:58:14.363143
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3381  Recall@5:0.2694
HiT@20: 0.3998 HiT@10: 0.3381  HiT@5:0.2694
MRR@20:0.1863 MRR@10:0.1820 MRR@5:0.1727


Best Results:

[0.2692099776044482, 0.33759363657425284, 0.40003089041624834, tensor(0.1727), tensor(0.1819), tensor(0.1862, device='cuda:0')]
