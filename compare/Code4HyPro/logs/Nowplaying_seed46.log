Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Nowplaying', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=46)
model is on gpu
  0%|          | 0/825304 [00:00<?, ?it/s] 11%|█         | 87187/825304 [00:00<00:01, 442512.49it/s] 27%|██▋       | 225217/825304 [00:00<00:00, 836665.20it/s] 44%|████▍     | 366320/825304 [00:00<00:00, 1052112.83it/s] 59%|█████▊    | 484764/825304 [00:00<00:00, 750450.11it/s]  76%|███████▌  | 623839/825304 [00:00<00:00, 913122.61it/s] 93%|█████████▎| 767441/825304 [00:00<00:00, 1052362.66it/s]100%|██████████| 825304/825304 [00:01<00:00, 784356.06it/s] 
the number of nodes is :60417
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.684246063232422
CL_Loss:1.9853382110595703
Loss:12.856945037841797
CL_Loss:2.3168373107910156
Loss:11.505428314208984
CL_Loss:1.996333122253418
Loss:11.262799263000488
CL_Loss:2.0708582401275635
Loss:11.271537780761719
CL_Loss:2.564117670059204
Loss:9.64974594116211
CL_Loss:1.799180269241333
Loss:9.886835098266602
CL_Loss:1.9905016422271729
Loss:9.92611026763916
CL_Loss:1.7244329452514648
Loss:9.727069854736328
CL_Loss:1.9904009103775024
-------------------Start Predicting---------------------:  2026-02-09 14:24:31.924620
Results of LocalSession:

Recall@20: 0.2121 Recall@10: 0.1560  Recall@5:0.1048
HiT@20: 0.2121 HiT@10: 0.1560  HiT@5:0.1048
MRR@20:0.0725 MRR@10:0.0686 MRR@5:0.0618


Best Results:

[0.10481608478802992, 0.15601620947630923, 0.21207027075169219, tensor(0.0618), tensor(0.0686), tensor(0.0725, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.238122940063477
CL_Loss:2.051504135131836
Loss:8.155488967895508
CL_Loss:1.8001525402069092
Loss:8.283893585205078
CL_Loss:2.06496524810791
Loss:8.36522388458252
CL_Loss:1.9832490682601929
Loss:9.127113342285156
CL_Loss:2.1211769580841064
Loss:8.948880195617676
CL_Loss:2.162172555923462
Loss:9.36231517791748
CL_Loss:2.4513003826141357
Loss:8.63739013671875
CL_Loss:2.0521328449249268
Loss:9.712002754211426
CL_Loss:2.486079454421997
-------------------Start Predicting---------------------:  2026-02-09 14:35:04.275085
Results of LocalSession:

Recall@20: 0.2261 Recall@10: 0.1675  Recall@5:0.1128
HiT@20: 0.2261 HiT@10: 0.1675  HiT@5:0.1128
MRR@20:0.0758 MRR@10:0.0718 MRR@5:0.0645


Best Results:

[0.11283175988599929, 0.16746081225507659, 0.2261088350552191, tensor(0.0645), tensor(0.0718), tensor(0.0758, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:8.91041374206543
CL_Loss:2.2913405895233154
Loss:8.670328140258789
CL_Loss:1.9876772165298462
Loss:8.152289390563965
CL_Loss:2.049621343612671
Loss:8.207151412963867
CL_Loss:2.09018611907959
Loss:8.578317642211914
CL_Loss:1.9716609716415405
Loss:8.367029190063477
CL_Loss:1.8186452388763428
Loss:8.153861045837402
CL_Loss:1.7896963357925415
Loss:8.782204627990723
CL_Loss:1.993479609489441
Loss:7.972169876098633
CL_Loss:1.8647663593292236
-------------------Start Predicting---------------------:  2026-02-09 14:45:37.967246
Results of LocalSession:

Recall@20: 0.2302 Recall@10: 0.1712  Recall@5:0.1142
HiT@20: 0.2302 HiT@10: 0.1712  HiT@5:0.1142
MRR@20:0.0763 MRR@10:0.0722 MRR@5:0.0647


Best Results:

[0.11424563591022444, 0.17117919486996794, 0.2302168685429284, tensor(0.0647), tensor(0.0722), tensor(0.0763, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:8.531442642211914
CL_Loss:2.193692207336426
Loss:8.0711669921875
CL_Loss:1.8403481245040894
Loss:7.945725440979004
CL_Loss:1.9774116277694702
Loss:8.276148796081543
CL_Loss:2.020813226699829
Loss:8.376547813415527
CL_Loss:1.8791199922561646
Loss:7.889159202575684
CL_Loss:1.937569260597229
Loss:7.714913845062256
CL_Loss:1.8014291524887085
Loss:8.473752975463867
CL_Loss:2.0666651725769043
Loss:8.612186431884766
CL_Loss:2.1247634887695312
-------------------Start Predicting---------------------:  2026-02-09 14:55:36.667945
Results of LocalSession:

Recall@20: 0.2326 Recall@10: 0.1720  Recall@5:0.1159
HiT@20: 0.2326 HiT@10: 0.1720  HiT@5:0.1159
MRR@20:0.0770 MRR@10:0.0728 MRR@5:0.0653


Best Results:

[0.11588216957605985, 0.17199189526184538, 0.23259930530815817, tensor(0.0653), tensor(0.0728), tensor(0.0770, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.44428825378418
CL_Loss:1.7044677734375
Loss:8.109825134277344
CL_Loss:1.8548345565795898
Loss:8.055530548095703
CL_Loss:2.0758283138275146
Loss:8.087329864501953
CL_Loss:2.0795609951019287
Loss:8.478724479675293
CL_Loss:1.9314767122268677
Loss:7.757578372955322
CL_Loss:1.6633461713790894
Loss:8.411437034606934
CL_Loss:2.06331467628479
Loss:8.555656433105469
CL_Loss:2.140000343322754
Loss:8.058357238769531
CL_Loss:1.9717004299163818
-------------------Start Predicting---------------------:  2026-02-09 15:05:57.173367
Results of LocalSession:

Recall@20: 0.2330 Recall@10: 0.1726  Recall@5:0.1171
HiT@20: 0.2330 HiT@10: 0.1726  HiT@5:0.1171
MRR@20:0.0774 MRR@10:0.0732 MRR@5:0.0658


Best Results:

[0.11705112219451372, 0.17262646954043462, 0.23301122194513715, tensor(0.0658), tensor(0.0732), tensor(0.0774, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:8.164617538452148
CL_Loss:2.43068528175354
Loss:8.615005493164062
CL_Loss:2.1322343349456787
Loss:7.634558200836182
CL_Loss:1.78855562210083
Loss:7.382295608520508
CL_Loss:1.7081716060638428
Loss:8.416260719299316
CL_Loss:2.1225879192352295
Loss:8.174622535705566
CL_Loss:2.173684597015381
Loss:7.416177272796631
CL_Loss:1.8290363550186157
Loss:7.820898056030273
CL_Loss:1.8480398654937744
Loss:7.870312213897705
CL_Loss:1.698201298713684
-------------------Start Predicting---------------------:  2026-02-09 15:15:09.643282
Results of LocalSession:

Recall@20: 0.2331 Recall@10: 0.1731  Recall@5:0.1174
HiT@20: 0.2331 HiT@10: 0.1731  HiT@5:0.1174
MRR@20:0.0773 MRR@10:0.0732 MRR@5:0.0658


Best Results:

[0.11736284289276808, 0.17314971499821874, 0.23311141788386178, tensor(0.0658), tensor(0.0732), tensor(0.0773, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:8.270476341247559
CL_Loss:1.9302316904067993
Loss:7.937986373901367
CL_Loss:2.042666435241699
Loss:7.952363967895508
CL_Loss:1.912630319595337
Loss:7.564501762390137
CL_Loss:1.9054653644561768
Loss:7.639435768127441
CL_Loss:2.0674643516540527
Loss:8.284011840820312
CL_Loss:2.001267910003662
Loss:7.684647083282471
CL_Loss:1.890291690826416
Loss:8.133644104003906
CL_Loss:2.313769578933716
Loss:7.600637435913086
CL_Loss:1.9216753244400024
-------------------Start Predicting---------------------:  2026-02-09 15:24:18.952530
Results of LocalSession:

Recall@20: 0.2333 Recall@10: 0.1736  Recall@5:0.1174
HiT@20: 0.2333 HiT@10: 0.1736  HiT@5:0.1174
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0656


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:7.849479675292969
CL_Loss:2.066897392272949
Loss:8.20622444152832
CL_Loss:2.0770530700683594
Loss:8.238419532775879
CL_Loss:1.9457648992538452
Loss:7.931343078613281
CL_Loss:1.8548296689987183
Loss:8.019392013549805
CL_Loss:2.1451663970947266
Loss:8.083569526672363
CL_Loss:2.1195056438446045
Loss:7.972142696380615
CL_Loss:2.0022592544555664
Loss:8.641800880432129
CL_Loss:2.1777594089508057
Loss:7.9315009117126465
CL_Loss:2.0719552040100098
-------------------Start Predicting---------------------:  2026-02-09 15:33:28.282716
Results of LocalSession:

Recall@20: 0.2332 Recall@10: 0.1732  Recall@5:0.1177
HiT@20: 0.2332 HiT@10: 0.1732  HiT@5:0.1177
MRR@20:0.0772 MRR@10:0.0730 MRR@5:0.0657


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:7.8258280754089355
CL_Loss:1.8606098890304565
Loss:7.935551643371582
CL_Loss:1.956260323524475
Loss:7.609985828399658
CL_Loss:1.6266225576400757
Loss:7.9680633544921875
CL_Loss:1.9467884302139282
Loss:7.581173896789551
CL_Loss:1.7135683298110962
Loss:6.826836109161377
CL_Loss:1.6484456062316895
Loss:8.062309265136719
CL_Loss:1.7516660690307617
Loss:7.869833469390869
CL_Loss:2.0708446502685547
Loss:8.296799659729004
CL_Loss:2.2678091526031494
-------------------Start Predicting---------------------:  2026-02-09 15:42:48.152064
Results of LocalSession:

Recall@20: 0.2331 Recall@10: 0.1734  Recall@5:0.1176
HiT@20: 0.2331 HiT@10: 0.1734  HiT@5:0.1176
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0656


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:8.113494873046875
CL_Loss:1.975350260734558
Loss:7.905942440032959
CL_Loss:1.829057216644287
Loss:7.810043811798096
CL_Loss:1.80342435836792
Loss:8.00446605682373
CL_Loss:2.0956532955169678
Loss:8.30498218536377
CL_Loss:2.1147634983062744
Loss:7.541021823883057
CL_Loss:1.9200671911239624
Loss:7.97158670425415
CL_Loss:1.776235580444336
Loss:7.820197105407715
CL_Loss:1.8023817539215088
Loss:7.738480567932129
CL_Loss:1.7484339475631714
-------------------Start Predicting---------------------:  2026-02-09 15:52:23.069442
Results of LocalSession:

Recall@20: 0.2331 Recall@10: 0.1734  Recall@5:0.1176
HiT@20: 0.2331 HiT@10: 0.1734  HiT@5:0.1176
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0656


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:7.27598762512207
CL_Loss:1.655726432800293
Loss:7.970113754272461
CL_Loss:2.067491292953491
Loss:7.609800815582275
CL_Loss:1.8779711723327637
Loss:8.256929397583008
CL_Loss:2.0484983921051025
Loss:7.418431282043457
CL_Loss:1.7693133354187012
Loss:8.168110847473145
CL_Loss:2.0571839809417725
Loss:7.899155616760254
CL_Loss:1.7729918956756592
Loss:7.344952583312988
CL_Loss:1.7538422346115112
Loss:7.67390251159668
CL_Loss:1.7660233974456787
-------------------Start Predicting---------------------:  2026-02-09 16:02:06.097854
Results of LocalSession:

Recall@20: 0.2329 Recall@10: 0.1735  Recall@5:0.1177
HiT@20: 0.2329 HiT@10: 0.1735  HiT@5:0.1177
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0657


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:7.997270584106445
CL_Loss:2.145949602127075
Loss:7.291837692260742
CL_Loss:1.6923574209213257
Loss:7.031595230102539
CL_Loss:1.8447191715240479
Loss:7.956141471862793
CL_Loss:2.0551953315734863
Loss:7.4141130447387695
CL_Loss:1.8696123361587524
Loss:7.506194591522217
CL_Loss:1.7874404191970825
Loss:8.183359146118164
CL_Loss:2.0834949016571045
Loss:7.873740196228027
CL_Loss:1.872228980064392
Loss:7.436118125915527
CL_Loss:1.821571946144104
-------------------Start Predicting---------------------:  2026-02-09 16:11:38.007832
Results of LocalSession:

Recall@20: 0.2330 Recall@10: 0.1734  Recall@5:0.1177
HiT@20: 0.2330 HiT@10: 0.1734  HiT@5:0.1177
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0657


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:7.820560932159424
CL_Loss:2.2179298400878906
Loss:7.353414058685303
CL_Loss:1.8680661916732788
Loss:7.456417083740234
CL_Loss:1.9507520198822021
Loss:8.037490844726562
CL_Loss:2.0269618034362793
Loss:8.517548561096191
CL_Loss:2.249941825866699
Loss:7.819023609161377
CL_Loss:1.8132214546203613
Loss:7.463071823120117
CL_Loss:1.927109956741333
Loss:7.465424537658691
CL_Loss:1.7886638641357422
Loss:7.976458549499512
CL_Loss:1.8402738571166992
-------------------Start Predicting---------------------:  2026-02-09 16:21:00.076130
Results of LocalSession:

Recall@20: 0.2329 Recall@10: 0.1733  Recall@5:0.1177
HiT@20: 0.2329 HiT@10: 0.1733  HiT@5:0.1177
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0657


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:7.618696689605713
CL_Loss:1.8433914184570312
Loss:7.916399955749512
CL_Loss:1.8618299961090088
Loss:8.152816772460938
CL_Loss:2.0317442417144775
Loss:7.935617923736572
CL_Loss:1.7966011762619019
Loss:7.254502296447754
CL_Loss:1.5303270816802979
Loss:7.420986175537109
CL_Loss:1.900216817855835
Loss:8.041290283203125
CL_Loss:2.0660133361816406
Loss:8.01400089263916
CL_Loss:2.0658745765686035
Loss:7.952239036560059
CL_Loss:2.0426430702209473
-------------------Start Predicting---------------------:  2026-02-09 16:30:28.635124
Results of LocalSession:

Recall@20: 0.2330 Recall@10: 0.1735  Recall@5:0.1177
HiT@20: 0.2330 HiT@10: 0.1735  HiT@5:0.1177
MRR@20:0.0772 MRR@10:0.0731 MRR@5:0.0657


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:7.4388427734375
CL_Loss:1.8568781614303589
Loss:8.162538528442383
CL_Loss:2.0469348430633545
Loss:8.301604270935059
CL_Loss:2.0748355388641357
Loss:7.7812418937683105
CL_Loss:2.135343074798584
Loss:7.950984001159668
CL_Loss:2.190683603286743
Loss:7.910164833068848
CL_Loss:2.0687978267669678
Loss:8.267183303833008
CL_Loss:1.9723012447357178
Loss:7.719449996948242
CL_Loss:2.3131089210510254
Loss:8.130020141601562
CL_Loss:2.3963143825531006
-------------------Start Predicting---------------------:  2026-02-09 16:39:49.098077
Results of LocalSession:

Recall@20: 0.2330 Recall@10: 0.1735  Recall@5:0.1176
HiT@20: 0.2330 HiT@10: 0.1735  HiT@5:0.1176
MRR@20:0.0772 MRR@10:0.0730 MRR@5:0.0656


Best Results:

[0.11739624153900961, 0.17359503028143927, 0.23328954399715, tensor(0.0656), tensor(0.0731), tensor(0.0772, device='cuda:0')]
