Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Tmall', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=46)
model is on gpu
  0%|          | 0/351268 [00:00<?, ?it/s] 15%|█▌        | 53415/351268 [00:00<00:00, 534128.86it/s] 48%|████▊     | 169776/351268 [00:00<00:00, 690729.13it/s] 86%|████████▋ | 303799/351268 [00:00<00:00, 944616.18it/s]100%|██████████| 351268/351268 [00:00<00:00, 899757.36it/s]
the number of nodes is :40728
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:17.51996612548828
CL_Loss:2.3930089473724365
Loss:10.011280059814453
CL_Loss:2.3391542434692383
Loss:9.254371643066406
CL_Loss:2.3329498767852783
Loss:9.617534637451172
CL_Loss:2.377326011657715
-------------------Start Predicting---------------------:  2026-02-09 08:43:50.827609
Results of LocalSession:

Recall@20: 0.3772 Recall@10: 0.3298  Recall@5:0.2715
HiT@20: 0.3772 HiT@10: 0.3298  HiT@5:0.2715
MRR@20:0.1867 MRR@10:0.1833 MRR@5:0.1754


Best Results:

[0.2714881458027647, 0.3297938064715422, 0.3772492084330836, tensor(0.1754), tensor(0.1833), tensor(0.1867, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.227456092834473
CL_Loss:2.663667917251587
Loss:8.093714714050293
CL_Loss:2.3914830684661865
Loss:7.410515308380127
CL_Loss:2.3984365463256836
Loss:7.38755464553833
CL_Loss:2.348369598388672
-------------------Start Predicting---------------------:  2026-02-09 08:48:00.627261
Results of LocalSession:

Recall@20: 0.3934 Recall@10: 0.3343  Recall@5:0.2695
HiT@20: 0.3934 HiT@10: 0.3343  HiT@5:0.2695
MRR@20:0.1871 MRR@10:0.1830 MRR@5:0.1743


Best Results:

[0.26948026874662134, 0.3342729168275543, 0.39338945092285116, tensor(0.1743), tensor(0.1830), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.7552642822265625
CL_Loss:2.29634690284729
Loss:7.430189609527588
CL_Loss:2.3603639602661133
Loss:7.157020568847656
CL_Loss:2.395514726638794
Loss:6.900997638702393
CL_Loss:2.189533233642578
-------------------Start Predicting---------------------:  2026-02-09 08:52:10.872960
Results of LocalSession:

Recall@20: 0.3970 Recall@10: 0.3359  Recall@5:0.2675
HiT@20: 0.3970 HiT@10: 0.3359  HiT@5:0.2675
MRR@20:0.1860 MRR@10:0.1817 MRR@5:0.1725


Best Results:

[0.2675110047107885, 0.33593327670090356, 0.39701907483203336, tensor(0.1725), tensor(0.1817), tensor(0.1860, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.049813270568848
CL_Loss:2.2457406520843506
Loss:6.749560356140137
CL_Loss:2.2060067653656006
Loss:6.996405601501465
CL_Loss:2.722395181655884
Loss:7.2444281578063965
CL_Loss:2.421997547149658
-------------------Start Predicting---------------------:  2026-02-09 08:56:22.795649
Results of LocalSession:

Recall@20: 0.3979 Recall@10: 0.3354  Recall@5:0.2669
HiT@20: 0.3979 HiT@10: 0.3354  HiT@5:0.2669
MRR@20:0.1857 MRR@10:0.1814 MRR@5:0.1721


Best Results:

[0.26693180940613176, 0.33535408139624684, 0.3978685612788632, tensor(0.1721), tensor(0.1814), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.802582740783691
CL_Loss:2.2834360599517822
Loss:6.576861381530762
CL_Loss:2.2870421409606934
Loss:6.829769134521484
CL_Loss:2.2631921768188477
Loss:6.448273658752441
CL_Loss:2.381211757659912
-------------------Start Predicting---------------------:  2026-02-09 09:00:38.065500
Results of LocalSession:

Recall@20: 0.3994 Recall@10: 0.3360  Recall@5:0.2663
HiT@20: 0.3994 HiT@10: 0.3360  HiT@5:0.2663
MRR@20:0.1861 MRR@10:0.1817 MRR@5:0.1723


Best Results:

[0.2662753880608541, 0.335971889721214, 0.3994130820912812, tensor(0.1723), tensor(0.1817), tensor(0.1861, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.571846008300781
CL_Loss:2.42881178855896
Loss:6.728926658630371
CL_Loss:2.2878973484039307
Loss:6.218228340148926
CL_Loss:2.23612904548645
Loss:7.307147979736328
CL_Loss:2.425351858139038
-------------------Start Predicting---------------------:  2026-02-09 09:04:57.259177
Results of LocalSession:

Recall@20: 0.3996 Recall@10: 0.3355  Recall@5:0.2658
HiT@20: 0.3996 HiT@10: 0.3355  HiT@5:0.2658
MRR@20:0.1859 MRR@10:0.1814 MRR@5:0.1720


Best Results:

[0.26577341879681826, 0.3355085334774886, 0.399567534172523, tensor(0.1720), tensor(0.1814), tensor(0.1859, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.697011947631836
CL_Loss:2.4600703716278076
Loss:6.497261047363281
CL_Loss:2.175245523452759
Loss:6.888715744018555
CL_Loss:2.5184714794158936
Loss:6.83306884765625
CL_Loss:2.315880298614502
-------------------Start Predicting---------------------:  2026-02-09 09:09:24.707712
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3362  Recall@5:0.2666
HiT@20: 0.3998 HiT@10: 0.3362  HiT@5:0.2666
MRR@20:0.1859 MRR@10:0.1815 MRR@5:0.1721


Best Results:

[0.2665842922233377, 0.33616495482276626, 0.39983782531469614, tensor(0.1721), tensor(0.1815), tensor(0.1859, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.480512619018555
CL_Loss:2.446298360824585
Loss:6.3709869384765625
CL_Loss:2.207045793533325
Loss:6.484000205993652
CL_Loss:2.313880681991577
Loss:6.606705665588379
CL_Loss:2.46590256690979
-------------------Start Predicting---------------------:  2026-02-09 09:13:59.172779
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3362  Recall@5:0.2660
HiT@20: 0.3998 HiT@10: 0.3362  HiT@5:0.2660
MRR@20:0.1856 MRR@10:0.1812 MRR@5:0.1717


Best Results:

[0.2665842922233377, 0.33616495482276626, 0.39983782531469614, tensor(0.1721), tensor(0.1815), tensor(0.1859, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.601554870605469
CL_Loss:2.449145555496216
Loss:6.9316558837890625
CL_Loss:2.4255943298339844
Loss:6.80995512008667
CL_Loss:2.5248727798461914
Loss:6.001824378967285
CL_Loss:2.205770254135132
-------------------Start Predicting---------------------:  2026-02-09 09:18:43.357282
Results of LocalSession:

Recall@20: 0.4000 Recall@10: 0.3356  Recall@5:0.2662
HiT@20: 0.4000 HiT@10: 0.3356  HiT@5:0.2662
MRR@20:0.1856 MRR@10:0.1810 MRR@5:0.1717


Best Results:

[0.2661595489999228, 0.3355857595181095, 0.40003089041624834, tensor(0.1717), tensor(0.1810), tensor(0.1856, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:5.829423904418945
CL_Loss:2.2148425579071045
Loss:6.525500297546387
CL_Loss:2.402639150619507
Loss:6.671478271484375
CL_Loss:2.369203805923462
Loss:6.949273109436035
CL_Loss:2.499957323074341
-------------------Start Predicting---------------------:  2026-02-09 09:23:31.103950
Results of LocalSession:

Recall@20: 0.4001 Recall@10: 0.3359  Recall@5:0.2664
HiT@20: 0.4001 HiT@10: 0.3359  HiT@5:0.2664
MRR@20:0.1857 MRR@10:0.1812 MRR@5:0.1718


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.766630172729492
CL_Loss:2.3699471950531006
Loss:6.391055107116699
CL_Loss:2.289799690246582
Loss:6.077798843383789
CL_Loss:2.2305235862731934
Loss:6.376343727111816
CL_Loss:2.404339075088501
-------------------Start Predicting---------------------:  2026-02-09 09:28:13.013874
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3361  Recall@5:0.2664
HiT@20: 0.3998 HiT@10: 0.3361  HiT@5:0.2664
MRR@20:0.1857 MRR@10:0.1813 MRR@5:0.1719


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.71335506439209
CL_Loss:2.5086276531219482
Loss:6.95776891708374
CL_Loss:2.3541789054870605
Loss:6.3579301834106445
CL_Loss:2.328693151473999
Loss:7.072966575622559
CL_Loss:2.4554054737091064
-------------------Start Predicting---------------------:  2026-02-09 09:32:24.394945
Results of LocalSession:

Recall@20: 0.3997 Recall@10: 0.3357  Recall@5:0.2661
HiT@20: 0.3997 HiT@10: 0.3357  HiT@5:0.2661
MRR@20:0.1856 MRR@10:0.1811 MRR@5:0.1718


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.281028747558594
CL_Loss:2.2905423641204834
Loss:6.081809043884277
CL_Loss:2.3221871852874756
Loss:6.26531982421875
CL_Loss:2.4077043533325195
Loss:6.3547282218933105
CL_Loss:2.1687917709350586
-------------------Start Predicting---------------------:  2026-02-09 09:37:16.646213
Results of LocalSession:

Recall@20: 0.3999 Recall@10: 0.3358  Recall@5:0.2662
HiT@20: 0.3999 HiT@10: 0.3358  HiT@5:0.2662
MRR@20:0.1856 MRR@10:0.1811 MRR@5:0.1717


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.285278797149658
CL_Loss:2.2984068393707275
Loss:6.904682159423828
CL_Loss:2.4031763076782227
Loss:6.288392543792725
CL_Loss:2.274719715118408
Loss:7.386034965515137
CL_Loss:2.4458651542663574
-------------------Start Predicting---------------------:  2026-02-09 09:41:49.811283
Results of LocalSession:

Recall@20: 0.3998 Recall@10: 0.3357  Recall@5:0.2662
HiT@20: 0.3998 HiT@10: 0.3357  HiT@5:0.2662
MRR@20:0.1858 MRR@10:0.1813 MRR@5:0.1719


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.119039535522461
CL_Loss:2.3713009357452393
Loss:6.215181350708008
CL_Loss:2.3834004402160645
Loss:6.427562236785889
CL_Loss:2.292600154876709
Loss:6.873537063598633
CL_Loss:2.5749075412750244
-------------------Start Predicting---------------------:  2026-02-09 09:46:14.050180
Results of LocalSession:

Recall@20: 0.3997 Recall@10: 0.3359  Recall@5:0.2660
HiT@20: 0.3997 HiT@10: 0.3359  HiT@5:0.2660
MRR@20:0.1856 MRR@10:0.1811 MRR@5:0.1717


Best Results:

[0.2663912271217855, 0.3358946636805931, 0.4000695034365588, tensor(0.1718), tensor(0.1812), tensor(0.1857, device='cuda:0')]
