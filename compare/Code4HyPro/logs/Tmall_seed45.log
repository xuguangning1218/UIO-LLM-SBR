Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Tmall', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=45)
model is on gpu
  0%|          | 0/351268 [00:00<?, ?it/s] 13%|█▎        | 43923/351268 [00:00<00:00, 439214.71it/s] 48%|████▊     | 169776/351268 [00:00<00:00, 695756.32it/s] 87%|████████▋ | 304468/351268 [00:00<00:00, 948572.84it/s]100%|██████████| 351268/351268 [00:00<00:00, 896624.18it/s]
the number of nodes is :40728
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:10.582847595214844
CL_Loss:2.1908621788024902
Loss:10.100963592529297
CL_Loss:2.248840808868408
Loss:9.476140975952148
CL_Loss:2.1979384422302246
Loss:9.074300765991211
CL_Loss:2.4061739444732666
-------------------Start Predicting---------------------:  2026-02-09 08:02:31.141048
Results of LocalSession:

Recall@20: 0.3813 Recall@10: 0.3332  Recall@5:0.2748
HiT@20: 0.3813 HiT@10: 0.3332  HiT@5:0.2748
MRR@20:0.1915 MRR@10:0.1881 MRR@5:0.1802


Best Results:

[0.27480886554946327, 0.33319175225886166, 0.38130357556568073, tensor(0.1802), tensor(0.1881), tensor(0.1915, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.117587089538574
CL_Loss:2.2751386165618896
Loss:8.16381549835205
CL_Loss:2.670405864715576
Loss:7.612651824951172
CL_Loss:2.3145081996917725
Loss:7.872173309326172
CL_Loss:2.258620262145996
-------------------Start Predicting---------------------:  2026-02-09 08:06:38.311255
Results of LocalSession:

Recall@20: 0.3954 Recall@10: 0.3378  Recall@5:0.2713
HiT@20: 0.3954 HiT@10: 0.3378  HiT@5:0.2713
MRR@20:0.1891 MRR@10:0.1851 MRR@5:0.1762


Best Results:

[0.27129508070121244, 0.33782531469611554, 0.3953973279789945, tensor(0.1762), tensor(0.1851), tensor(0.1891, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.789842128753662
CL_Loss:2.556612014770508
Loss:7.080957412719727
CL_Loss:2.3791818618774414
Loss:7.658546447753906
CL_Loss:2.570178747177124
Loss:7.228231430053711
CL_Loss:2.292527437210083
-------------------Start Predicting---------------------:  2026-02-09 08:10:45.285121
Results of LocalSession:

Recall@20: 0.3981 Recall@10: 0.3368  Recall@5:0.2706
HiT@20: 0.3981 HiT@10: 0.3368  HiT@5:0.2706
MRR@20:0.1886 MRR@10:0.1843 MRR@5:0.1754


Best Results:

[0.2705614333153139, 0.33682137616804386, 0.3981002394007259, tensor(0.1754), tensor(0.1843), tensor(0.1886, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:6.27414083480835
CL_Loss:2.2296042442321777
Loss:7.170724868774414
CL_Loss:2.3469669818878174
Loss:6.361922264099121
CL_Loss:2.3294637203216553
Loss:7.782025337219238
CL_Loss:2.4505956172943115
-------------------Start Predicting---------------------:  2026-02-09 08:14:52.969303
Results of LocalSession:

Recall@20: 0.4005 Recall@10: 0.3372  Recall@5:0.2705
HiT@20: 0.4005 HiT@10: 0.3372  HiT@5:0.2705
MRR@20:0.1886 MRR@10:0.1842 MRR@5:0.1752


Best Results:

[0.270484207274693, 0.3372075063711483, 0.4004556336396633, tensor(0.1752), tensor(0.1842), tensor(0.1886, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.64652156829834
CL_Loss:2.6261236667633057
Loss:6.382350921630859
CL_Loss:2.3494153022766113
Loss:6.674903869628906
CL_Loss:2.315786123275757
Loss:6.3775177001953125
CL_Loss:2.204094886779785
-------------------Start Predicting---------------------:  2026-02-09 08:19:03.485494
Results of LocalSession:

Recall@20: 0.4017 Recall@10: 0.3371  Recall@5:0.2715
HiT@20: 0.4017 HiT@10: 0.3371  HiT@5:0.2715
MRR@20:0.1882 MRR@10:0.1837 MRR@5:0.1749


Best Results:

[0.2714881458027647, 0.33705305428990656, 0.4017298633099081, tensor(0.1749), tensor(0.1837), tensor(0.1882, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.801177024841309
CL_Loss:2.317974328994751
Loss:6.683514595031738
CL_Loss:2.233485698699951
Loss:6.8101043701171875
CL_Loss:2.289522171020508
Loss:6.852527141571045
CL_Loss:2.2936477661132812
-------------------Start Predicting---------------------:  2026-02-09 08:23:07.554225
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3376  Recall@5:0.2701
HiT@20: 0.4020 HiT@10: 0.3376  HiT@5:0.2701
MRR@20:0.1873 MRR@10:0.1828 MRR@5:0.1737


Best Results:

[0.270136690091899, 0.3376322495945633, 0.4019615414317708, tensor(0.1737), tensor(0.1828), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.657671928405762
CL_Loss:2.4512624740600586
Loss:6.079558372497559
CL_Loss:2.104562759399414
Loss:6.815190315246582
CL_Loss:2.5210886001586914
Loss:7.186798095703125
CL_Loss:2.5025222301483154
-------------------Start Predicting---------------------:  2026-02-09 08:27:14.137041
Results of LocalSession:

Recall@20: 0.4024 Recall@10: 0.3384  Recall@5:0.2694
HiT@20: 0.4024 HiT@10: 0.3384  HiT@5:0.2694
MRR@20:0.1871 MRR@10:0.1826 MRR@5:0.1734


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.418873310089111
CL_Loss:2.2014055252075195
Loss:6.150887489318848
CL_Loss:2.078315019607544
Loss:7.244394302368164
CL_Loss:2.5349628925323486
Loss:6.366694450378418
CL_Loss:2.248511552810669
-------------------Start Predicting---------------------:  2026-02-09 08:31:20.856332
Results of LocalSession:

Recall@20: 0.4022 Recall@10: 0.3387  Recall@5:0.2689
HiT@20: 0.4022 HiT@10: 0.3387  HiT@5:0.2689
MRR@20:0.1869 MRR@10:0.1825 MRR@5:0.1731


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.673741340637207
CL_Loss:2.309241533279419
Loss:6.384758949279785
CL_Loss:2.22277569770813
Loss:6.6837310791015625
CL_Loss:2.5364797115325928
Loss:7.4205121994018555
CL_Loss:2.5882585048675537
-------------------Start Predicting---------------------:  2026-02-09 08:35:27.949118
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3383  Recall@5:0.2689
HiT@20: 0.4020 HiT@10: 0.3383  HiT@5:0.2689
MRR@20:0.1869 MRR@10:0.1824 MRR@5:0.1731


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.573322772979736
CL_Loss:2.146378993988037
Loss:7.309440612792969
CL_Loss:2.562638521194458
Loss:5.877943992614746
CL_Loss:2.075652599334717
Loss:6.298470973968506
CL_Loss:2.5249204635620117
-------------------Start Predicting---------------------:  2026-02-09 08:39:33.778847
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3386  Recall@5:0.2692
HiT@20: 0.4020 HiT@10: 0.3386  HiT@5:0.2692
MRR@20:0.1869 MRR@10:0.1825 MRR@5:0.1732


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.289398193359375
CL_Loss:2.470440626144409
Loss:6.7240800857543945
CL_Loss:2.4372451305389404
Loss:6.648580074310303
CL_Loss:2.4724550247192383
Loss:6.524672031402588
CL_Loss:2.356881618499756
-------------------Start Predicting---------------------:  2026-02-09 08:43:37.905590
Results of LocalSession:

Recall@20: 0.4022 Recall@10: 0.3386  Recall@5:0.2693
HiT@20: 0.4022 HiT@10: 0.3386  HiT@5:0.2693
MRR@20:0.1868 MRR@10:0.1824 MRR@5:0.1731


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.828268051147461
CL_Loss:2.5312118530273438
Loss:6.568445205688477
CL_Loss:2.3613574504852295
Loss:7.06953239440918
CL_Loss:2.5007991790771484
Loss:6.503881454467773
CL_Loss:2.411771535873413
-------------------Start Predicting---------------------:  2026-02-09 08:47:43.538930
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3388  Recall@5:0.2693
HiT@20: 0.4020 HiT@10: 0.3388  HiT@5:0.2693
MRR@20:0.1869 MRR@10:0.1825 MRR@5:0.1732


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.361100196838379
CL_Loss:2.2130067348480225
Loss:6.579214096069336
CL_Loss:2.2754499912261963
Loss:6.82796573638916
CL_Loss:2.3992271423339844
Loss:6.365284442901611
CL_Loss:2.5079987049102783
-------------------Start Predicting---------------------:  2026-02-09 08:51:47.366931
Results of LocalSession:

Recall@20: 0.4022 Recall@10: 0.3389  Recall@5:0.2694
HiT@20: 0.4022 HiT@10: 0.3389  HiT@5:0.2694
MRR@20:0.1869 MRR@10:0.1825 MRR@5:0.1732


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.162817478179932
CL_Loss:2.2547528743743896
Loss:6.412031650543213
CL_Loss:2.4758944511413574
Loss:6.7489166259765625
CL_Loss:2.3341057300567627
Loss:6.891165733337402
CL_Loss:2.603099822998047
-------------------Start Predicting---------------------:  2026-02-09 08:55:51.067449
Results of LocalSession:

Recall@20: 0.4021 Recall@10: 0.3385  Recall@5:0.2692
HiT@20: 0.4021 HiT@10: 0.3385  HiT@5:0.2692
MRR@20:0.1869 MRR@10:0.1825 MRR@5:0.1732


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.520191669464111
CL_Loss:2.1317739486694336
Loss:6.779812812805176
CL_Loss:2.315068006515503
Loss:6.458263397216797
CL_Loss:2.2023565769195557
Loss:6.555905818939209
CL_Loss:2.343878746032715
-------------------Start Predicting---------------------:  2026-02-09 08:59:54.183290
Results of LocalSession:

Recall@20: 0.4023 Recall@10: 0.3385  Recall@5:0.2695
HiT@20: 0.4023 HiT@10: 0.3385  HiT@5:0.2695
MRR@20:0.1868 MRR@10:0.1823 MRR@5:0.1731


Best Results:

[0.2694416557263109, 0.3383658969804618, 0.4023862846551857, tensor(0.1734), tensor(0.1826), tensor(0.1871, device='cuda:0')]
