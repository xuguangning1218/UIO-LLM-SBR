Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Nowplaying', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=42)
model is on gpu
  0%|          | 0/825304 [00:00<?, ?it/s] 11%|█         | 87187/825304 [00:00<00:01, 450779.22it/s] 27%|██▋       | 223334/825304 [00:00<00:00, 837551.32it/s] 44%|████▍     | 365132/825304 [00:00<00:00, 1056736.43it/s] 59%|█████▊    | 483467/825304 [00:00<00:00, 712933.71it/s]  74%|███████▍  | 611316/825304 [00:00<00:00, 851370.96it/s] 91%|█████████▏| 754134/825304 [00:00<00:00, 1000811.88it/s]100%|██████████| 825304/825304 [00:01<00:00, 762531.18it/s] 
the number of nodes is :60417
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:14.0442533493042
CL_Loss:1.8826467990875244
Loss:13.147781372070312
CL_Loss:1.8097872734069824
Loss:13.654119491577148
CL_Loss:2.1805381774902344
Loss:12.717764854431152
CL_Loss:1.7676708698272705
Loss:12.759477615356445
CL_Loss:1.8130892515182495
Loss:12.686991691589355
CL_Loss:2.0281636714935303
Loss:12.728645324707031
CL_Loss:1.7615820169448853
Loss:12.624176025390625
CL_Loss:2.2397847175598145
Loss:12.92124080657959
CL_Loss:2.173421859741211
-------------------Start Predicting---------------------:  2026-02-09 09:10:07.356154
Results of LocalSession:

Recall@20: 0.0865 Recall@10: 0.0749  Recall@5:0.0632
HiT@20: 0.0865 HiT@10: 0.0749  HiT@5:0.0632
MRR@20:0.0466 MRR@10:0.0458 MRR@5:0.0442


Best Results:

[0.06316797292483078, 0.07494656216601354, 0.08654702529390809, tensor(0.0442), tensor(0.0458), tensor(0.0466, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:11.264802932739258
CL_Loss:1.9225866794586182
Loss:11.387372016906738
CL_Loss:2.0362794399261475
Loss:10.841994285583496
CL_Loss:1.8869781494140625
Loss:10.855615615844727
CL_Loss:1.7225921154022217
Loss:11.17071533203125
CL_Loss:1.9933751821517944
Loss:10.689458847045898
CL_Loss:1.7308367490768433
Loss:11.77169418334961
CL_Loss:2.070180654525757
Loss:11.274333953857422
CL_Loss:1.9624230861663818
Loss:12.604820251464844
CL_Loss:2.420762777328491
-------------------Start Predicting---------------------:  2026-02-09 09:20:42.672283
Results of LocalSession:

Recall@20: 0.1070 Recall@10: 0.0904  Recall@5:0.0747
HiT@20: 0.1070 HiT@10: 0.0904  HiT@5:0.0747
MRR@20:0.0541 MRR@10:0.0530 MRR@5:0.0509


Best Results:

[0.07470163876024224, 0.09036560384752405, 0.10698699679372996, tensor(0.0509), tensor(0.0530), tensor(0.0541, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:10.560262680053711
CL_Loss:2.0526394844055176
Loss:11.018784523010254
CL_Loss:1.9361785650253296
Loss:10.551752090454102
CL_Loss:2.040616035461426
Loss:10.860247611999512
CL_Loss:2.2453415393829346
Loss:10.565010070800781
CL_Loss:1.7891677618026733
Loss:10.498503684997559
CL_Loss:1.9654104709625244
Loss:10.522014617919922
CL_Loss:1.7470943927764893
Loss:10.701818466186523
CL_Loss:2.051637887954712
Loss:11.050207138061523
CL_Loss:2.0319573879241943
-------------------Start Predicting---------------------:  2026-02-09 09:31:19.440328
Results of LocalSession:

Recall@20: 0.1116 Recall@10: 0.0945  Recall@5:0.0776
HiT@20: 0.1116 HiT@10: 0.0945  HiT@5:0.0776
MRR@20:0.0559 MRR@10:0.0547 MRR@5:0.0524


Best Results:

[0.07758505521909512, 0.0945181688635554, 0.11161827573922337, tensor(0.0524), tensor(0.0547), tensor(0.0559, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:10.375781059265137
CL_Loss:1.9778715372085571
Loss:10.625128746032715
CL_Loss:1.8983348608016968
Loss:10.6663236618042
CL_Loss:2.0152273178100586
Loss:10.445569038391113
CL_Loss:1.931537389755249
Loss:10.536727905273438
CL_Loss:2.1867222785949707
Loss:9.506675720214844
CL_Loss:1.7982518672943115
Loss:10.27337646484375
CL_Loss:1.934393286705017
Loss:10.172819137573242
CL_Loss:1.97920560836792
Loss:10.762358665466309
CL_Loss:2.370293378829956
-------------------Start Predicting---------------------:  2026-02-09 09:42:14.787795
Results of LocalSession:

Recall@20: 0.1150 Recall@10: 0.0968  Recall@5:0.0796
HiT@20: 0.1150 HiT@10: 0.0968  HiT@5:0.0796
MRR@20:0.0564 MRR@10:0.0552 MRR@5:0.0529


Best Results:

[0.07957784111150695, 0.09681154257214107, 0.11503607053794086, tensor(0.0529), tensor(0.0552), tensor(0.0564, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:10.013479232788086
CL_Loss:1.7173287868499756
Loss:9.814558029174805
CL_Loss:2.0129597187042236
Loss:9.576554298400879
CL_Loss:1.8809322118759155
Loss:10.690202713012695
CL_Loss:2.2564468383789062
Loss:10.817238807678223
CL_Loss:2.022130012512207
Loss:9.879624366760254
CL_Loss:1.841252088546753
Loss:10.440034866333008
CL_Loss:2.0067038536071777
Loss:9.83586597442627
CL_Loss:2.017378568649292
Loss:10.188663482666016
CL_Loss:1.8035964965820312
-------------------Start Predicting---------------------:  2026-02-09 09:52:25.351896
Results of LocalSession:

Recall@20: 0.1159 Recall@10: 0.0976  Recall@5:0.0798
HiT@20: 0.1159 HiT@10: 0.0976  HiT@5:0.0798
MRR@20:0.0567 MRR@10:0.0555 MRR@5:0.0531


Best Results:

[0.07975596722479515, 0.09761311008193801, 0.1159267011043819, tensor(0.0531), tensor(0.0555), tensor(0.0567, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:10.366827011108398
CL_Loss:1.9746038913726807
Loss:9.812535285949707
CL_Loss:1.7786505222320557
Loss:10.585216522216797
CL_Loss:2.136314868927002
Loss:10.509989738464355
CL_Loss:2.020085334777832
Loss:10.019148826599121
CL_Loss:1.9639192819595337
Loss:9.918917655944824
CL_Loss:1.893790602684021
Loss:9.637496948242188
CL_Loss:1.7175250053405762
Loss:10.234496116638184
CL_Loss:2.053205728530884
Loss:9.978683471679688
CL_Loss:1.6813229322433472
-------------------Start Predicting---------------------:  2026-02-09 10:02:47.641473
Results of LocalSession:

Recall@20: 0.1171 Recall@10: 0.0986  Recall@5:0.0803
HiT@20: 0.1171 HiT@10: 0.0986  HiT@5:0.0803
MRR@20:0.0568 MRR@10:0.0555 MRR@5:0.0530


Best Results:

[0.08033487709298183, 0.09858167082294264, 0.11711791948699679, tensor(0.0530), tensor(0.0555), tensor(0.0568, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:9.903372764587402
CL_Loss:1.8796290159225464
Loss:9.71142578125
CL_Loss:2.0061755180358887
Loss:10.17331314086914
CL_Loss:1.7099552154541016
Loss:10.259485244750977
CL_Loss:1.9907598495483398
Loss:9.639899253845215
CL_Loss:2.1171884536743164
Loss:10.013835906982422
CL_Loss:1.9980509281158447
Loss:10.45043659210205
CL_Loss:1.981606364250183
Loss:10.353755950927734
CL_Loss:1.9244036674499512
Loss:9.673164367675781
CL_Loss:2.1699576377868652
-------------------Start Predicting---------------------:  2026-02-09 10:13:22.613520
Results of LocalSession:

Recall@20: 0.1177 Recall@10: 0.0989  Recall@5:0.0803
HiT@20: 0.1177 HiT@10: 0.0989  HiT@5:0.0803
MRR@20:0.0571 MRR@10:0.0558 MRR@5:0.0533


Best Results:

[0.08032374421090131, 0.09891565728535803, 0.11770796223726399, tensor(0.0533), tensor(0.0558), tensor(0.0571, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:10.868342399597168
CL_Loss:1.9515588283538818
Loss:9.526322364807129
CL_Loss:1.7804741859436035
Loss:9.756330490112305
CL_Loss:1.8493541479110718
Loss:9.903990745544434
CL_Loss:2.1956143379211426
Loss:9.256962776184082
CL_Loss:1.6537421941757202
Loss:9.192354202270508
CL_Loss:1.787229061126709
Loss:9.321627616882324
CL_Loss:1.9566553831100464
Loss:9.997299194335938
CL_Loss:1.7301474809646606
Loss:9.787611961364746
CL_Loss:1.7555553913116455
-------------------Start Predicting---------------------:  2026-02-09 10:23:50.438029
Results of LocalSession:

Recall@20: 0.1180 Recall@10: 0.0990  Recall@5:0.0805
HiT@20: 0.1180 HiT@10: 0.0990  HiT@5:0.0805
MRR@20:0.0571 MRR@10:0.0558 MRR@5:0.0534


Best Results:

[0.08049073744210901, 0.09904925187032419, 0.11797515140719629, tensor(0.0534), tensor(0.0558), tensor(0.0571, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:10.231474876403809
CL_Loss:2.18404483795166
Loss:10.328344345092773
CL_Loss:2.095165729522705
Loss:10.359030723571777
CL_Loss:2.091743230819702
Loss:9.92629337310791
CL_Loss:1.9988216161727905
Loss:9.319144248962402
CL_Loss:1.8210335969924927
Loss:9.7088041305542
CL_Loss:1.9048476219177246
Loss:9.433490753173828
CL_Loss:1.8674529790878296
Loss:10.376541137695312
CL_Loss:1.7392154932022095
Loss:10.140218734741211
CL_Loss:1.9538991451263428
-------------------Start Predicting---------------------:  2026-02-09 10:34:14.024669
Results of LocalSession:

Recall@20: 0.1182 Recall@10: 0.0991  Recall@5:0.0804
HiT@20: 0.1182 HiT@10: 0.0991  HiT@5:0.0804
MRR@20:0.0572 MRR@10:0.0559 MRR@5:0.0534


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:10.288835525512695
CL_Loss:2.0469369888305664
Loss:10.104762077331543
CL_Loss:1.9085721969604492
Loss:10.00023078918457
CL_Loss:1.5940033197402954
Loss:9.252250671386719
CL_Loss:1.870728611946106
Loss:9.406473159790039
CL_Loss:1.8751678466796875
Loss:9.894704818725586
CL_Loss:1.9651892185211182
Loss:10.555537223815918
CL_Loss:1.9913694858551025
Loss:9.988554000854492
CL_Loss:2.1138129234313965
Loss:9.683660507202148
CL_Loss:1.9416122436523438
-------------------Start Predicting---------------------:  2026-02-09 10:45:06.644321
Results of LocalSession:

Recall@20: 0.1181 Recall@10: 0.0990  Recall@5:0.0804
HiT@20: 0.1181 HiT@10: 0.0990  HiT@5:0.0804
MRR@20:0.0572 MRR@10:0.0559 MRR@5:0.0534


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:9.753019332885742
CL_Loss:2.0064311027526855
Loss:10.09701156616211
CL_Loss:2.3246030807495117
Loss:9.917194366455078
CL_Loss:2.106834888458252
Loss:9.469502449035645
CL_Loss:1.8677340745925903
Loss:9.521759986877441
CL_Loss:1.6386840343475342
Loss:9.76202392578125
CL_Loss:2.1235623359680176
Loss:9.700297355651855
CL_Loss:1.8461679220199585
Loss:9.58432388305664
CL_Loss:1.9190670251846313
Loss:9.778637886047363
CL_Loss:1.7721368074417114
-------------------Start Predicting---------------------:  2026-02-09 10:55:40.330892
Results of LocalSession:

Recall@20: 0.1180 Recall@10: 0.0990  Recall@5:0.0804
HiT@20: 0.1180 HiT@10: 0.0990  HiT@5:0.0804
MRR@20:0.0572 MRR@10:0.0558 MRR@5:0.0533


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:10.209107398986816
CL_Loss:1.969609022140503
Loss:10.075274467468262
CL_Loss:2.1515400409698486
Loss:9.927469253540039
CL_Loss:1.9677544832229614
Loss:9.344673156738281
CL_Loss:1.8479571342468262
Loss:10.697530746459961
CL_Loss:2.281421184539795
Loss:9.546841621398926
CL_Loss:1.7569559812545776
Loss:9.852630615234375
CL_Loss:2.1460554599761963
Loss:9.663771629333496
CL_Loss:1.940356731414795
Loss:9.382116317749023
CL_Loss:2.01700758934021
-------------------Start Predicting---------------------:  2026-02-09 11:06:45.919296
Results of LocalSession:

Recall@20: 0.1181 Recall@10: 0.0989  Recall@5:0.0804
HiT@20: 0.1181 HiT@10: 0.0989  HiT@5:0.0804
MRR@20:0.0571 MRR@10:0.0558 MRR@5:0.0533


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:9.915440559387207
CL_Loss:1.9252407550811768
Loss:9.070781707763672
CL_Loss:1.736635684967041
Loss:10.700970649719238
CL_Loss:1.9787604808807373
Loss:10.021164894104004
CL_Loss:2.0680782794952393
Loss:9.692376136779785
CL_Loss:1.917803406715393
Loss:9.635580062866211
CL_Loss:2.0195138454437256
Loss:10.303234100341797
CL_Loss:2.266291379928589
Loss:9.891380310058594
CL_Loss:2.0042884349823
Loss:9.956331253051758
CL_Loss:1.9888710975646973
-------------------Start Predicting---------------------:  2026-02-09 11:17:12.374216
Results of LocalSession:

Recall@20: 0.1181 Recall@10: 0.0988  Recall@5:0.0804
HiT@20: 0.1181 HiT@10: 0.0988  HiT@5:0.0804
MRR@20:0.0571 MRR@10:0.0558 MRR@5:0.0533


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:9.319929122924805
CL_Loss:1.7951607704162598
Loss:9.612122535705566
CL_Loss:1.9867818355560303
Loss:9.782318115234375
CL_Loss:1.950103998184204
Loss:9.728581428527832
CL_Loss:1.908029556274414
Loss:9.76768684387207
CL_Loss:1.908103346824646
Loss:9.772201538085938
CL_Loss:2.0162434577941895
Loss:9.985757827758789
CL_Loss:1.9344735145568848
Loss:9.947087287902832
CL_Loss:1.9093924760818481
Loss:9.453205108642578
CL_Loss:1.9320318698883057
-------------------Start Predicting---------------------:  2026-02-09 11:27:44.966510
Results of LocalSession:

Recall@20: 0.1181 Recall@10: 0.0990  Recall@5:0.0804
HiT@20: 0.1181 HiT@10: 0.0990  HiT@5:0.0804
MRR@20:0.0572 MRR@10:0.0558 MRR@5:0.0533


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:10.194536209106445
CL_Loss:2.0087602138519287
Loss:9.43907642364502
CL_Loss:1.8974331617355347
Loss:9.943760871887207
CL_Loss:2.017625570297241
Loss:9.41204833984375
CL_Loss:1.7498931884765625
Loss:10.007110595703125
CL_Loss:1.9245575666427612
Loss:9.89318561553955
CL_Loss:2.0195388793945312
Loss:10.010005950927734
CL_Loss:1.6956419944763184
Loss:9.573685646057129
CL_Loss:1.963128924369812
Loss:9.830564498901367
CL_Loss:1.8827062845230103
-------------------Start Predicting---------------------:  2026-02-09 11:38:02.904575
Results of LocalSession:

Recall@20: 0.1182 Recall@10: 0.0990  Recall@5:0.0805
HiT@20: 0.1182 HiT@10: 0.0990  HiT@5:0.0805
MRR@20:0.0572 MRR@10:0.0558 MRR@5:0.0534


Best Results:

[0.08043507303170645, 0.09909378339864625, 0.11816441040256502, tensor(0.0534), tensor(0.0559), tensor(0.0572, device='cuda:0')]
