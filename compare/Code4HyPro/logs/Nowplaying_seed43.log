Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Nowplaying', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=43)
model is on gpu
  0%|          | 0/825304 [00:00<?, ?it/s] 11%|█         | 87187/825304 [00:00<00:01, 460742.20it/s] 28%|██▊       | 228381/825304 [00:00<00:00, 866860.99it/s] 45%|████▌     | 373512/825304 [00:00<00:00, 1088825.20it/s] 60%|█████▉    | 494853/825304 [00:00<00:00, 779025.85it/s]  77%|███████▋  | 636342/825304 [00:00<00:00, 942330.80it/s] 95%|█████████▍| 781712/825304 [00:00<00:00, 1079585.57it/s]100%|██████████| 825304/825304 [00:01<00:00, 805591.67it/s] 
the number of nodes is :60417
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.225658416748047
CL_Loss:1.9220958948135376
Loss:12.394430160522461
CL_Loss:1.9726676940917969
Loss:11.406286239624023
CL_Loss:2.039458990097046
Loss:10.886735916137695
CL_Loss:1.9236700534820557
Loss:10.335707664489746
CL_Loss:1.9016393423080444
Loss:10.059366226196289
CL_Loss:2.1087660789489746
Loss:10.298548698425293
CL_Loss:2.2354037761688232
Loss:10.323566436767578
CL_Loss:2.2774245738983154
Loss:9.320667266845703
CL_Loss:1.9573209285736084
-------------------Start Predicting---------------------:  2026-02-09 09:56:58.770680
Results of LocalSession:

Recall@20: 0.2121 Recall@10: 0.1564  Recall@5:0.1048
HiT@20: 0.2121 HiT@10: 0.1564  HiT@5:0.1048
MRR@20:0.0723 MRR@10:0.0684 MRR@5:0.0616


Best Results:

[0.10484948343427146, 0.15636132882080514, 0.21211480228001425, tensor(0.0616), tensor(0.0684), tensor(0.0723, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.30704116821289
CL_Loss:1.9682068824768066
Loss:8.506680488586426
CL_Loss:1.8922480344772339
Loss:9.082132339477539
CL_Loss:2.1725406646728516
Loss:9.418058395385742
CL_Loss:2.129340887069702
Loss:7.935248374938965
CL_Loss:1.6711167097091675
Loss:8.70358943939209
CL_Loss:1.9427748918533325
Loss:9.253256797790527
CL_Loss:1.9058030843734741
Loss:8.695377349853516
CL_Loss:1.8552874326705933
Loss:8.769963264465332
CL_Loss:1.9041903018951416
-------------------Start Predicting---------------------:  2026-02-09 10:07:39.005296
Results of LocalSession:

Recall@20: 0.2279 Recall@10: 0.1687  Recall@5:0.1130
HiT@20: 0.2279 HiT@10: 0.1687  HiT@5:0.1130
MRR@20:0.0758 MRR@10:0.0717 MRR@5:0.0644


Best Results:

[0.11298762023512647, 0.16871882793017456, 0.22794576059850374, tensor(0.0644), tensor(0.0717), tensor(0.0758, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:8.190133094787598
CL_Loss:1.8313467502593994
Loss:8.558984756469727
CL_Loss:1.9398287534713745
Loss:8.145062446594238
CL_Loss:1.9566158056259155
Loss:8.348081588745117
CL_Loss:2.1642003059387207
Loss:8.180534362792969
CL_Loss:1.759019136428833
Loss:8.31119441986084
CL_Loss:1.6424949169158936
Loss:8.10855770111084
CL_Loss:1.7567604780197144
Loss:8.143410682678223
CL_Loss:1.9535833597183228
Loss:8.651257514953613
CL_Loss:2.0109360218048096
-------------------Start Predicting---------------------:  2026-02-09 10:18:09.989897
Results of LocalSession:

Recall@20: 0.2321 Recall@10: 0.1725  Recall@5:0.1157
HiT@20: 0.2321 HiT@10: 0.1725  HiT@5:0.1157
MRR@20:0.0771 MRR@10:0.0730 MRR@5:0.0654


Best Results:

[0.11570404346277165, 0.17249287495546847, 0.23205379408621304, tensor(0.0654), tensor(0.0730), tensor(0.0771, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.045380592346191
CL_Loss:1.5096932649612427
Loss:8.311051368713379
CL_Loss:2.0537424087524414
Loss:8.155364990234375
CL_Loss:2.033907175064087
Loss:7.649194240570068
CL_Loss:1.8321142196655273
Loss:8.516180038452148
CL_Loss:2.0376524925231934
Loss:8.26800537109375
CL_Loss:1.7837905883789062
Loss:8.183367729187012
CL_Loss:2.0247652530670166
Loss:8.35857105255127
CL_Loss:1.919484257698059
Loss:7.779233932495117
CL_Loss:1.825061559677124
-------------------Start Predicting---------------------:  2026-02-09 10:28:53.290539
Results of LocalSession:

Recall@20: 0.2341 Recall@10: 0.1743  Recall@5:0.1180
HiT@20: 0.2341 HiT@10: 0.1743  HiT@5:0.1180
MRR@20:0.0778 MRR@10:0.0737 MRR@5:0.0662


Best Results:

[0.11801968293551834, 0.17432980049875313, 0.23412451015318847, tensor(0.0662), tensor(0.0737), tensor(0.0778, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.955209732055664
CL_Loss:1.9756547212600708
Loss:7.71945858001709
CL_Loss:1.618022084236145
Loss:8.432552337646484
CL_Loss:2.1030616760253906
Loss:8.035962104797363
CL_Loss:1.932350516319275
Loss:7.7767720222473145
CL_Loss:1.8965784311294556
Loss:8.094257354736328
CL_Loss:1.9763997793197632
Loss:8.179102897644043
CL_Loss:1.8250707387924194
Loss:8.391904830932617
CL_Loss:2.152341842651367
Loss:8.062908172607422
CL_Loss:1.8044390678405762
-------------------Start Predicting---------------------:  2026-02-09 10:39:20.552566
Results of LocalSession:

Recall@20: 0.2341 Recall@10: 0.1741  Recall@5:0.1184
HiT@20: 0.2341 HiT@10: 0.1741  HiT@5:0.1184
MRR@20:0.0778 MRR@10:0.0736 MRR@5:0.0663


Best Results:

[0.11801968293551834, 0.17432980049875313, 0.23412451015318847, tensor(0.0662), tensor(0.0737), tensor(0.0778, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:7.816758155822754
CL_Loss:1.9030355215072632
Loss:8.601640701293945
CL_Loss:2.0813381671905518
Loss:7.847091197967529
CL_Loss:1.5857677459716797
Loss:8.410965919494629
CL_Loss:2.040423631668091
Loss:8.103418350219727
CL_Loss:2.052175998687744
Loss:7.524165630340576
CL_Loss:1.6339455842971802
Loss:8.068352699279785
CL_Loss:1.9534059762954712
Loss:8.2744140625
CL_Loss:1.847497820854187
Loss:8.203502655029297
CL_Loss:1.9621583223342896
-------------------Start Predicting---------------------:  2026-02-09 10:50:01.614187
Results of LocalSession:

Recall@20: 0.2346 Recall@10: 0.1743  Recall@5:0.1192
HiT@20: 0.2346 HiT@10: 0.1743  HiT@5:0.1192
MRR@20:0.0781 MRR@10:0.0739 MRR@5:0.0666


Best Results:

[0.11924429996437477, 0.1743075347345921, 0.23461435696473104, tensor(0.0666), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:8.070219039916992
CL_Loss:2.1223373413085938
Loss:7.40047025680542
CL_Loss:1.861104130744934
Loss:8.086853981018066
CL_Loss:1.865070104598999
Loss:8.563970565795898
CL_Loss:1.9911233186721802
Loss:8.244115829467773
CL_Loss:2.0364022254943848
Loss:7.923019886016846
CL_Loss:1.924691081047058
Loss:7.963077545166016
CL_Loss:2.176038980484009
Loss:7.509232044219971
CL_Loss:1.8338613510131836
Loss:7.70294713973999
CL_Loss:1.8218313455581665
-------------------Start Predicting---------------------:  2026-02-09 11:00:53.958901
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1742  Recall@5:0.1189
HiT@20: 0.2352 HiT@10: 0.1742  HiT@5:0.1189
MRR@20:0.0780 MRR@10:0.0738 MRR@5:0.0664


Best Results:

[0.11887691485571784, 0.17424073744210902, 0.23517100106875669, tensor(0.0664), tensor(0.0738), tensor(0.0780, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:8.1456880569458
CL_Loss:2.180403470993042
Loss:8.116201400756836
CL_Loss:1.988644003868103
Loss:8.186746597290039
CL_Loss:2.0824248790740967
Loss:8.246641159057617
CL_Loss:2.0141611099243164
Loss:8.02296257019043
CL_Loss:1.7456364631652832
Loss:8.388311386108398
CL_Loss:2.006286382675171
Loss:7.755921363830566
CL_Loss:1.9251480102539062
Loss:7.842136383056641
CL_Loss:1.8805605173110962
Loss:7.715452194213867
CL_Loss:1.8144090175628662
-------------------Start Predicting---------------------:  2026-02-09 11:11:42.738140
Results of LocalSession:

Recall@20: 0.2353 Recall@10: 0.1745  Recall@5:0.1190
HiT@20: 0.2353 HiT@10: 0.1745  HiT@5:0.1190
MRR@20:0.0781 MRR@10:0.0739 MRR@5:0.0665


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:8.175145149230957
CL_Loss:1.913145661354065
Loss:8.788005828857422
CL_Loss:2.333862781524658
Loss:7.980982780456543
CL_Loss:2.0586442947387695
Loss:8.282736778259277
CL_Loss:2.0486717224121094
Loss:8.087774276733398
CL_Loss:1.9488842487335205
Loss:8.072449684143066
CL_Loss:2.0270674228668213
Loss:7.656057834625244
CL_Loss:1.8574905395507812
Loss:7.842845916748047
CL_Loss:1.9521507024765015
Loss:8.254022598266602
CL_Loss:1.930774450302124
-------------------Start Predicting---------------------:  2026-02-09 11:22:22.852913
Results of LocalSession:

Recall@20: 0.2350 Recall@10: 0.1744  Recall@5:0.1189
HiT@20: 0.2350 HiT@10: 0.1744  HiT@5:0.1189
MRR@20:0.0781 MRR@10:0.0739 MRR@5:0.0665


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:8.02570915222168
CL_Loss:2.166731119155884
Loss:6.90378475189209
CL_Loss:1.8387035131454468
Loss:8.137457847595215
CL_Loss:2.060227155685425
Loss:8.198326110839844
CL_Loss:2.1121978759765625
Loss:7.191305160522461
CL_Loss:1.812872290611267
Loss:8.813948631286621
CL_Loss:2.3086297512054443
Loss:8.101387023925781
CL_Loss:2.2686352729797363
Loss:7.864565849304199
CL_Loss:1.9085862636566162
Loss:8.081274032592773
CL_Loss:1.9176268577575684
-------------------Start Predicting---------------------:  2026-02-09 11:32:44.236829
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1745  Recall@5:0.1191
HiT@20: 0.2351 HiT@10: 0.1745  HiT@5:0.1191
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:8.18114948272705
CL_Loss:2.312148094177246
Loss:7.756946563720703
CL_Loss:2.030717372894287
Loss:7.515782833099365
CL_Loss:1.963399887084961
Loss:8.58310604095459
CL_Loss:2.112204074859619
Loss:7.854243755340576
CL_Loss:1.864954948425293
Loss:7.923057556152344
CL_Loss:2.136249303817749
Loss:7.902647018432617
CL_Loss:2.0522186756134033
Loss:7.663884162902832
CL_Loss:1.5580182075500488
Loss:8.16135025024414
CL_Loss:2.2206945419311523
-------------------Start Predicting---------------------:  2026-02-09 11:43:14.863000
Results of LocalSession:

Recall@20: 0.2350 Recall@10: 0.1746  Recall@5:0.1191
HiT@20: 0.2350 HiT@10: 0.1746  HiT@5:0.1191
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.7520976066589355
CL_Loss:1.4522662162780762
Loss:8.019889831542969
CL_Loss:2.0919954776763916
Loss:7.4451799392700195
CL_Loss:1.8954710960388184
Loss:7.233949661254883
CL_Loss:1.6823887825012207
Loss:7.645902633666992
CL_Loss:1.671311616897583
Loss:8.005876541137695
CL_Loss:1.7475361824035645
Loss:7.790500640869141
CL_Loss:2.082364797592163
Loss:7.971806526184082
CL_Loss:1.9617092609405518
Loss:8.093701362609863
CL_Loss:1.9768339395523071
-------------------Start Predicting---------------------:  2026-02-09 11:53:22.380987
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1745  Recall@5:0.1190
HiT@20: 0.2351 HiT@10: 0.1745  HiT@5:0.1190
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:7.790261268615723
CL_Loss:1.960506558418274
Loss:8.43433666229248
CL_Loss:2.1127030849456787
Loss:7.7618865966796875
CL_Loss:1.98296320438385
Loss:7.785469055175781
CL_Loss:1.8596805334091187
Loss:7.295147895812988
CL_Loss:1.7225053310394287
Loss:7.345803737640381
CL_Loss:1.7657402753829956
Loss:8.209073066711426
CL_Loss:2.1192033290863037
Loss:7.5667290687561035
CL_Loss:1.957244873046875
Loss:8.07608413696289
CL_Loss:2.126249313354492
-------------------Start Predicting---------------------:  2026-02-09 12:03:32.927124
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1745  Recall@5:0.1189
HiT@20: 0.2352 HiT@10: 0.1745  HiT@5:0.1189
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:8.297340393066406
CL_Loss:2.3073387145996094
Loss:7.599147319793701
CL_Loss:1.7789082527160645
Loss:7.941716194152832
CL_Loss:2.181867837905884
Loss:7.780407905578613
CL_Loss:1.96052086353302
Loss:8.503406524658203
CL_Loss:2.22076678276062
Loss:7.824656963348389
CL_Loss:1.9340206384658813
Loss:7.625548362731934
CL_Loss:1.8962740898132324
Loss:7.854329586029053
CL_Loss:1.7896114587783813
Loss:7.648861408233643
CL_Loss:1.8252230882644653
-------------------Start Predicting---------------------:  2026-02-09 12:13:46.653256
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1746  Recall@5:0.1190
HiT@20: 0.2351 HiT@10: 0.1746  HiT@5:0.1190
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:8.183573722839355
CL_Loss:2.0310122966766357
Loss:7.51609992980957
CL_Loss:1.6131353378295898
Loss:7.881989479064941
CL_Loss:1.953461766242981
Loss:7.788290023803711
CL_Loss:1.9493530988693237
Loss:7.1091437339782715
CL_Loss:1.7447773218154907
Loss:8.294732093811035
CL_Loss:2.44071102142334
Loss:8.280974388122559
CL_Loss:2.069394826889038
Loss:7.982002258300781
CL_Loss:1.8658957481384277
Loss:7.873370170593262
CL_Loss:2.157212257385254
-------------------Start Predicting---------------------:  2026-02-09 12:23:49.522758
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1746  Recall@5:0.1190
HiT@20: 0.2351 HiT@10: 0.1746  HiT@5:0.1190
MRR@20:0.0782 MRR@10:0.0740 MRR@5:0.0666


Best Results:

[0.11897711079444247, 0.17449679372996083, 0.2353491271820449, tensor(0.0665), tensor(0.0739), tensor(0.0781, device='cuda:0')]
