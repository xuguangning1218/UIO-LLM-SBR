Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Nowplaying', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=45)
model is on gpu
  0%|          | 0/825304 [00:00<?, ?it/s] 11%|█         | 87187/825304 [00:00<00:01, 445958.12it/s] 27%|██▋       | 225577/825304 [00:00<00:00, 841950.95it/s] 45%|████▍     | 368677/825304 [00:00<00:00, 1063556.26it/s] 59%|█████▉    | 488230/825304 [00:00<00:00, 757791.96it/s]  76%|███████▌  | 627187/825304 [00:00<00:00, 918449.17it/s] 93%|█████████▎| 770899/825304 [00:00<00:00, 1056658.66it/s]100%|██████████| 825304/825304 [00:01<00:00, 788125.19it/s] 
the number of nodes is :60417
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.108327865600586
CL_Loss:2.0168471336364746
Loss:11.744844436645508
CL_Loss:1.7007641792297363
Loss:11.052244186401367
CL_Loss:2.0780012607574463
Loss:11.129609107971191
CL_Loss:2.0227556228637695
Loss:11.084063529968262
CL_Loss:2.2404167652130127
Loss:9.469042778015137
CL_Loss:1.8745888471603394
Loss:10.126457214355469
CL_Loss:2.0631227493286133
Loss:9.475235939025879
CL_Loss:1.9407050609588623
Loss:9.431081771850586
CL_Loss:1.7620468139648438
-------------------Start Predicting---------------------:  2026-02-09 12:35:13.492406
Results of LocalSession:

Recall@20: 0.2106 Recall@10: 0.1560  Recall@5:0.1058
HiT@20: 0.2106 HiT@10: 0.1560  HiT@5:0.1058
MRR@20:0.0726 MRR@10:0.0688 MRR@5:0.0622


Best Results:

[0.10575124688279301, 0.15603847524047026, 0.2106229960812255, tensor(0.0622), tensor(0.0688), tensor(0.0726, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.795721054077148
CL_Loss:2.0611042976379395
Loss:8.461718559265137
CL_Loss:2.0497052669525146
Loss:8.924857139587402
CL_Loss:2.2404630184173584
Loss:9.196549415588379
CL_Loss:1.9953269958496094
Loss:8.825435638427734
CL_Loss:1.882193684577942
Loss:9.08068561553955
CL_Loss:2.3258912563323975
Loss:9.412590026855469
CL_Loss:1.9718247652053833
Loss:9.140847206115723
CL_Loss:2.207115650177002
Loss:8.973299980163574
CL_Loss:1.9482744932174683
-------------------Start Predicting---------------------:  2026-02-09 12:45:48.505531
Results of LocalSession:

Recall@20: 0.2268 Recall@10: 0.1684  Recall@5:0.1135
HiT@20: 0.2268 HiT@10: 0.1684  HiT@5:0.1135
MRR@20:0.0761 MRR@10:0.0721 MRR@5:0.0648


Best Results:

[0.11353313145707161, 0.16844050587816173, 0.22682133950837194, tensor(0.0648), tensor(0.0721), tensor(0.0761, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:9.013028144836426
CL_Loss:2.254533529281616
Loss:8.527008056640625
CL_Loss:1.9874099493026733
Loss:9.06290054321289
CL_Loss:2.1705238819122314
Loss:8.52249526977539
CL_Loss:2.2331764698028564
Loss:8.29590129852295
CL_Loss:1.9210619926452637
Loss:8.23279094696045
CL_Loss:1.852105975151062
Loss:9.023042678833008
CL_Loss:2.2409939765930176
Loss:8.62923812866211
CL_Loss:2.089510679244995
Loss:7.8343119621276855
CL_Loss:1.789432168006897
-------------------Start Predicting---------------------:  2026-02-09 12:55:57.435389
Results of LocalSession:

Recall@20: 0.2312 Recall@10: 0.1717  Recall@5:0.1158
HiT@20: 0.2312 HiT@10: 0.1717  HiT@5:0.1158
MRR@20:0.0770 MRR@10:0.0729 MRR@5:0.0655


Best Results:

[0.11577084075525472, 0.17172470609191307, 0.2312410936943356, tensor(0.0655), tensor(0.0729), tensor(0.0770, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.716206073760986
CL_Loss:1.8393999338150024
Loss:8.374887466430664
CL_Loss:2.385122537612915
Loss:8.050615310668945
CL_Loss:1.9951756000518799
Loss:8.071157455444336
CL_Loss:1.9685598611831665
Loss:8.856624603271484
CL_Loss:2.5561676025390625
Loss:8.425593376159668
CL_Loss:1.9779870510101318
Loss:7.513742446899414
CL_Loss:1.823319673538208
Loss:7.925241947174072
CL_Loss:1.932217001914978
Loss:8.849184036254883
CL_Loss:1.9609326124191284
-------------------Start Predicting---------------------:  2026-02-09 13:05:57.921157
Results of LocalSession:

Recall@20: 0.2332 Recall@10: 0.1730  Recall@5:0.1172
HiT@20: 0.2332 HiT@10: 0.1730  HiT@5:0.1172
MRR@20:0.0775 MRR@10:0.0734 MRR@5:0.0660


Best Results:

[0.11717358389739936, 0.17302725329533308, 0.23316708229426433, tensor(0.0660), tensor(0.0734), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:8.31022834777832
CL_Loss:2.1902360916137695
Loss:8.68643569946289
CL_Loss:2.4508113861083984
Loss:8.050056457519531
CL_Loss:2.1128532886505127
Loss:7.546939373016357
CL_Loss:1.7459467649459839
Loss:8.170886993408203
CL_Loss:1.7946887016296387
Loss:7.756690502166748
CL_Loss:1.9136337041854858
Loss:8.166365623474121
CL_Loss:1.982810139656067
Loss:8.03853702545166
CL_Loss:2.1050021648406982
Loss:7.368259429931641
CL_Loss:1.819019079208374
-------------------Start Predicting---------------------:  2026-02-09 13:15:56.797717
Results of LocalSession:

Recall@20: 0.2340 Recall@10: 0.1730  Recall@5:0.1175
HiT@20: 0.2340 HiT@10: 0.1730  HiT@5:0.1175
MRR@20:0.0776 MRR@10:0.0734 MRR@5:0.0660


Best Results:

[0.11751870324189526, 0.17304951905949412, 0.23396864980406126, tensor(0.0660), tensor(0.0734), tensor(0.0776, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:8.219584465026855
CL_Loss:2.035640239715576
Loss:7.955111503601074
CL_Loss:2.040576219558716
Loss:7.355936527252197
CL_Loss:1.8532952070236206
Loss:8.289463996887207
CL_Loss:1.7218700647354126
Loss:8.418107032775879
CL_Loss:2.089921474456787
Loss:8.155869483947754
CL_Loss:2.0419037342071533
Loss:7.754438877105713
CL_Loss:1.9680099487304688
Loss:7.684063911437988
CL_Loss:1.9100686311721802
Loss:7.2832932472229
CL_Loss:1.7609100341796875
-------------------Start Predicting---------------------:  2026-02-09 13:26:17.827829
Results of LocalSession:

Recall@20: 0.2339 Recall@10: 0.1735  Recall@5:0.1178
HiT@20: 0.2339 HiT@10: 0.1735  HiT@5:0.1178
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0661


Best Results:

[0.11751870324189526, 0.17304951905949412, 0.23396864980406126, tensor(0.0660), tensor(0.0734), tensor(0.0776, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:7.596252918243408
CL_Loss:1.8963063955307007
Loss:7.8686394691467285
CL_Loss:1.9748258590698242
Loss:8.225818634033203
CL_Loss:2.0361416339874268
Loss:7.651706218719482
CL_Loss:1.9343289136886597
Loss:7.994297981262207
CL_Loss:1.8997334241867065
Loss:7.760956287384033
CL_Loss:1.8598099946975708
Loss:7.873052597045898
CL_Loss:1.758469820022583
Loss:7.834865570068359
CL_Loss:1.7110143899917603
Loss:7.814789295196533
CL_Loss:2.0306944847106934
-------------------Start Predicting---------------------:  2026-02-09 13:36:43.031404
Results of LocalSession:

Recall@20: 0.2337 Recall@10: 0.1734  Recall@5:0.1185
HiT@20: 0.2337 HiT@10: 0.1734  HiT@5:0.1185
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0663


Best Results:

[0.11751870324189526, 0.17304951905949412, 0.23396864980406126, tensor(0.0660), tensor(0.0734), tensor(0.0776, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:8.139361381530762
CL_Loss:2.0581860542297363
Loss:7.261596202850342
CL_Loss:1.8007711172103882
Loss:8.310492515563965
CL_Loss:2.205364227294922
Loss:7.547263145446777
CL_Loss:1.8622748851776123
Loss:8.231972694396973
CL_Loss:2.1920320987701416
Loss:8.459310531616211
CL_Loss:2.0952348709106445
Loss:8.251434326171875
CL_Loss:2.159317970275879
Loss:8.388404846191406
CL_Loss:2.2411398887634277
Loss:7.450685977935791
CL_Loss:1.711489200592041
-------------------Start Predicting---------------------:  2026-02-09 13:47:15.185915
Results of LocalSession:

Recall@20: 0.2340 Recall@10: 0.1735  Recall@5:0.1185
HiT@20: 0.2340 HiT@10: 0.1735  HiT@5:0.1185
MRR@20:0.0778 MRR@10:0.0736 MRR@5:0.0662


Best Results:

[0.11845386533665836, 0.17350596722479517, 0.23404657997862488, tensor(0.0662), tensor(0.0736), tensor(0.0778, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:8.433021545410156
CL_Loss:2.0133285522460938
Loss:7.655285835266113
CL_Loss:1.8610423803329468
Loss:8.566099166870117
CL_Loss:2.207792043685913
Loss:7.386041164398193
CL_Loss:1.9795455932617188
Loss:8.094512939453125
CL_Loss:1.9183268547058105
Loss:8.312324523925781
CL_Loss:2.1386008262634277
Loss:7.870179176330566
CL_Loss:1.9762918949127197
Loss:7.394940376281738
CL_Loss:1.9328954219818115
Loss:7.307563781738281
CL_Loss:1.77152419090271
-------------------Start Predicting---------------------:  2026-02-09 13:58:08.373449
Results of LocalSession:

Recall@20: 0.2343 Recall@10: 0.1736  Recall@5:0.1183
HiT@20: 0.2343 HiT@10: 0.1736  HiT@5:0.1183
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11825347345920913, 0.17360616316351976, 0.23428037050231565, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:7.713279724121094
CL_Loss:1.901886224746704
Loss:8.327593803405762
CL_Loss:2.1920199394226074
Loss:7.86427640914917
CL_Loss:1.9229750633239746
Loss:8.130942344665527
CL_Loss:1.7100497484207153
Loss:8.191667556762695
CL_Loss:2.042419195175171
Loss:8.090546607971191
CL_Loss:1.957580804824829
Loss:8.4200439453125
CL_Loss:2.223365068435669
Loss:7.721950054168701
CL_Loss:1.9809914827346802
Loss:8.344107627868652
CL_Loss:2.2286577224731445
-------------------Start Predicting---------------------:  2026-02-09 14:09:09.636994
Results of LocalSession:

Recall@20: 0.2343 Recall@10: 0.1737  Recall@5:0.1184
HiT@20: 0.2343 HiT@10: 0.1737  HiT@5:0.1184
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0661


Best Results:

[0.11825347345920913, 0.17360616316351976, 0.23428037050231565, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:7.944569110870361
CL_Loss:1.834159016609192
Loss:8.699646949768066
CL_Loss:2.349740743637085
Loss:8.19080638885498
CL_Loss:2.127316951751709
Loss:7.628992557525635
CL_Loss:1.8120003938674927
Loss:7.809136390686035
CL_Loss:2.027956485748291
Loss:7.74830961227417
CL_Loss:1.886190414428711
Loss:7.831202507019043
CL_Loss:1.85008704662323
Loss:7.6505022048950195
CL_Loss:1.8608205318450928
Loss:7.470419883728027
CL_Loss:1.7788399457931519
-------------------Start Predicting---------------------:  2026-02-09 14:19:58.376656
Results of LocalSession:

Recall@20: 0.2343 Recall@10: 0.1737  Recall@5:0.1185
HiT@20: 0.2343 HiT@10: 0.1737  HiT@5:0.1185
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11846499821873886, 0.17369522622016387, 0.2343249020306377, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:8.761642456054688
CL_Loss:2.2385623455047607
Loss:8.358353614807129
CL_Loss:2.274707078933716
Loss:7.782769203186035
CL_Loss:1.8755567073822021
Loss:8.52220344543457
CL_Loss:2.143548011779785
Loss:7.585949897766113
CL_Loss:1.9800999164581299
Loss:8.105476379394531
CL_Loss:2.0687806606292725
Loss:7.738987922668457
CL_Loss:2.0053279399871826
Loss:7.928513526916504
CL_Loss:1.8520475625991821
Loss:8.374456405639648
CL_Loss:2.158236265182495
-------------------Start Predicting---------------------:  2026-02-09 14:30:58.240232
Results of LocalSession:

Recall@20: 0.2344 Recall@10: 0.1737  Recall@5:0.1185
HiT@20: 0.2344 HiT@10: 0.1737  HiT@5:0.1185
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11849839686498041, 0.17369522622016387, 0.23444736373352335, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:8.149953842163086
CL_Loss:1.960996150970459
Loss:7.607694625854492
CL_Loss:1.8874280452728271
Loss:8.143383026123047
CL_Loss:2.0188088417053223
Loss:7.762290000915527
CL_Loss:2.090101718902588
Loss:8.33614730834961
CL_Loss:2.032870292663574
Loss:7.834064483642578
CL_Loss:2.0831527709960938
Loss:7.928523540496826
CL_Loss:2.045684814453125
Loss:8.38240909576416
CL_Loss:2.016239643096924
Loss:7.662363529205322
CL_Loss:1.9536775350570679
-------------------Start Predicting---------------------:  2026-02-09 14:41:06.419019
Results of LocalSession:

Recall@20: 0.2345 Recall@10: 0.1737  Recall@5:0.1186
HiT@20: 0.2345 HiT@10: 0.1737  HiT@5:0.1186
MRR@20:0.0777 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11859859280370502, 0.17368409333808335, 0.23451416102600642, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:7.730891227722168
CL_Loss:1.9329341650009155
Loss:7.729069709777832
CL_Loss:1.982670545578003
Loss:7.932033061981201
CL_Loss:2.0230607986450195
Loss:8.284523010253906
CL_Loss:2.247575283050537
Loss:7.759239673614502
CL_Loss:1.8558017015457153
Loss:7.802402019500732
CL_Loss:1.9189025163650513
Loss:8.44231128692627
CL_Loss:2.336738348007202
Loss:7.54770565032959
CL_Loss:1.712790846824646
Loss:7.612936496734619
CL_Loss:1.988523006439209
-------------------Start Predicting---------------------:  2026-02-09 14:51:46.330088
Results of LocalSession:

Recall@20: 0.2344 Recall@10: 0.1737  Recall@5:0.1185
HiT@20: 0.2344 HiT@10: 0.1737  HiT@5:0.1185
MRR@20:0.0778 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11859859280370502, 0.17368409333808335, 0.23451416102600642, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:7.231673240661621
CL_Loss:1.740975022315979
Loss:8.034225463867188
CL_Loss:1.9293501377105713
Loss:7.8986406326293945
CL_Loss:1.9321399927139282
Loss:7.677346706390381
CL_Loss:1.9256110191345215
Loss:7.221724033355713
CL_Loss:1.652549147605896
Loss:8.359622955322266
CL_Loss:2.0517585277557373
Loss:7.500415325164795
CL_Loss:1.7145906686782837
Loss:8.098876953125
CL_Loss:2.2355477809906006
Loss:8.00432014465332
CL_Loss:2.1555590629577637
-------------------Start Predicting---------------------:  2026-02-09 15:02:22.335891
Results of LocalSession:

Recall@20: 0.2345 Recall@10: 0.1737  Recall@5:0.1185
HiT@20: 0.2345 HiT@10: 0.1737  HiT@5:0.1185
MRR@20:0.0778 MRR@10:0.0735 MRR@5:0.0662


Best Results:

[0.11859859280370502, 0.17368409333808335, 0.23451416102600642, tensor(0.0662), tensor(0.0735), tensor(0.0777, device='cuda:0')]
