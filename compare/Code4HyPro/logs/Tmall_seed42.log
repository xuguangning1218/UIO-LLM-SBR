Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Tmall', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=42)
model is on gpu
  0%|          | 0/351268 [00:00<?, ?it/s] 17%|█▋        | 58801/351268 [00:00<00:00, 587989.53it/s] 48%|████▊     | 169776/351268 [00:00<00:00, 702009.78it/s] 87%|████████▋ | 304662/351268 [00:00<00:00, 958992.54it/s]100%|██████████| 351268/351268 [00:00<00:00, 916851.14it/s]
the number of nodes is :40728
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:10.906731605529785
CL_Loss:2.285137176513672
Loss:10.356061935424805
CL_Loss:2.4155497550964355
Loss:9.3989839553833
CL_Loss:2.327258348464966
Loss:8.402114868164062
CL_Loss:2.398732900619507
-------------------Start Predicting---------------------:  2026-02-09 05:50:15.769932
Results of LocalSession:

Recall@20: 0.3804 Recall@10: 0.3354  Recall@5:0.2755
HiT@20: 0.3804 HiT@10: 0.3354  HiT@5:0.2755
MRR@20:0.1904 MRR@10:0.1873 MRR@5:0.1792


Best Results:

[0.2755425129353618, 0.33535408139624684, 0.38037686307823, tensor(0.1792), tensor(0.1873), tensor(0.1904, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.087247848510742
CL_Loss:2.4644737243652344
Loss:7.195492744445801
CL_Loss:2.4612643718719482
Loss:7.857481002807617
CL_Loss:2.3730010986328125
Loss:8.373371124267578
CL_Loss:2.37434720993042
-------------------Start Predicting---------------------:  2026-02-09 05:54:54.798098
Results of LocalSession:

Recall@20: 0.3950 Recall@10: 0.3399  Recall@5:0.2720
HiT@20: 0.3950 HiT@10: 0.3399  HiT@5:0.2720
MRR@20:0.1896 MRR@10:0.1857 MRR@5:0.1767


Best Results:

[0.2719515020464901, 0.3399104177928798, 0.39501119777589005, tensor(0.1767), tensor(0.1857), tensor(0.1896, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.883082389831543
CL_Loss:2.381507158279419
Loss:6.720484733581543
CL_Loss:2.2405407428741455
Loss:7.187206268310547
CL_Loss:2.4335360527038574
Loss:7.414048671722412
CL_Loss:2.31834077835083
-------------------Start Predicting---------------------:  2026-02-09 05:59:37.699224
Results of LocalSession:

Recall@20: 0.3981 Recall@10: 0.3399  Recall@5:0.2696
HiT@20: 0.3981 HiT@10: 0.3399  HiT@5:0.2696
MRR@20:0.1890 MRR@10:0.1849 MRR@5:0.1755


Best Results:

[0.2695574947872423, 0.3398718047725693, 0.3980616263804155, tensor(0.1755), tensor(0.1849), tensor(0.1890, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:6.767373085021973
CL_Loss:2.460326671600342
Loss:6.875053405761719
CL_Loss:2.2842299938201904
Loss:6.9782609939575195
CL_Loss:2.5754854679107666
Loss:6.8851318359375
CL_Loss:2.3204727172851562
-------------------Start Predicting---------------------:  2026-02-09 06:04:03.663532
Results of LocalSession:

Recall@20: 0.4007 Recall@10: 0.3396  Recall@5:0.2686
HiT@20: 0.4007 HiT@10: 0.3396  HiT@5:0.2686
MRR@20:0.1882 MRR@10:0.1839 MRR@5:0.1744


Best Results:

[0.2686307822997915, 0.33960151363039615, 0.400687311761526, tensor(0.1744), tensor(0.1839), tensor(0.1882, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.101901054382324
CL_Loss:2.4893362522125244
Loss:6.549198150634766
CL_Loss:2.53155255317688
Loss:6.14491081237793
CL_Loss:2.2022511959075928
Loss:6.84057092666626
CL_Loss:2.2905220985412598
-------------------Start Predicting---------------------:  2026-02-09 06:08:36.796817
Results of LocalSession:

Recall@20: 0.4018 Recall@10: 0.3393  Recall@5:0.2684
HiT@20: 0.4018 HiT@10: 0.3393  HiT@5:0.2684
MRR@20:0.1879 MRR@10:0.1835 MRR@5:0.1740


Best Results:

[0.26836049115761834, 0.3392539964476021, 0.40184570237083944, tensor(0.1740), tensor(0.1835), tensor(0.1879, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:7.083599090576172
CL_Loss:2.447679281234741
Loss:6.631454944610596
CL_Loss:2.3385825157165527
Loss:6.53969669342041
CL_Loss:2.242027759552002
Loss:6.715327262878418
CL_Loss:2.2220845222473145
-------------------Start Predicting---------------------:  2026-02-09 06:13:18.711616
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3398  Recall@5:0.2682
HiT@20: 0.4020 HiT@10: 0.3398  HiT@5:0.2682
MRR@20:0.1878 MRR@10:0.1834 MRR@5:0.1738


Best Results:

[0.268244652096687, 0.33975596571163796, 0.40200015445208126, tensor(0.1738), tensor(0.1834), tensor(0.1878, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.751441955566406
CL_Loss:2.4119322299957275
Loss:6.371779441833496
CL_Loss:2.450550079345703
Loss:6.521816253662109
CL_Loss:2.299638032913208
Loss:6.638207912445068
CL_Loss:2.2624011039733887
-------------------Start Predicting---------------------:  2026-02-09 06:18:05.098266
Results of LocalSession:

Recall@20: 0.4023 Recall@10: 0.3400  Recall@5:0.2686
HiT@20: 0.4023 HiT@10: 0.3400  HiT@5:0.2686
MRR@20:0.1876 MRR@10:0.1832 MRR@5:0.1736


Best Results:

[0.26859216927948104, 0.3400262568538111, 0.4022704455942544, tensor(0.1736), tensor(0.1832), tensor(0.1876, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.508983612060547
CL_Loss:2.413043260574341
Loss:6.7974348068237305
CL_Loss:2.318834066390991
Loss:7.129824638366699
CL_Loss:2.5975024700164795
Loss:7.148239612579346
CL_Loss:2.1656432151794434
-------------------Start Predicting---------------------:  2026-02-09 06:22:44.040518
Results of LocalSession:

Recall@20: 0.4025 Recall@10: 0.3398  Recall@5:0.2684
HiT@20: 0.4025 HiT@10: 0.3398  HiT@5:0.2684
MRR@20:0.1877 MRR@10:0.1832 MRR@5:0.1737


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.894387245178223
CL_Loss:2.5328361988067627
Loss:6.556563377380371
CL_Loss:2.4411544799804688
Loss:6.443753242492676
CL_Loss:2.400709867477417
Loss:6.5840559005737305
CL_Loss:2.5336902141571045
-------------------Start Predicting---------------------:  2026-02-09 06:27:34.081197
Results of LocalSession:

Recall@20: 0.4025 Recall@10: 0.3398  Recall@5:0.2681
HiT@20: 0.4025 HiT@10: 0.3398  HiT@5:0.2681
MRR@20:0.1876 MRR@10:0.1831 MRR@5:0.1735


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.296909332275391
CL_Loss:2.340613603591919
Loss:6.287383079528809
CL_Loss:2.3980400562286377
Loss:6.189748764038086
CL_Loss:2.1611549854278564
Loss:6.607643127441406
CL_Loss:2.5434322357177734
-------------------Start Predicting---------------------:  2026-02-09 06:32:24.338674
Results of LocalSession:

Recall@20: 0.4021 Recall@10: 0.3398  Recall@5:0.2684
HiT@20: 0.4021 HiT@10: 0.3398  HiT@5:0.2684
MRR@20:0.1875 MRR@10:0.1831 MRR@5:0.1736


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.156960964202881
CL_Loss:2.3276617527008057
Loss:6.893710136413574
CL_Loss:2.4068124294281006
Loss:6.559283256530762
CL_Loss:2.641056537628174
Loss:6.208583831787109
CL_Loss:2.3423590660095215
-------------------Start Predicting---------------------:  2026-02-09 06:37:06.829036
Results of LocalSession:

Recall@20: 0.4023 Recall@10: 0.3401  Recall@5:0.2684
HiT@20: 0.4023 HiT@10: 0.3401  HiT@5:0.2684
MRR@20:0.1875 MRR@10:0.1831 MRR@5:0.1736


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.49119758605957
CL_Loss:2.114039897918701
Loss:6.950226783752441
CL_Loss:2.4472084045410156
Loss:6.63151741027832
CL_Loss:2.305866241455078
Loss:6.950602054595947
CL_Loss:2.412949562072754
-------------------Start Predicting---------------------:  2026-02-09 06:41:55.471620
Results of LocalSession:

Recall@20: 0.4025 Recall@10: 0.3402  Recall@5:0.2682
HiT@20: 0.4025 HiT@10: 0.3402  HiT@5:0.2682
MRR@20:0.1876 MRR@10:0.1833 MRR@5:0.1736


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.774399757385254
CL_Loss:2.5075066089630127
Loss:6.148615837097168
CL_Loss:2.379307985305786
Loss:6.339834690093994
CL_Loss:2.297386646270752
Loss:6.394940376281738
CL_Loss:2.25612473487854
-------------------Start Predicting---------------------:  2026-02-09 06:46:42.742490
Results of LocalSession:

Recall@20: 0.4022 Recall@10: 0.3400  Recall@5:0.2684
HiT@20: 0.4022 HiT@10: 0.3400  HiT@5:0.2684
MRR@20:0.1875 MRR@10:0.1831 MRR@5:0.1736


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.035181999206543
CL_Loss:2.101222038269043
Loss:6.216442584991455
CL_Loss:2.1884026527404785
Loss:6.712358474731445
CL_Loss:2.375842332839966
Loss:6.462653160095215
CL_Loss:2.096693754196167
-------------------Start Predicting---------------------:  2026-02-09 06:51:07.365828
Results of LocalSession:

Recall@20: 0.4020 Recall@10: 0.3400  Recall@5:0.2682
HiT@20: 0.4020 HiT@10: 0.3400  HiT@5:0.2682
MRR@20:0.1875 MRR@10:0.1831 MRR@5:0.1735


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.8623857498168945
CL_Loss:2.5999996662139893
Loss:6.425075531005859
CL_Loss:2.3133108615875244
Loss:7.004147529602051
CL_Loss:2.7248220443725586
Loss:6.529321670532227
CL_Loss:2.347454786300659
-------------------Start Predicting---------------------:  2026-02-09 06:56:02.489367
Results of LocalSession:

Recall@20: 0.4022 Recall@10: 0.3399  Recall@5:0.2683
HiT@20: 0.4022 HiT@10: 0.3399  HiT@5:0.2683
MRR@20:0.1876 MRR@10:0.1833 MRR@5:0.1737


Best Results:

[0.2683991041779288, 0.33975596571163796, 0.40254073673642754, tensor(0.1737), tensor(0.1832), tensor(0.1877, device='cuda:0')]
