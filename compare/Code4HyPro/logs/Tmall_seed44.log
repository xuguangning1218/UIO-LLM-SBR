Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Tmall', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=44)
model is on gpu
  0%|          | 0/351268 [00:00<?, ?it/s] 10%|█         | 35192/351268 [00:00<00:00, 351906.91it/s] 48%|████▊     | 169776/351268 [00:00<00:00, 638124.68it/s] 84%|████████▍ | 295766/351268 [00:00<00:00, 863257.61it/s]100%|██████████| 351268/351268 [00:00<00:00, 825345.79it/s]
the number of nodes is :40728
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:11.05473518371582
CL_Loss:2.432603597640991
Loss:9.908918380737305
CL_Loss:2.4214885234832764
Loss:9.565589904785156
CL_Loss:2.4031381607055664
Loss:8.11646842956543
CL_Loss:2.2924282550811768
-------------------Start Predicting---------------------:  2026-02-09 07:41:14.065735
Results of LocalSession:

Recall@20: 0.3808 Recall@10: 0.3340  Recall@5:0.2742
HiT@20: 0.3808 HiT@10: 0.3340  HiT@5:0.2742
MRR@20:0.1916 MRR@10:0.1883 MRR@5:0.1802


Best Results:

[0.27422967024480654, 0.33396401266507064, 0.38076299328133445, tensor(0.1802), tensor(0.1883), tensor(0.1916, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.45436954498291
CL_Loss:2.3710286617279053
Loss:8.246706008911133
CL_Loss:2.5326569080352783
Loss:8.179731369018555
CL_Loss:2.481663227081299
Loss:7.96864652633667
CL_Loss:2.3754477500915527
-------------------Start Predicting---------------------:  2026-02-09 07:45:27.006465
Results of LocalSession:

Recall@20: 0.3921 Recall@10: 0.3369  Recall@5:0.2708
HiT@20: 0.3921 HiT@10: 0.3369  HiT@5:0.2708
MRR@20:0.1890 MRR@10:0.1852 MRR@5:0.1762


Best Results:

[0.27075449841686616, 0.33689860220866474, 0.3921152212526064, tensor(0.1762), tensor(0.1852), tensor(0.1890, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.930576324462891
CL_Loss:2.399387836456299
Loss:7.510529518127441
CL_Loss:2.5576717853546143
Loss:7.369431018829346
CL_Loss:2.390531063079834
Loss:7.63969612121582
CL_Loss:2.3772037029266357
-------------------Start Predicting---------------------:  2026-02-09 07:49:39.137837
Results of LocalSession:

Recall@20: 0.3963 Recall@10: 0.3377  Recall@5:0.2708
HiT@20: 0.3963 HiT@10: 0.3377  HiT@5:0.2708
MRR@20:0.1884 MRR@10:0.1843 MRR@5:0.1753


Best Results:

[0.27083172445748704, 0.33770947563518416, 0.3962854274461348, tensor(0.1753), tensor(0.1843), tensor(0.1884, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:6.756254196166992
CL_Loss:2.49845290184021
Loss:6.715995788574219
CL_Loss:2.333085060119629
Loss:7.551776885986328
CL_Loss:2.523685932159424
Loss:7.042300224304199
CL_Loss:2.3593227863311768
-------------------Start Predicting---------------------:  2026-02-09 07:53:52.147926
Results of LocalSession:

Recall@20: 0.3980 Recall@10: 0.3392  Recall@5:0.2686
HiT@20: 0.3980 HiT@10: 0.3392  HiT@5:0.2686
MRR@20:0.1875 MRR@10:0.1834 MRR@5:0.1738


Best Results:

[0.2685535562591706, 0.33917677040698124, 0.39802301336010504, tensor(0.1738), tensor(0.1834), tensor(0.1875, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.335578918457031
CL_Loss:2.1139426231384277
Loss:6.693390369415283
CL_Loss:2.3323068618774414
Loss:6.968141078948975
CL_Loss:2.4482250213623047
Loss:6.687924861907959
CL_Loss:2.278411865234375
-------------------Start Predicting---------------------:  2026-02-09 07:58:10.948867
Results of LocalSession:

Recall@20: 0.3993 Recall@10: 0.3394  Recall@5:0.2690
HiT@20: 0.3993 HiT@10: 0.3394  HiT@5:0.2690
MRR@20:0.1875 MRR@10:0.1833 MRR@5:0.1738


Best Results:

[0.2689782994825855, 0.3394470615491544, 0.3993358560506603, tensor(0.1738), tensor(0.1833), tensor(0.1875, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:7.284822463989258
CL_Loss:2.281660795211792
Loss:6.642514228820801
CL_Loss:2.3932924270629883
Loss:6.949944972991943
CL_Loss:2.393993377685547
Loss:6.328869819641113
CL_Loss:2.2521660327911377
-------------------Start Predicting---------------------:  2026-02-09 08:02:17.560342
Results of LocalSession:

Recall@20: 0.4005 Recall@10: 0.3387  Recall@5:0.2697
HiT@20: 0.4005 HiT@10: 0.3387  HiT@5:0.2697
MRR@20:0.1873 MRR@10:0.1830 MRR@5:0.1736


Best Results:

[0.26971194686848404, 0.3386748011429454, 0.4004556336396633, tensor(0.1736), tensor(0.1830), tensor(0.1873, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.736747741699219
CL_Loss:2.3129289150238037
Loss:6.428403854370117
CL_Loss:2.290397882461548
Loss:7.091680526733398
CL_Loss:2.3463222980499268
Loss:6.426163673400879
CL_Loss:2.1988632678985596
-------------------Start Predicting---------------------:  2026-02-09 08:06:28.109776
Results of LocalSession:

Recall@20: 0.4006 Recall@10: 0.3389  Recall@5:0.2702
HiT@20: 0.4006 HiT@10: 0.3389  HiT@5:0.2702
MRR@20:0.1872 MRR@10:0.1829 MRR@5:0.1737


Best Results:

[0.2702139161325199, 0.3389064792648081, 0.4005714727005946, tensor(0.1737), tensor(0.1829), tensor(0.1872, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.122330665588379
CL_Loss:2.1402359008789062
Loss:6.520893573760986
CL_Loss:2.401852607727051
Loss:6.728792667388916
CL_Loss:2.202836036682129
Loss:6.479067802429199
CL_Loss:2.379603862762451
-------------------Start Predicting---------------------:  2026-02-09 08:10:37.781032
Results of LocalSession:

Recall@20: 0.4003 Recall@10: 0.3388  Recall@5:0.2695
HiT@20: 0.4003 HiT@10: 0.3388  HiT@5:0.2695
MRR@20:0.1871 MRR@10:0.1828 MRR@5:0.1735


Best Results:

[0.2702139161325199, 0.3389064792648081, 0.4005714727005946, tensor(0.1737), tensor(0.1829), tensor(0.1872, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:5.952937126159668
CL_Loss:2.2245023250579834
Loss:6.854553699493408
CL_Loss:2.3959908485412598
Loss:6.520174026489258
CL_Loss:2.372485399246216
Loss:6.503558158874512
CL_Loss:2.3561384677886963
-------------------Start Predicting---------------------:  2026-02-09 08:14:46.367802
Results of LocalSession:

Recall@20: 0.4011 Recall@10: 0.3386  Recall@5:0.2694
HiT@20: 0.4011 HiT@10: 0.3386  HiT@5:0.2694
MRR@20:0.1870 MRR@10:0.1827 MRR@5:0.1733


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.572326183319092
CL_Loss:2.5473413467407227
Loss:6.2320876121521
CL_Loss:2.1714019775390625
Loss:6.911373138427734
CL_Loss:2.583421468734741
Loss:6.976525783538818
CL_Loss:2.466599464416504
-------------------Start Predicting---------------------:  2026-02-09 08:18:54.498982
Results of LocalSession:

Recall@20: 0.4010 Recall@10: 0.3385  Recall@5:0.2697
HiT@20: 0.4010 HiT@10: 0.3385  HiT@5:0.2697
MRR@20:0.1870 MRR@10:0.1826 MRR@5:0.1734


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.684103012084961
CL_Loss:2.20082426071167
Loss:6.781329154968262
CL_Loss:2.306688070297241
Loss:6.7236528396606445
CL_Loss:2.5149409770965576
Loss:6.337409019470215
CL_Loss:2.279097318649292
-------------------Start Predicting---------------------:  2026-02-09 08:23:02.663534
Results of LocalSession:

Recall@20: 0.4008 Recall@10: 0.3384  Recall@5:0.2698
HiT@20: 0.4008 HiT@10: 0.3384  HiT@5:0.2698
MRR@20:0.1871 MRR@10:0.1827 MRR@5:0.1735


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.65086555480957
CL_Loss:2.429645538330078
Loss:6.545811653137207
CL_Loss:2.311969041824341
Loss:6.506372451782227
CL_Loss:2.4240782260894775
Loss:6.374419689178467
CL_Loss:2.2243781089782715
-------------------Start Predicting---------------------:  2026-02-09 08:27:11.281474
Results of LocalSession:

Recall@20: 0.4010 Recall@10: 0.3387  Recall@5:0.2695
HiT@20: 0.4010 HiT@10: 0.3387  HiT@5:0.2695
MRR@20:0.1870 MRR@10:0.1826 MRR@5:0.1733


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.521023750305176
CL_Loss:2.3480403423309326
Loss:6.350944519042969
CL_Loss:2.2426769733428955
Loss:6.483848571777344
CL_Loss:2.3476133346557617
Loss:6.323467254638672
CL_Loss:2.313697576522827
-------------------Start Predicting---------------------:  2026-02-09 08:31:18.549349
Results of LocalSession:

Recall@20: 0.4010 Recall@10: 0.3387  Recall@5:0.2694
HiT@20: 0.4010 HiT@10: 0.3387  HiT@5:0.2694
MRR@20:0.1869 MRR@10:0.1826 MRR@5:0.1732


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.39072322845459
CL_Loss:2.5467801094055176
Loss:6.191622257232666
CL_Loss:2.37634539604187
Loss:5.8515214920043945
CL_Loss:2.201992988586426
Loss:6.782220363616943
CL_Loss:2.309297561645508
-------------------Start Predicting---------------------:  2026-02-09 08:35:25.901195
Results of LocalSession:

Recall@20: 0.4009 Recall@10: 0.3386  Recall@5:0.2696
HiT@20: 0.4009 HiT@10: 0.3386  HiT@5:0.2696
MRR@20:0.1870 MRR@10:0.1826 MRR@5:0.1733


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.4785614013671875
CL_Loss:2.3833529949188232
Loss:7.078722953796387
CL_Loss:2.241337299346924
Loss:6.941944122314453
CL_Loss:2.5031087398529053
Loss:6.158480167388916
CL_Loss:2.2029309272766113
-------------------Start Predicting---------------------:  2026-02-09 08:39:33.778878
Results of LocalSession:

Recall@20: 0.4008 Recall@10: 0.3384  Recall@5:0.2694
HiT@20: 0.4008 HiT@10: 0.3384  HiT@5:0.2694
MRR@20:0.1869 MRR@10:0.1826 MRR@5:0.1733


Best Results:

[0.26936442968569, 0.33863618812263496, 0.40107344196463046, tensor(0.1733), tensor(0.1827), tensor(0.1870, device='cuda:0')]
