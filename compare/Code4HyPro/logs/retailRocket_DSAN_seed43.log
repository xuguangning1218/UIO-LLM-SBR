Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='retailRocket_DSAN', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=43)
model is on gpu
  0%|          | 0/433648 [00:00<?, ?it/s] 23%|██▎       | 98387/433648 [00:00<00:00, 344418.76it/s] 45%|████▍     | 193811/433648 [00:00<00:00, 547646.58it/s] 63%|██████▎   | 273206/433648 [00:00<00:00, 627086.64it/s] 80%|████████  | 347653/433648 [00:00<00:00, 424254.29it/s]100%|██████████| 433648/433648 [00:00<00:00, 509565.87it/s]
the number of nodes is :36969
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:10.954943656921387
CL_Loss:3.370408058166504
Loss:10.83616828918457
CL_Loss:3.2092301845550537
Loss:8.902779579162598
CL_Loss:3.2111806869506836
Loss:8.071096420288086
CL_Loss:2.984496593475342
Loss:8.218189239501953
CL_Loss:2.977813959121704
-------------------Start Predicting---------------------:  2026-02-08 21:09:00.948466
Results of LocalSession:

Recall@20: 0.5248 Recall@10: 0.4676  Recall@5:0.4088
HiT@20: 0.5248 HiT@10: 0.4676  HiT@5:0.4088
MRR@20:0.2978 MRR@10:0.2938 MRR@5:0.2857


Best Results:

[0.40880253766851704, 0.4675522072429289, 0.5248480042294476, tensor(0.2857), tensor(0.2938), tensor(0.2978, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.576840400695801
CL_Loss:3.0786044597625732
Loss:7.351801872253418
CL_Loss:2.937488317489624
Loss:7.49605655670166
CL_Loss:2.896545886993408
Loss:8.126382827758789
CL_Loss:3.317436456680298
Loss:8.397350311279297
CL_Loss:2.9362847805023193
-------------------Start Predicting---------------------:  2026-02-08 21:27:09.800120
Results of LocalSession:

Recall@20: 0.5530 Recall@10: 0.4882  Recall@5:0.4157
HiT@20: 0.5530 HiT@10: 0.4882  HiT@5:0.4157
MRR@20:0.3013 MRR@10:0.2968 MRR@5:0.2871


Best Results:

[0.41574147501982556, 0.4882368490615913, 0.5530002643404706, tensor(0.2871), tensor(0.2968), tensor(0.3013, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:7.7194366455078125
CL_Loss:3.0577447414398193
Loss:6.969391345977783
CL_Loss:2.8277320861816406
Loss:7.190512180328369
CL_Loss:3.1993892192840576
Loss:7.671972751617432
CL_Loss:2.8549418449401855
Loss:7.737112045288086
CL_Loss:2.992119073867798
-------------------Start Predicting---------------------:  2026-02-08 21:46:09.589391
Results of LocalSession:

Recall@20: 0.5615 Recall@10: 0.4907  Recall@5:0.4177
HiT@20: 0.5615 HiT@10: 0.4907  HiT@5:0.4177
MRR@20:0.3015 MRR@10:0.2965 MRR@5:0.2867


Best Results:

[0.41772402854877083, 0.49068199841395715, 0.5615252445149352, tensor(0.2867), tensor(0.2965), tensor(0.3015, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.1440749168396
CL_Loss:3.0866613388061523
Loss:6.653644561767578
CL_Loss:2.694277286529541
Loss:7.126300811767578
CL_Loss:3.130328893661499
Loss:7.179623603820801
CL_Loss:2.9464633464813232
Loss:6.667492866516113
CL_Loss:2.794210195541382
-------------------Start Predicting---------------------:  2026-02-08 22:04:15.957914
Results of LocalSession:

Recall@20: 0.5649 Recall@10: 0.4914  Recall@5:0.4198
HiT@20: 0.5649 HiT@10: 0.4914  HiT@5:0.4198
MRR@20:0.3027 MRR@10:0.2977 MRR@5:0.2880


Best Results:

[0.4198387523129791, 0.49140893470790376, 0.5648955855141422, tensor(0.2880), tensor(0.2977), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.977905750274658
CL_Loss:2.9087352752685547
Loss:7.354803562164307
CL_Loss:3.1474156379699707
Loss:6.752293109893799
CL_Loss:2.8263726234436035
Loss:6.919825553894043
CL_Loss:3.03043270111084
Loss:7.32455587387085
CL_Loss:3.008451461791992
-------------------Start Predicting---------------------:  2026-02-08 22:22:16.216313
Results of LocalSession:

Recall@20: 0.5663 Recall@10: 0.4925  Recall@5:0.4208
HiT@20: 0.5663 HiT@10: 0.4925  HiT@5:0.4208
MRR@20:0.3031 MRR@10:0.2981 MRR@5:0.2884


Best Results:

[0.42083002907745176, 0.49253238170763947, 0.5662833729844039, tensor(0.2884), tensor(0.2981), tensor(0.3031, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:7.332544803619385
CL_Loss:2.990943431854248
Loss:7.0859880447387695
CL_Loss:2.935716390609741
Loss:6.494870185852051
CL_Loss:2.6929774284362793
Loss:6.733125686645508
CL_Loss:2.7881364822387695
Loss:6.607071399688721
CL_Loss:2.9439940452575684
-------------------Start Predicting---------------------:  2026-02-08 22:40:54.697436
Results of LocalSession:

Recall@20: 0.5679 Recall@10: 0.4925  Recall@5:0.4196
HiT@20: 0.5679 HiT@10: 0.4925  HiT@5:0.4196
MRR@20:0.3027 MRR@10:0.2975 MRR@5:0.2876


Best Results:

[0.4196404969600846, 0.49246629659000796, 0.5679355009251916, tensor(0.2876), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.880407333374023
CL_Loss:3.006446361541748
Loss:6.998336315155029
CL_Loss:2.7807092666625977
Loss:6.651454925537109
CL_Loss:2.8951563835144043
Loss:6.9059553146362305
CL_Loss:2.9542088508605957
Loss:6.44641637802124
CL_Loss:2.558661937713623
-------------------Start Predicting---------------------:  2026-02-08 22:59:23.143240
Results of LocalSession:

Recall@20: 0.5679 Recall@10: 0.4913  Recall@5:0.4208
HiT@20: 0.5679 HiT@10: 0.4913  HiT@5:0.4208
MRR@20:0.3028 MRR@10:0.2976 MRR@5:0.2881


Best Results:

[0.4196404969600846, 0.49246629659000796, 0.5679355009251916, tensor(0.2876), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.751914978027344
CL_Loss:3.143808126449585
Loss:7.087967872619629
CL_Loss:3.3399300575256348
Loss:6.739802360534668
CL_Loss:2.9979569911956787
Loss:6.857166290283203
CL_Loss:2.8082592487335205
Loss:7.220335006713867
CL_Loss:3.069857358932495
-------------------Start Predicting---------------------:  2026-02-08 23:17:15.719257
Results of LocalSession:

Recall@20: 0.5681 Recall@10: 0.4923  Recall@5:0.4203
HiT@20: 0.5681 HiT@10: 0.4923  HiT@5:0.4203
MRR@20:0.3027 MRR@10:0.2975 MRR@5:0.2878


Best Results:

[0.4203013481363997, 0.49233412635474494, 0.5681337562780862, tensor(0.2878), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:5.945940971374512
CL_Loss:2.6569132804870605
Loss:6.722261905670166
CL_Loss:2.9274160861968994
Loss:6.712428092956543
CL_Loss:3.0642683506011963
Loss:6.501189231872559
CL_Loss:3.249002695083618
Loss:7.21171760559082
CL_Loss:3.122645854949951
-------------------Start Predicting---------------------:  2026-02-08 23:35:31.542198
Results of LocalSession:

Recall@20: 0.5684 Recall@10: 0.4922  Recall@5:0.4203
HiT@20: 0.5684 HiT@10: 0.4922  HiT@5:0.4203
MRR@20:0.3027 MRR@10:0.2975 MRR@5:0.2878


Best Results:

[0.4203013481363997, 0.4922019561194819, 0.5683980967486122, tensor(0.2878), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.7798662185668945
CL_Loss:2.88256573677063
Loss:6.700588226318359
CL_Loss:2.964661121368408
Loss:6.905238151550293
CL_Loss:3.021541118621826
Loss:6.469886779785156
CL_Loss:2.8668713569641113
Loss:6.436347007751465
CL_Loss:2.6999688148498535
-------------------Start Predicting---------------------:  2026-02-08 23:53:31.744504
Results of LocalSession:

Recall@20: 0.5681 Recall@10: 0.4921  Recall@5:0.4200
HiT@20: 0.5681 HiT@10: 0.4921  HiT@5:0.4200
MRR@20:0.3023 MRR@10:0.2971 MRR@5:0.2873


Best Results:

[0.4203013481363997, 0.4922019561194819, 0.5683980967486122, tensor(0.2878), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.724923133850098
CL_Loss:2.905489206314087
Loss:6.659002304077148
CL_Loss:2.9143548011779785
Loss:5.840950012207031
CL_Loss:2.4148061275482178
Loss:6.922116279602051
CL_Loss:3.0797483921051025
Loss:6.017590522766113
CL_Loss:2.4842047691345215
-------------------Start Predicting---------------------:  2026-02-09 00:12:01.339605
Results of LocalSession:

Recall@20: 0.5684 Recall@10: 0.4922  Recall@5:0.4203
HiT@20: 0.5684 HiT@10: 0.4922  HiT@5:0.4203
MRR@20:0.3026 MRR@10:0.2974 MRR@5:0.2877


Best Results:

[0.4203013481363997, 0.4922019561194819, 0.5683980967486122, tensor(0.2878), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.2578277587890625
CL_Loss:2.6736035346984863
Loss:6.546638488769531
CL_Loss:2.8911287784576416
Loss:6.613808631896973
CL_Loss:2.9289965629577637
Loss:6.805233955383301
CL_Loss:2.7981512546539307
Loss:7.272773742675781
CL_Loss:3.0626637935638428
-------------------Start Predicting---------------------:  2026-02-09 00:28:47.070583
Results of LocalSession:

Recall@20: 0.5685 Recall@10: 0.4926  Recall@5:0.4202
HiT@20: 0.5685 HiT@10: 0.4926  HiT@5:0.4202
MRR@20:0.3027 MRR@10:0.2975 MRR@5:0.2877


Best Results:

[0.4202352630187682, 0.492598466825271, 0.5684641818662437, tensor(0.2877), tensor(0.2975), tensor(0.3027, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.696779251098633
CL_Loss:2.67826771736145
Loss:7.237232685089111
CL_Loss:3.071788787841797
Loss:6.869255065917969
CL_Loss:2.99562931060791
Loss:6.926394462585449
CL_Loss:2.8703973293304443
Loss:6.9604997634887695
CL_Loss:2.6642262935638428
-------------------Start Predicting---------------------:  2026-02-09 00:46:32.084955
Results of LocalSession:

Recall@20: 0.5687 Recall@10: 0.4923  Recall@5:0.4203
HiT@20: 0.5687 HiT@10: 0.4923  HiT@5:0.4203
MRR@20:0.3030 MRR@10:0.2977 MRR@5:0.2880


Best Results:

[0.4203013481363997, 0.49233412635474494, 0.5686624372191382, tensor(0.2880), tensor(0.2977), tensor(0.3030, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.7582597732543945
CL_Loss:2.9084177017211914
Loss:7.083613395690918
CL_Loss:3.0514159202575684
Loss:5.786308765411377
CL_Loss:2.4386239051818848
Loss:6.305252552032471
CL_Loss:2.665194034576416
Loss:7.0200605392456055
CL_Loss:2.828660249710083
-------------------Start Predicting---------------------:  2026-02-09 01:04:30.574288
Results of LocalSession:

Recall@20: 0.5685 Recall@10: 0.4925  Recall@5:0.4204
HiT@20: 0.5685 HiT@10: 0.4925  HiT@5:0.4204
MRR@20:0.3029 MRR@10:0.2976 MRR@5:0.2879


Best Results:

[0.4203013481363997, 0.49233412635474494, 0.5686624372191382, tensor(0.2880), tensor(0.2977), tensor(0.3030, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.267184257507324
CL_Loss:2.6890101432800293
Loss:6.954713821411133
CL_Loss:2.8515472412109375
Loss:6.774489402770996
CL_Loss:2.8005199432373047
Loss:6.258700847625732
CL_Loss:2.7026572227478027
Loss:6.263336181640625
CL_Loss:2.7785704135894775
-------------------Start Predicting---------------------:  2026-02-09 01:22:39.669107
Results of LocalSession:

Recall@20: 0.5686 Recall@10: 0.4924  Recall@5:0.4202
HiT@20: 0.5686 HiT@10: 0.4924  HiT@5:0.4202
MRR@20:0.3028 MRR@10:0.2976 MRR@5:0.2878


Best Results:

[0.4203013481363997, 0.49233412635474494, 0.5686624372191382, tensor(0.2880), tensor(0.2977), tensor(0.3030, device='cuda:0')]
