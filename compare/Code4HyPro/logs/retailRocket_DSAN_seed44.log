Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='retailRocket_DSAN', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=44)
model is on gpu
  0%|          | 0/433648 [00:00<?, ?it/s] 23%|██▎       | 98387/433648 [00:00<00:00, 465966.42it/s] 47%|████▋     | 202427/433648 [00:00<00:00, 697765.86it/s] 69%|██████▉   | 300393/433648 [00:00<00:00, 800839.59it/s] 90%|████████▉ | 388805/433648 [00:00<00:00, 632898.41it/s]100%|██████████| 433648/433648 [00:00<00:00, 670529.76it/s]
the number of nodes is :36969
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:11.866644859313965
CL_Loss:3.227895975112915
Loss:9.78370189666748
CL_Loss:3.0472891330718994
Loss:9.271136283874512
CL_Loss:2.9801957607269287
Loss:8.71923542022705
CL_Loss:3.000330686569214
Loss:8.414594650268555
CL_Loss:3.1970434188842773
-------------------Start Predicting---------------------:  2026-02-08 23:04:51.559045
Results of LocalSession:

Recall@20: 0.5279 Recall@10: 0.4721  Recall@5:0.4113
HiT@20: 0.5279 HiT@10: 0.4721  HiT@5:0.4113
MRR@20:0.3018 MRR@10:0.2979 MRR@5:0.2897


Best Results:

[0.4113137721385144, 0.47211208035950303, 0.527887919640497, tensor(0.2897), tensor(0.2979), tensor(0.3018, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:7.833378791809082
CL_Loss:2.9852309226989746
Loss:7.920446395874023
CL_Loss:3.2699086666107178
Loss:6.999634265899658
CL_Loss:2.985140323638916
Loss:7.976537704467773
CL_Loss:3.2716777324676514
Loss:8.719417572021484
CL_Loss:3.8127989768981934
-------------------Start Predicting---------------------:  2026-02-08 23:22:37.500230
Results of LocalSession:

Recall@20: 0.5531 Recall@10: 0.4871  Recall@5:0.4185
HiT@20: 0.5531 HiT@10: 0.4871  HiT@5:0.4185
MRR@20:0.3031 MRR@10:0.2986 MRR@5:0.2892


Best Results:

[0.41845096484271743, 0.48711340206185566, 0.5531324345757336, tensor(0.2892), tensor(0.2986), tensor(0.3031, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:7.5738043785095215
CL_Loss:3.06143856048584
Loss:7.133070468902588
CL_Loss:2.9357566833496094
Loss:6.81484317779541
CL_Loss:2.829277515411377
Loss:7.404712677001953
CL_Loss:2.9188616275787354
Loss:7.989896774291992
CL_Loss:2.913159132003784
-------------------Start Predicting---------------------:  2026-02-08 23:40:51.359815
Results of LocalSession:

Recall@20: 0.5607 Recall@10: 0.4898  Recall@5:0.4196
HiT@20: 0.5607 HiT@10: 0.4898  HiT@5:0.4196
MRR@20:0.3039 MRR@10:0.2989 MRR@5:0.2893


Best Results:

[0.4196404969600846, 0.48982289188474754, 0.5607322231033571, tensor(0.2893), tensor(0.2989), tensor(0.3039, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:6.006258487701416
CL_Loss:2.4990170001983643
Loss:7.209743499755859
CL_Loss:3.0548412799835205
Loss:6.743767261505127
CL_Loss:2.745875120162964
Loss:7.022802352905273
CL_Loss:3.0979673862457275
Loss:7.043891429901123
CL_Loss:3.0483622550964355
-------------------Start Predicting---------------------:  2026-02-08 23:58:44.004349
Results of LocalSession:

Recall@20: 0.5638 Recall@10: 0.4910  Recall@5:0.4212
HiT@20: 0.5638 HiT@10: 0.4910  HiT@5:0.4212
MRR@20:0.3048 MRR@10:0.2997 MRR@5:0.2902


Best Results:

[0.4211604546656093, 0.4910124240021147, 0.5638382236320381, tensor(0.2902), tensor(0.2997), tensor(0.3048, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:6.933661460876465
CL_Loss:3.0203568935394287
Loss:7.855484485626221
CL_Loss:3.4275646209716797
Loss:6.549837112426758
CL_Loss:2.764256000518799
Loss:7.736084938049316
CL_Loss:3.24971604347229
Loss:7.482985496520996
CL_Loss:3.0805084705352783
-------------------Start Predicting---------------------:  2026-02-09 00:17:30.056008
Results of LocalSession:

Recall@20: 0.5642 Recall@10: 0.4933  Recall@5:0.4216
HiT@20: 0.5642 HiT@10: 0.4933  HiT@5:0.4216
MRR@20:0.3062 MRR@10:0.3012 MRR@5:0.2915


Best Results:

[0.42155696537139836, 0.49325931800158607, 0.5641686492201956, tensor(0.2915), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.315813064575195
CL_Loss:2.5911779403686523
Loss:7.151808738708496
CL_Loss:3.029994487762451
Loss:6.308901309967041
CL_Loss:2.607417583465576
Loss:6.905119895935059
CL_Loss:2.901451349258423
Loss:7.1283793449401855
CL_Loss:2.980638027191162
-------------------Start Predicting---------------------:  2026-02-09 00:33:46.542054
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4939  Recall@5:0.4211
HiT@20: 0.5648 HiT@10: 0.4939  HiT@5:0.4211
MRR@20:0.3070 MRR@10:0.3021 MRR@5:0.2922


Best Results:

[0.4210943695479778, 0.49385408406026965, 0.5647634152788792, tensor(0.2922), tensor(0.3021), tensor(0.3070, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.791772842407227
CL_Loss:2.806107997894287
Loss:7.405570983886719
CL_Loss:3.1524040699005127
Loss:6.468976974487305
CL_Loss:2.7755022048950195
Loss:6.75831413269043
CL_Loss:2.9726977348327637
Loss:7.752678871154785
CL_Loss:3.5153679847717285
-------------------Start Predicting---------------------:  2026-02-09 00:51:42.414024
Results of LocalSession:

Recall@20: 0.5650 Recall@10: 0.4937  Recall@5:0.4212
HiT@20: 0.5650 HiT@10: 0.4937  HiT@5:0.4212
MRR@20:0.3064 MRR@10:0.3014 MRR@5:0.2916


Best Results:

[0.4211604546656093, 0.4936558287073751, 0.5650277557494052, tensor(0.2916), tensor(0.3014), tensor(0.3064, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.559839248657227
CL_Loss:2.723545551300049
Loss:7.084469795227051
CL_Loss:3.1607983112335205
Loss:6.227047443389893
CL_Loss:2.690774440765381
Loss:6.5416083335876465
CL_Loss:2.8336706161499023
Loss:6.663148403167725
CL_Loss:2.9648854732513428
-------------------Start Predicting---------------------:  2026-02-09 01:09:53.288506
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4933  Recall@5:0.4211
HiT@20: 0.5648 HiT@10: 0.4933  HiT@5:0.4211
MRR@20:0.3062 MRR@10:0.3012 MRR@5:0.2914


Best Results:

[0.4211604546656093, 0.4936558287073751, 0.5650277557494052, tensor(0.2916), tensor(0.3014), tensor(0.3064, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:7.155909538269043
CL_Loss:2.8763201236724854
Loss:7.106330394744873
CL_Loss:2.8492956161499023
Loss:6.819875717163086
CL_Loss:2.808279275894165
Loss:6.122591018676758
CL_Loss:2.569387435913086
Loss:6.658804416656494
CL_Loss:2.909700632095337
-------------------Start Predicting---------------------:  2026-02-09 01:27:24.499930
Results of LocalSession:

Recall@20: 0.5652 Recall@10: 0.4938  Recall@5:0.4209
HiT@20: 0.5652 HiT@10: 0.4938  HiT@5:0.4209
MRR@20:0.3062 MRR@10:0.3012 MRR@5:0.2913


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.96991491317749
CL_Loss:2.958427906036377
Loss:6.952024459838867
CL_Loss:2.868610143661499
Loss:7.032305717468262
CL_Loss:3.080982208251953
Loss:6.442296981811523
CL_Loss:3.0552494525909424
Loss:7.160661220550537
CL_Loss:3.200140953063965
-------------------Start Predicting---------------------:  2026-02-09 01:42:59.750053
Results of LocalSession:

Recall@20: 0.5652 Recall@10: 0.4939  Recall@5:0.4209
HiT@20: 0.5652 HiT@10: 0.4939  HiT@5:0.4209
MRR@20:0.3063 MRR@10:0.3013 MRR@5:0.2914


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.941181182861328
CL_Loss:2.8890187740325928
Loss:7.320137977600098
CL_Loss:3.2792789936065674
Loss:6.756052017211914
CL_Loss:2.8140525817871094
Loss:6.8232927322387695
CL_Loss:2.7414846420288086
Loss:7.319891929626465
CL_Loss:3.021428108215332
-------------------Start Predicting---------------------:  2026-02-09 01:58:27.350340
Results of LocalSession:

Recall@20: 0.5650 Recall@10: 0.4939  Recall@5:0.4208
HiT@20: 0.5650 HiT@10: 0.4939  HiT@5:0.4208
MRR@20:0.3062 MRR@10:0.3013 MRR@5:0.2913


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.760345458984375
CL_Loss:2.986276149749756
Loss:7.130675315856934
CL_Loss:3.1011765003204346
Loss:5.891157150268555
CL_Loss:2.42253041267395
Loss:6.24178409576416
CL_Loss:2.7224812507629395
Loss:7.440252304077148
CL_Loss:3.2529613971710205
-------------------Start Predicting---------------------:  2026-02-09 02:13:45.676481
Results of LocalSession:

Recall@20: 0.5649 Recall@10: 0.4939  Recall@5:0.4206
HiT@20: 0.5649 HiT@10: 0.4939  HiT@5:0.4206
MRR@20:0.3066 MRR@10:0.3016 MRR@5:0.2916


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.461762428283691
CL_Loss:2.8270628452301025
Loss:6.230930805206299
CL_Loss:2.952725648880005
Loss:6.690171241760254
CL_Loss:2.8593029975891113
Loss:6.6451921463012695
CL_Loss:2.626619815826416
Loss:7.564789772033691
CL_Loss:3.1622283458709717
-------------------Start Predicting---------------------:  2026-02-09 02:30:45.323266
Results of LocalSession:

Recall@20: 0.5650 Recall@10: 0.4937  Recall@5:0.4204
HiT@20: 0.5650 HiT@10: 0.4937  HiT@5:0.4204
MRR@20:0.3063 MRR@10:0.3014 MRR@5:0.2914


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:7.54608154296875
CL_Loss:3.112272024154663
Loss:6.547115325927734
CL_Loss:2.8244714736938477
Loss:7.1527581214904785
CL_Loss:2.944133758544922
Loss:6.763716697692871
CL_Loss:2.9011778831481934
Loss:7.340638160705566
CL_Loss:3.2759759426116943
-------------------Start Predicting---------------------:  2026-02-09 02:48:36.490696
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4940  Recall@5:0.4205
HiT@20: 0.5648 HiT@10: 0.4940  HiT@5:0.4205
MRR@20:0.3063 MRR@10:0.3013 MRR@5:0.2913


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.518580913543701
CL_Loss:2.7018356323242188
Loss:6.554298400878906
CL_Loss:2.8110101222991943
Loss:7.451977729797363
CL_Loss:3.072036027908325
Loss:6.7787041664123535
CL_Loss:2.957415819168091
Loss:6.985512733459473
CL_Loss:2.9091861248016357
-------------------Start Predicting---------------------:  2026-02-09 03:06:35.275654
Results of LocalSession:

Recall@20: 0.5648 Recall@10: 0.4938  Recall@5:0.4204
HiT@20: 0.5648 HiT@10: 0.4938  HiT@5:0.4204
MRR@20:0.3063 MRR@10:0.3014 MRR@5:0.2914


Best Results:

[0.42089611419508327, 0.49378799894263814, 0.5652260111022998, tensor(0.2913), tensor(0.3012), tensor(0.3062, device='cuda:0')]
