Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='diginetica', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=46)
model is on gpu
  0%|          | 0/719470 [00:00<?, ?it/s] 21%|██▏       | 153953/719470 [00:00<00:00, 1539465.40it/s] 43%|████▎     | 307900/719470 [00:00<00:00, 912497.43it/s]  64%|██████▍   | 462635/719470 [00:00<00:00, 1123561.91it/s] 82%|████████▏ | 590429/719470 [00:00<00:00, 836863.65it/s] 100%|██████████| 719470/719470 [00:00<00:00, 997024.10it/s]
the number of nodes is :43098
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:10.909436225891113
CL_Loss:0.24607835710048676
Loss:8.23112964630127
CL_Loss:0.29524698853492737
Loss:6.796569347381592
CL_Loss:0.3357578217983246
Loss:6.31724739074707
CL_Loss:0.15659889578819275
Loss:5.764691352844238
CL_Loss:0.14065955579280853
Loss:6.1922783851623535
CL_Loss:0.12685111165046692
Loss:5.350869178771973
CL_Loss:0.1150127574801445
Loss:5.082473278045654
CL_Loss:0.15165477991104126
-------------------Start Predicting---------------------:  2026-02-08 18:27:54.425277
Results of LocalSession:

Recall@20: 0.5142 Recall@10: 0.3883  Recall@5:0.2782
HiT@20: 0.5142 HiT@10: 0.3883  HiT@5:0.2782
MRR@20:0.1841 MRR@10:0.1754 MRR@5:0.1609


Best Results:

[0.2781557067271353, 0.38826448453777646, 0.5142134148345329, tensor(0.1609), tensor(0.1754), tensor(0.1841, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:4.934287071228027
CL_Loss:0.157301664352417
Loss:4.918420791625977
CL_Loss:0.18693596124649048
Loss:5.2873430252075195
CL_Loss:0.2960599958896637
Loss:4.587061405181885
CL_Loss:0.17821823060512543
Loss:5.166159629821777
CL_Loss:0.12470375001430511
Loss:4.877986431121826
CL_Loss:0.2298383116722107
Loss:5.412947654724121
CL_Loss:0.2329433560371399
Loss:5.264736652374268
CL_Loss:0.16461583971977234
-------------------Start Predicting---------------------:  2026-02-08 18:38:04.485843
Results of LocalSession:

Recall@20: 0.5369 Recall@10: 0.4056  Recall@5:0.2895
HiT@20: 0.5369 HiT@10: 0.4056  HiT@5:0.2895
MRR@20:0.1893 MRR@10:0.1803 MRR@5:0.1649


Best Results:

[0.28952643859476157, 0.4056327845147721, 0.5368562884090834, tensor(0.1649), tensor(0.1803), tensor(0.1893, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:4.54012393951416
CL_Loss:0.16886401176452637
Loss:5.018205642700195
CL_Loss:0.1472291201353073
Loss:4.7077813148498535
CL_Loss:0.2090098112821579
Loss:4.4505157470703125
CL_Loss:0.13816744089126587
Loss:4.62596321105957
CL_Loss:0.19684860110282898
Loss:4.985617160797119
CL_Loss:0.1538185477256775
Loss:4.733684539794922
CL_Loss:0.23001524806022644
Loss:5.270159721374512
CL_Loss:0.20968195796012878
-------------------Start Predicting---------------------:  2026-02-08 18:48:38.681382
Results of LocalSession:

Recall@20: 0.5433 Recall@10: 0.4113  Recall@5:0.2952
HiT@20: 0.5433 HiT@10: 0.4113  HiT@5:0.2952
MRR@20:0.1913 MRR@10:0.1821 MRR@5:0.1667


Best Results:

[0.2952118045285747, 0.4112852870616846, 0.5432646488547109, tensor(0.1667), tensor(0.1821), tensor(0.1913, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:4.182836055755615
CL_Loss:0.20561015605926514
Loss:4.835489273071289
CL_Loss:0.10923486202955246
Loss:4.435180187225342
CL_Loss:0.17635078728199005
Loss:4.507083415985107
CL_Loss:0.12765979766845703
Loss:4.478875637054443
CL_Loss:0.2170972228050232
Loss:4.847207069396973
CL_Loss:0.13454270362854004
Loss:4.437639236450195
CL_Loss:0.2301318645477295
Loss:4.5550642013549805
CL_Loss:0.10125087201595306
-------------------Start Predicting---------------------:  2026-02-08 18:58:28.399395
Results of LocalSession:

Recall@20: 0.5472 Recall@10: 0.4131  Recall@5:0.2963
HiT@20: 0.5472 HiT@10: 0.4131  HiT@5:0.2963
MRR@20:0.1918 MRR@10:0.1825 MRR@5:0.1670


Best Results:

[0.29632915968319695, 0.4130599099543199, 0.5471589602024385, tensor(0.1670), tensor(0.1825), tensor(0.1918, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:3.9857921600341797
CL_Loss:0.11520332098007202
Loss:4.2977094650268555
CL_Loss:0.1748439371585846
Loss:4.144492149353027
CL_Loss:0.1520702838897705
Loss:4.661386966705322
CL_Loss:0.1562952697277069
Loss:4.432770252227783
CL_Loss:0.23903228342533112
Loss:4.1579694747924805
CL_Loss:0.14603447914123535
Loss:4.469422817230225
CL_Loss:0.11319607496261597
Loss:4.366331577301025
CL_Loss:0.10279157757759094
-------------------Start Predicting---------------------:  2026-02-08 19:08:24.443669
Results of LocalSession:

Recall@20: 0.5477 Recall@10: 0.4146  Recall@5:0.2984
HiT@20: 0.5477 HiT@10: 0.4146  HiT@5:0.2984
MRR@20:0.1926 MRR@10:0.1834 MRR@5:0.1680


Best Results:

[0.2984324164448388, 0.41455519405829966, 0.5476519110059482, tensor(0.1680), tensor(0.1834), tensor(0.1926, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:4.548466205596924
CL_Loss:0.18421989679336548
Loss:4.44351053237915
CL_Loss:0.19273795187473297
Loss:4.551207065582275
CL_Loss:0.17668907344341278
Loss:4.825310707092285
CL_Loss:0.16921012103557587
Loss:4.525028228759766
CL_Loss:0.15771503746509552
Loss:4.769867897033691
CL_Loss:0.16966977715492249
Loss:4.641689300537109
CL_Loss:0.1929602026939392
Loss:4.441303253173828
CL_Loss:0.14313864707946777
-------------------Start Predicting---------------------:  2026-02-08 19:18:33.253748
Results of LocalSession:

Recall@20: 0.5484 Recall@10: 0.4148  Recall@5:0.2987
HiT@20: 0.5484 HiT@10: 0.4148  HiT@5:0.2987
MRR@20:0.1928 MRR@10:0.1836 MRR@5:0.1682


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:4.247279167175293
CL_Loss:0.18717320263385773
Loss:4.264209270477295
CL_Loss:0.21400253474712372
Loss:4.411516189575195
CL_Loss:0.16828346252441406
Loss:4.367466926574707
CL_Loss:0.0971067026257515
Loss:4.211150646209717
CL_Loss:0.1625027060508728
Loss:4.48391580581665
CL_Loss:0.16975654661655426
Loss:4.255859851837158
CL_Loss:0.14133666455745697
Loss:4.811584949493408
CL_Loss:0.1773548275232315
-------------------Start Predicting---------------------:  2026-02-08 19:28:57.758514
Results of LocalSession:

Recall@20: 0.5482 Recall@10: 0.4152  Recall@5:0.2988
HiT@20: 0.5482 HiT@10: 0.4152  HiT@5:0.2988
MRR@20:0.1929 MRR@10:0.1836 MRR@5:0.1682


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:4.490955829620361
CL_Loss:0.1457124501466751
Loss:4.654468536376953
CL_Loss:0.2218242585659027
Loss:4.578348636627197
CL_Loss:0.14353148639202118
Loss:4.441181659698486
CL_Loss:0.16361209750175476
Loss:4.613851547241211
CL_Loss:0.09360361099243164
Loss:4.570518970489502
CL_Loss:0.18149368464946747
Loss:4.622033596038818
CL_Loss:0.2033199667930603
Loss:4.496375560760498
CL_Loss:0.07880794256925583
-------------------Start Predicting---------------------:  2026-02-08 19:39:51.526987
Results of LocalSession:

Recall@20: 0.5483 Recall@10: 0.4153  Recall@5:0.2987
HiT@20: 0.5483 HiT@10: 0.4153  HiT@5:0.2987
MRR@20:0.1927 MRR@10:0.1834 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:4.7197794914245605
CL_Loss:0.17083626985549927
Loss:4.3120903968811035
CL_Loss:0.1253102719783783
Loss:4.849456310272217
CL_Loss:0.2350868433713913
Loss:4.333561420440674
CL_Loss:0.2621455788612366
Loss:4.838131427764893
CL_Loss:0.17640407383441925
Loss:4.229807376861572
CL_Loss:0.14178094267845154
Loss:4.1958746910095215
CL_Loss:0.1831776648759842
Loss:4.247195720672607
CL_Loss:0.15587998926639557
-------------------Start Predicting---------------------:  2026-02-08 19:50:13.190194
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4153  Recall@5:0.2986
HiT@20: 0.5481 HiT@10: 0.4153  HiT@5:0.2986
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:4.84179162979126
CL_Loss:0.17083317041397095
Loss:4.62924861907959
CL_Loss:0.16635367274284363
Loss:4.438940525054932
CL_Loss:0.12995563447475433
Loss:4.5697922706604
CL_Loss:0.24387206137180328
Loss:4.263606071472168
CL_Loss:0.0693935826420784
Loss:4.180019378662109
CL_Loss:0.09012721478939056
Loss:4.527663230895996
CL_Loss:0.15607327222824097
Loss:4.58689022064209
CL_Loss:0.23128613829612732
-------------------Start Predicting---------------------:  2026-02-08 20:00:27.549352
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4154  Recall@5:0.2988
HiT@20: 0.5481 HiT@10: 0.4154  HiT@5:0.2988
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:4.0512237548828125
CL_Loss:0.19998286664485931
Loss:4.467668056488037
CL_Loss:0.27416113018989563
Loss:4.311345100402832
CL_Loss:0.1258108764886856
Loss:4.0693559646606445
CL_Loss:0.11324845999479294
Loss:4.608278274536133
CL_Loss:0.23722434043884277
Loss:4.3383684158325195
CL_Loss:0.0979582741856575
Loss:4.518664360046387
CL_Loss:0.118761345744133
Loss:4.485696792602539
CL_Loss:0.2892368733882904
-------------------Start Predicting---------------------:  2026-02-08 20:10:24.555246
Results of LocalSession:

Recall@20: 0.5482 Recall@10: 0.4154  Recall@5:0.2985
HiT@20: 0.5482 HiT@10: 0.4154  HiT@5:0.2985
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:4.629082202911377
CL_Loss:0.10578819364309311
Loss:4.4254045486450195
CL_Loss:0.13406790792942047
Loss:4.489214897155762
CL_Loss:0.14228159189224243
Loss:4.467796325683594
CL_Loss:0.2186700403690338
Loss:4.10343074798584
CL_Loss:0.10757491737604141
Loss:4.568031311035156
CL_Loss:0.11971542239189148
Loss:4.2348952293396
CL_Loss:0.17089946568012238
Loss:4.274283409118652
CL_Loss:0.16154731810092926
-------------------Start Predicting---------------------:  2026-02-08 20:20:40.212257
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4154  Recall@5:0.2986
HiT@20: 0.5481 HiT@10: 0.4154  HiT@5:0.2986
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:4.56622314453125
CL_Loss:0.13630227744579315
Loss:4.354606628417969
CL_Loss:0.14964079856872559
Loss:4.249828338623047
CL_Loss:0.22704418003559113
Loss:4.7454094886779785
CL_Loss:0.2768247425556183
Loss:4.830191612243652
CL_Loss:0.20361590385437012
Loss:4.1460700035095215
CL_Loss:0.13901923596858978
Loss:4.888528347015381
CL_Loss:0.1620975136756897
Loss:4.929095268249512
CL_Loss:0.3295084238052368
-------------------Start Predicting---------------------:  2026-02-08 20:31:35.003095
Results of LocalSession:

Recall@20: 0.5482 Recall@10: 0.4153  Recall@5:0.2985
HiT@20: 0.5482 HiT@10: 0.4153  HiT@5:0.2985
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:4.326845645904541
CL_Loss:0.14033786952495575
Loss:4.419167995452881
CL_Loss:0.1562422215938568
Loss:4.278200626373291
CL_Loss:0.36351850628852844
Loss:4.383846282958984
CL_Loss:0.10209972411394119
Loss:4.6024489402771
CL_Loss:0.19420932233333588
Loss:4.517498016357422
CL_Loss:0.2055826485157013
Loss:4.4156694412231445
CL_Loss:0.16046251356601715
Loss:4.592895030975342
CL_Loss:0.14404965937137604
-------------------Start Predicting---------------------:  2026-02-08 20:42:15.256774
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4153  Recall@5:0.2985
HiT@20: 0.5481 HiT@10: 0.4153  HiT@5:0.2985
MRR@20:0.1927 MRR@10:0.1834 MRR@5:0.1680


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:4.706127166748047
CL_Loss:0.19153276085853577
Loss:4.1250224113464355
CL_Loss:0.1751861274242401
Loss:4.728731632232666
CL_Loss:0.352358877658844
Loss:4.309598445892334
CL_Loss:0.10904720425605774
Loss:4.456071853637695
CL_Loss:0.18198859691619873
Loss:4.665462493896484
CL_Loss:0.29780906438827515
Loss:4.6093950271606445
CL_Loss:0.2783542275428772
Loss:4.226799964904785
CL_Loss:0.10100507736206055
-------------------Start Predicting---------------------:  2026-02-08 20:52:00.846840
Results of LocalSession:

Recall@20: 0.5481 Recall@10: 0.4152  Recall@5:0.2984
HiT@20: 0.5481 HiT@10: 0.4152  HiT@5:0.2984
MRR@20:0.1927 MRR@10:0.1834 MRR@5:0.1679


Best Results:

[0.2986624601531434, 0.41481810115350487, 0.5483584738243124, tensor(0.1682), tensor(0.1836), tensor(0.1928, device='cuda:0')]
