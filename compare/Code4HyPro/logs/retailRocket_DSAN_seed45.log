Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='retailRocket_DSAN', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=45)
model is on gpu
  0%|          | 0/433648 [00:00<?, ?it/s] 23%|██▎       | 98387/433648 [00:00<00:00, 543540.24it/s] 47%|████▋     | 203573/433648 [00:00<00:00, 767744.66it/s] 69%|██████▉   | 300676/433648 [00:00<00:00, 604937.89it/s] 97%|█████████▋| 419666/433648 [00:00<00:00, 770463.01it/s]100%|██████████| 433648/433648 [00:00<00:00, 728601.17it/s]
the number of nodes is :36969
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:18.2096004486084
CL_Loss:3.482879638671875
Loss:10.368943214416504
CL_Loss:3.0863893032073975
Loss:9.120887756347656
CL_Loss:3.043294668197632
Loss:9.523216247558594
CL_Loss:3.0617456436157227
Loss:8.220126152038574
CL_Loss:2.8078019618988037
-------------------Start Predicting---------------------:  2026-02-09 01:38:38.151996
Results of LocalSession:

Recall@20: 0.5252 Recall@10: 0.4694  Recall@5:0.4070
HiT@20: 0.5252 HiT@10: 0.4694  HiT@5:0.4070
MRR@20:0.2996 MRR@10:0.2958 MRR@5:0.2873


Best Results:

[0.4069521543748348, 0.46940259053661115, 0.5252445149352366, tensor(0.2873), tensor(0.2958), tensor(0.2996, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:6.854822158813477
CL_Loss:2.712512254714966
Loss:7.904767990112305
CL_Loss:3.0367431640625
Loss:8.174226760864258
CL_Loss:3.094449996948242
Loss:7.396627902984619
CL_Loss:3.2107439041137695
Loss:7.468646049499512
CL_Loss:3.3564746379852295
-------------------Start Predicting---------------------:  2026-02-09 01:54:13.457149
Results of LocalSession:

Recall@20: 0.5510 Recall@10: 0.4837  Recall@5:0.4130
HiT@20: 0.5510 HiT@10: 0.4837  HiT@5:0.4130
MRR@20:0.3035 MRR@10:0.2988 MRR@5:0.2892


Best Results:

[0.4130319851969336, 0.4837430610626487, 0.5510177108115253, tensor(0.2892), tensor(0.2988), tensor(0.3035, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:7.045136451721191
CL_Loss:2.9475245475769043
Loss:7.825333118438721
CL_Loss:3.2226481437683105
Loss:7.521894454956055
CL_Loss:3.2174572944641113
Loss:7.761000633239746
CL_Loss:3.1775009632110596
Loss:7.270228385925293
CL_Loss:2.812636137008667
-------------------Start Predicting---------------------:  2026-02-09 02:09:36.567098
Results of LocalSession:

Recall@20: 0.5591 Recall@10: 0.4878  Recall@5:0.4160
HiT@20: 0.5591 HiT@10: 0.4878  HiT@5:0.4160
MRR@20:0.3042 MRR@10:0.2992 MRR@5:0.2896


Best Results:

[0.4160058154903516, 0.48784033835580226, 0.5591461802802009, tensor(0.2896), tensor(0.2992), tensor(0.3042, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.15993595123291
CL_Loss:3.11519455909729
Loss:7.363873481750488
CL_Loss:3.1046574115753174
Loss:7.3349409103393555
CL_Loss:3.03533673286438
Loss:7.176770210266113
CL_Loss:2.805556058883667
Loss:7.010202407836914
CL_Loss:2.8893487453460693
-------------------Start Predicting---------------------:  2026-02-09 02:25:51.921429
Results of LocalSession:

Recall@20: 0.5630 Recall@10: 0.4892  Recall@5:0.4179
HiT@20: 0.5630 HiT@10: 0.4892  HiT@5:0.4179
MRR@20:0.3040 MRR@10:0.2988 MRR@5:0.2892


Best Results:

[0.41785619878403385, 0.48916204070843244, 0.56304520222046, tensor(0.2892), tensor(0.2988), tensor(0.3040, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.146663665771484
CL_Loss:2.946443796157837
Loss:6.530771255493164
CL_Loss:2.583364725112915
Loss:7.072202682495117
CL_Loss:2.8311614990234375
Loss:7.767769813537598
CL_Loss:3.2196154594421387
Loss:6.850771427154541
CL_Loss:2.756312847137451
-------------------Start Predicting---------------------:  2026-02-09 02:43:26.275069
Results of LocalSession:

Recall@20: 0.5649 Recall@10: 0.4908  Recall@5:0.4178
HiT@20: 0.5649 HiT@10: 0.4908  HiT@5:0.4178
MRR@20:0.3035 MRR@10:0.2984 MRR@5:0.2886


Best Results:

[0.41779011366640234, 0.4908141686492202, 0.5648955855141422, tensor(0.2886), tensor(0.2984), tensor(0.3035, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.854391098022461
CL_Loss:2.9246106147766113
Loss:6.3808746337890625
CL_Loss:2.693563461303711
Loss:6.734541893005371
CL_Loss:2.7591795921325684
Loss:6.964033126831055
CL_Loss:2.8983545303344727
Loss:7.054446220397949
CL_Loss:3.029642343521118
-------------------Start Predicting---------------------:  2026-02-09 03:01:49.559322
Results of LocalSession:

Recall@20: 0.5658 Recall@10: 0.4914  Recall@5:0.4185
HiT@20: 0.5658 HiT@10: 0.4914  HiT@5:0.4185
MRR@20:0.3037 MRR@10:0.2985 MRR@5:0.2886


Best Results:

[0.41845096484271743, 0.49140893470790376, 0.5658207771609833, tensor(0.2886), tensor(0.2985), tensor(0.3037, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.504488945007324
CL_Loss:2.694956064224243
Loss:7.039792060852051
CL_Loss:2.892246961593628
Loss:6.763920307159424
CL_Loss:2.721217632293701
Loss:6.813002586364746
CL_Loss:2.890092372894287
Loss:6.609699726104736
CL_Loss:2.812514066696167
-------------------Start Predicting---------------------:  2026-02-09 03:18:46.037894
Results of LocalSession:

Recall@20: 0.5659 Recall@10: 0.4919  Recall@5:0.4189
HiT@20: 0.5659 HiT@10: 0.4919  HiT@5:0.4189
MRR@20:0.3037 MRR@10:0.2986 MRR@5:0.2888


Best Results:

[0.418913560666138, 0.4918715305313243, 0.5658868622786148, tensor(0.2888), tensor(0.2986), tensor(0.3037, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:6.788949966430664
CL_Loss:2.868330955505371
Loss:6.549049377441406
CL_Loss:2.736377477645874
Loss:6.466013431549072
CL_Loss:2.589214324951172
Loss:6.514073371887207
CL_Loss:3.177356481552124
Loss:6.643792152404785
CL_Loss:2.7529959678649902
-------------------Start Predicting---------------------:  2026-02-09 03:37:48.681628
Results of LocalSession:

Recall@20: 0.5659 Recall@10: 0.4923  Recall@5:0.4187
HiT@20: 0.5659 HiT@10: 0.4923  HiT@5:0.4187
MRR@20:0.3033 MRR@10:0.2982 MRR@5:0.2883


Best Results:

[0.418913560666138, 0.4918715305313243, 0.5658868622786148, tensor(0.2888), tensor(0.2986), tensor(0.3037, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:6.497623920440674
CL_Loss:2.9260101318359375
Loss:6.855968475341797
CL_Loss:2.911447048187256
Loss:7.227229118347168
CL_Loss:3.2180302143096924
Loss:7.101215839385986
CL_Loss:2.936570167541504
Loss:6.261793613433838
CL_Loss:2.4910130500793457
-------------------Start Predicting---------------------:  2026-02-09 03:56:24.546276
Results of LocalSession:

Recall@20: 0.5667 Recall@10: 0.4922  Recall@5:0.4182
HiT@20: 0.5667 HiT@10: 0.4922  HiT@5:0.4182
MRR@20:0.3039 MRR@10:0.2987 MRR@5:0.2887


Best Results:

[0.4181866243721914, 0.4922019561194819, 0.5667459688078245, tensor(0.2887), tensor(0.2987), tensor(0.3039, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.96898889541626
CL_Loss:2.9724788665771484
Loss:6.439024925231934
CL_Loss:2.836033344268799
Loss:6.6467156410217285
CL_Loss:2.6654739379882812
Loss:6.546326637268066
CL_Loss:2.7558512687683105
Loss:6.923467636108398
CL_Loss:2.943939447402954
-------------------Start Predicting---------------------:  2026-02-09 04:15:00.734854
Results of LocalSession:

Recall@20: 0.5663 Recall@10: 0.4925  Recall@5:0.4185
HiT@20: 0.5663 HiT@10: 0.4925  HiT@5:0.4185
MRR@20:0.3038 MRR@10:0.2987 MRR@5:0.2888


Best Results:

[0.4181866243721914, 0.4922019561194819, 0.5667459688078245, tensor(0.2887), tensor(0.2987), tensor(0.3039, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:6.548677444458008
CL_Loss:2.89408016204834
Loss:7.179715156555176
CL_Loss:3.002948045730591
Loss:7.143509864807129
CL_Loss:3.108499050140381
Loss:7.347414970397949
CL_Loss:2.9120068550109863
Loss:7.023184776306152
CL_Loss:2.910383939743042
-------------------Start Predicting---------------------:  2026-02-09 04:32:59.116879
Results of LocalSession:

Recall@20: 0.5665 Recall@10: 0.4924  Recall@5:0.4183
HiT@20: 0.5665 HiT@10: 0.4924  HiT@5:0.4183
MRR@20:0.3039 MRR@10:0.2987 MRR@5:0.2888


Best Results:

[0.4181866243721914, 0.4922019561194819, 0.5667459688078245, tensor(0.2887), tensor(0.2987), tensor(0.3039, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.453581809997559
CL_Loss:2.8630547523498535
Loss:6.597005844116211
CL_Loss:2.831641674041748
Loss:6.430032730102539
CL_Loss:2.8151707649230957
Loss:6.739531517028809
CL_Loss:2.737290620803833
Loss:7.226560592651367
CL_Loss:3.2293548583984375
-------------------Start Predicting---------------------:  2026-02-09 04:50:22.358475
Results of LocalSession:

Recall@20: 0.5668 Recall@10: 0.4927  Recall@5:0.4185
HiT@20: 0.5668 HiT@10: 0.4927  HiT@5:0.4185
MRR@20:0.3038 MRR@10:0.2986 MRR@5:0.2887


Best Results:

[0.41845096484271743, 0.492730637060534, 0.566812053925456, tensor(0.2887), tensor(0.2986), tensor(0.3038, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.116120338439941
CL_Loss:2.6016647815704346
Loss:6.884486198425293
CL_Loss:2.9896926879882812
Loss:6.4245500564575195
CL_Loss:2.8881382942199707
Loss:6.907191276550293
CL_Loss:2.8670527935028076
Loss:7.073914527893066
CL_Loss:2.9669620990753174
-------------------Start Predicting---------------------:  2026-02-09 05:08:33.104428
Results of LocalSession:

Recall@20: 0.5667 Recall@10: 0.4926  Recall@5:0.4185
HiT@20: 0.5667 HiT@10: 0.4926  HiT@5:0.4185
MRR@20:0.3039 MRR@10:0.2987 MRR@5:0.2888


Best Results:

[0.41845096484271743, 0.492730637060534, 0.566812053925456, tensor(0.2887), tensor(0.2986), tensor(0.3038, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:6.896527290344238
CL_Loss:2.8730642795562744
Loss:7.0573039054870605
CL_Loss:3.078359842300415
Loss:6.69149112701416
CL_Loss:2.822721481323242
Loss:7.420757293701172
CL_Loss:3.078745126724243
Loss:7.013915538787842
CL_Loss:2.944786548614502
-------------------Start Predicting---------------------:  2026-02-09 05:26:49.179477
Results of LocalSession:

Recall@20: 0.5668 Recall@10: 0.4926  Recall@5:0.4185
HiT@20: 0.5668 HiT@10: 0.4926  HiT@5:0.4185
MRR@20:0.3039 MRR@10:0.2988 MRR@5:0.2888


Best Results:

[0.41845096484271743, 0.492730637060534, 0.566812053925456, tensor(0.2887), tensor(0.2986), tensor(0.3038, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.758262634277344
CL_Loss:2.733325719833374
Loss:5.773734092712402
CL_Loss:2.4617483615875244
Loss:7.198590278625488
CL_Loss:3.1253764629364014
Loss:6.888246536254883
CL_Loss:3.1610217094421387
Loss:6.424147605895996
CL_Loss:2.9100732803344727
-------------------Start Predicting---------------------:  2026-02-09 05:45:36.239847
Results of LocalSession:

Recall@20: 0.5665 Recall@10: 0.4923  Recall@5:0.4185
HiT@20: 0.5665 HiT@10: 0.4923  HiT@5:0.4185
MRR@20:0.3039 MRR@10:0.2987 MRR@5:0.2888


Best Results:

[0.41845096484271743, 0.492730637060534, 0.566812053925456, tensor(0.2887), tensor(0.2986), tensor(0.3038, device='cuda:0')]
