Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='Nowplaying', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=44)
model is on gpu
  0%|          | 0/825304 [00:00<?, ?it/s] 11%|█         | 87187/825304 [00:00<00:01, 419681.19it/s] 26%|██▋       | 216785/825304 [00:00<00:00, 776728.82it/s] 43%|████▎     | 353024/825304 [00:00<00:00, 992195.59it/s] 56%|█████▋    | 466045/825304 [00:00<00:00, 599128.31it/s] 72%|███████▏  | 592197/825304 [00:00<00:00, 745471.71it/s] 88%|████████▊ | 724091/825304 [00:00<00:00, 883045.32it/s]100%|██████████| 825304/825304 [00:01<00:00, 678440.79it/s]
the number of nodes is :60417
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:14.506921768188477
CL_Loss:2.042231321334839
Loss:12.646998405456543
CL_Loss:2.1651878356933594
Loss:11.03003978729248
CL_Loss:1.8705471754074097
Loss:11.014643669128418
CL_Loss:2.1540448665618896
Loss:11.049394607543945
CL_Loss:2.250919818878174
Loss:10.362282752990723
CL_Loss:2.232279062271118
Loss:10.207708358764648
CL_Loss:1.976254940032959
Loss:9.786845207214355
CL_Loss:1.7745355367660522
Loss:9.537830352783203
CL_Loss:1.9357774257659912
-------------------Start Predicting---------------------:  2026-02-09 11:48:31.870320
Results of LocalSession:

Recall@20: 0.2127 Recall@10: 0.1562  Recall@5:0.1054
HiT@20: 0.2127 HiT@10: 0.1562  HiT@5:0.1054
MRR@20:0.0722 MRR@10:0.0683 MRR@5:0.0616


Best Results:

[0.10536159600997506, 0.15623886711791948, 0.2126714463840399, tensor(0.0616), tensor(0.0683), tensor(0.0722, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.619047164916992
CL_Loss:1.8601949214935303
Loss:8.737051010131836
CL_Loss:2.3152883052825928
Loss:8.484305381774902
CL_Loss:1.856872797012329
Loss:8.685667037963867
CL_Loss:2.0698349475860596
Loss:8.581501007080078
CL_Loss:1.910162329673767
Loss:8.198956489562988
CL_Loss:1.7485555410385132
Loss:8.43412971496582
CL_Loss:1.6840964555740356
Loss:8.872724533081055
CL_Loss:1.9002726078033447
Loss:9.392048835754395
CL_Loss:2.105436086654663
-------------------Start Predicting---------------------:  2026-02-09 11:58:30.055574
Results of LocalSession:

Recall@20: 0.2264 Recall@10: 0.1672  Recall@5:0.1120
HiT@20: 0.2264 HiT@10: 0.1672  HiT@5:0.1120
MRR@20:0.0751 MRR@10:0.0711 MRR@5:0.0637


Best Results:

[0.1119856608478803, 0.16720475596722478, 0.22639828998931244, tensor(0.0637), tensor(0.0711), tensor(0.0751, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:8.311777114868164
CL_Loss:1.9301671981811523
Loss:8.515899658203125
CL_Loss:2.3066115379333496
Loss:8.70357894897461
CL_Loss:2.0968682765960693
Loss:8.212738990783691
CL_Loss:1.7269457578659058
Loss:8.638612747192383
CL_Loss:1.972422480583191
Loss:8.109707832336426
CL_Loss:1.7681962251663208
Loss:8.718474388122559
CL_Loss:2.084782838821411
Loss:7.888727188110352
CL_Loss:1.9680898189544678
Loss:8.707483291625977
CL_Loss:2.2592453956604004
-------------------Start Predicting---------------------:  2026-02-09 12:08:43.375146
Results of LocalSession:

Recall@20: 0.2311 Recall@10: 0.1706  Recall@5:0.1151
HiT@20: 0.2311 HiT@10: 0.1706  HiT@5:0.1151
MRR@20:0.0763 MRR@10:0.0721 MRR@5:0.0647


Best Results:

[0.11511400071250445, 0.1706225507659423, 0.23114089775561097, tensor(0.0647), tensor(0.0721), tensor(0.0763, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:8.125458717346191
CL_Loss:2.008157730102539
Loss:8.05736255645752
CL_Loss:1.9831265211105347
Loss:7.403698444366455
CL_Loss:1.506154179573059
Loss:8.369763374328613
CL_Loss:2.0458834171295166
Loss:8.06285285949707
CL_Loss:2.0668227672576904
Loss:7.425632953643799
CL_Loss:1.6602001190185547
Loss:8.274460792541504
CL_Loss:2.024702310562134
Loss:8.572558403015137
CL_Loss:2.1045830249786377
Loss:8.388004302978516
CL_Loss:1.9919610023498535
-------------------Start Predicting---------------------:  2026-02-09 12:18:55.983169
Results of LocalSession:

Recall@20: 0.2333 Recall@10: 0.1722  Recall@5:0.1168
HiT@20: 0.2333 HiT@10: 0.1722  HiT@5:0.1168
MRR@20:0.0769 MRR@10:0.0727 MRR@5:0.0653


Best Results:

[0.11680619878874243, 0.17218115425721411, 0.2333006768792305, tensor(0.0653), tensor(0.0727), tensor(0.0769, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.67673397064209
CL_Loss:1.9981335401535034
Loss:7.860063076019287
CL_Loss:1.8469723463058472
Loss:8.068231582641602
CL_Loss:1.9238921403884888
Loss:8.341744422912598
CL_Loss:1.8157681226730347
Loss:8.238141059875488
CL_Loss:2.166430711746216
Loss:8.669905662536621
CL_Loss:2.1725661754608154
Loss:8.083418846130371
CL_Loss:1.979222059249878
Loss:8.821756362915039
CL_Loss:2.015225410461426
Loss:7.589244365692139
CL_Loss:1.7306519746780396
-------------------Start Predicting---------------------:  2026-02-09 12:29:16.520394
Results of LocalSession:

Recall@20: 0.2343 Recall@10: 0.1727  Recall@5:0.1173
HiT@20: 0.2343 HiT@10: 0.1727  HiT@5:0.1173
MRR@20:0.0772 MRR@10:0.0729 MRR@5:0.0656


Best Results:

[0.11732944424652654, 0.17265986818667617, 0.23429150338439617, tensor(0.0656), tensor(0.0729), tensor(0.0772, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:8.070635795593262
CL_Loss:1.9694422483444214
Loss:7.911823272705078
CL_Loss:2.0350825786590576
Loss:8.443107604980469
CL_Loss:2.0291082859039307
Loss:7.777937889099121
CL_Loss:1.9811540842056274
Loss:7.74117374420166
CL_Loss:1.8860992193222046
Loss:7.270474910736084
CL_Loss:1.8015395402908325
Loss:8.158943176269531
CL_Loss:2.0059587955474854
Loss:8.036415100097656
CL_Loss:1.9146778583526611
Loss:7.795636177062988
CL_Loss:1.7756142616271973
-------------------Start Predicting---------------------:  2026-02-09 12:40:09.602596
Results of LocalSession:

Recall@20: 0.2345 Recall@10: 0.1733  Recall@5:0.1178
HiT@20: 0.2345 HiT@10: 0.1733  HiT@5:0.1178
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11781929105806911, 0.17330557534734592, 0.2345030281439259, tensor(0.0659), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:7.663322448730469
CL_Loss:1.7856881618499756
Loss:8.023646354675293
CL_Loss:1.9969151020050049
Loss:8.36752986907959
CL_Loss:2.1010687351226807
Loss:7.85873556137085
CL_Loss:1.735084056854248
Loss:7.677619934082031
CL_Loss:1.9617784023284912
Loss:7.934685230255127
CL_Loss:1.8154000043869019
Loss:7.49561882019043
CL_Loss:1.6682885885238647
Loss:8.746962547302246
CL_Loss:2.3032853603363037
Loss:7.912292003631592
CL_Loss:1.8496440649032593
-------------------Start Predicting---------------------:  2026-02-09 12:50:40.836139
Results of LocalSession:

Recall@20: 0.2348 Recall@10: 0.1734  Recall@5:0.1177
HiT@20: 0.2348 HiT@10: 0.1734  HiT@5:0.1177
MRR@20:0.0774 MRR@10:0.0731 MRR@5:0.0658


Best Results:

[0.117730228001425, 0.17339463840399003, 0.23477021731385822, tensor(0.0658), tensor(0.0731), tensor(0.0774, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:7.80718994140625
CL_Loss:1.8096446990966797
Loss:7.77943754196167
CL_Loss:1.86540949344635
Loss:7.801398277282715
CL_Loss:2.0215415954589844
Loss:7.782153129577637
CL_Loss:1.8606725931167603
Loss:7.716007709503174
CL_Loss:2.111855983734131
Loss:8.421927452087402
CL_Loss:1.9368116855621338
Loss:7.9673357009887695
CL_Loss:2.004347562789917
Loss:8.488656044006348
CL_Loss:2.184792995452881
Loss:8.715408325195312
CL_Loss:2.2048280239105225
-------------------Start Predicting---------------------:  2026-02-09 13:00:59.686724
Results of LocalSession:

Recall@20: 0.2348 Recall@10: 0.1734  Recall@5:0.1181
HiT@20: 0.2348 HiT@10: 0.1734  HiT@5:0.1181
MRR@20:0.0775 MRR@10:0.0733 MRR@5:0.0659


Best Results:

[0.11808648022800143, 0.1733835055219095, 0.23481474884218026, tensor(0.0659), tensor(0.0733), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:7.91300630569458
CL_Loss:1.99158775806427
Loss:7.909714698791504
CL_Loss:1.9193967580795288
Loss:7.788912296295166
CL_Loss:1.9418913125991821
Loss:8.11052131652832
CL_Loss:2.1710760593414307
Loss:8.404582023620605
CL_Loss:2.108964204788208
Loss:8.610419273376465
CL_Loss:1.9721004962921143
Loss:7.497351169586182
CL_Loss:1.9262348413467407
Loss:7.851929664611816
CL_Loss:1.8417470455169678
Loss:7.602461338043213
CL_Loss:1.7795085906982422
-------------------Start Predicting---------------------:  2026-02-09 13:10:58.012751
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1734  Recall@5:0.1177
HiT@20: 0.2351 HiT@10: 0.1734  HiT@5:0.1177
MRR@20:0.0774 MRR@10:0.0732 MRR@5:0.0658


Best Results:

[0.11769682935518347, 0.17340577128607054, 0.2350930708941931, tensor(0.0658), tensor(0.0732), tensor(0.0774, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:7.70095157623291
CL_Loss:1.884757399559021
Loss:7.8583292961120605
CL_Loss:1.8666170835494995
Loss:7.568933486938477
CL_Loss:1.7424468994140625
Loss:8.065783500671387
CL_Loss:1.8763402700424194
Loss:8.259400367736816
CL_Loss:2.026625871658325
Loss:8.536311149597168
CL_Loss:2.10310959815979
Loss:7.812342166900635
CL_Loss:2.0473713874816895
Loss:7.91317892074585
CL_Loss:2.077568531036377
Loss:8.006991386413574
CL_Loss:1.823213815689087
-------------------Start Predicting---------------------:  2026-02-09 13:21:01.273111
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1733  Recall@5:0.1179
HiT@20: 0.2352 HiT@10: 0.1733  HiT@5:0.1179
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0658


Best Results:

[0.11794175276095475, 0.17328330958318489, 0.2352043997149982, tensor(0.0658), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:8.300211906433105
CL_Loss:2.196969509124756
Loss:7.244105815887451
CL_Loss:2.035701274871826
Loss:7.961338996887207
CL_Loss:2.1820449829101562
Loss:8.436269760131836
CL_Loss:2.0350914001464844
Loss:8.24787712097168
CL_Loss:2.0329344272613525
Loss:8.106189727783203
CL_Loss:1.898059368133545
Loss:7.795798301696777
CL_Loss:1.8377468585968018
Loss:6.9376959800720215
CL_Loss:1.8272991180419922
Loss:7.818667411804199
CL_Loss:1.7454755306243896
-------------------Start Predicting---------------------:  2026-02-09 13:31:45.283913
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1733  Recall@5:0.1179
HiT@20: 0.2352 HiT@10: 0.1733  HiT@5:0.1179
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11794175276095475, 0.17328330958318489, 0.2352043997149982, tensor(0.0658), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:7.837174415588379
CL_Loss:1.7830053567886353
Loss:7.908205986022949
CL_Loss:2.036102533340454
Loss:8.474470138549805
CL_Loss:2.211350202560425
Loss:7.861354827880859
CL_Loss:1.8261828422546387
Loss:7.970889091491699
CL_Loss:1.958282709121704
Loss:8.096648216247559
CL_Loss:2.0133426189422607
Loss:8.330446243286133
CL_Loss:2.1096577644348145
Loss:7.8676581382751465
CL_Loss:1.9411602020263672
Loss:7.8376054763793945
CL_Loss:1.9832878112792969
-------------------Start Predicting---------------------:  2026-02-09 13:41:49.273727
Results of LocalSession:

Recall@20: 0.2351 Recall@10: 0.1732  Recall@5:0.1180
HiT@20: 0.2351 HiT@10: 0.1732  HiT@5:0.1180
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11794175276095475, 0.17328330958318489, 0.2352043997149982, tensor(0.0658), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:7.594820022583008
CL_Loss:1.9384936094284058
Loss:7.798930644989014
CL_Loss:1.9011015892028809
Loss:8.034380912780762
CL_Loss:2.0015954971313477
Loss:8.126121520996094
CL_Loss:2.1077489852905273
Loss:8.152982711791992
CL_Loss:2.033315896987915
Loss:7.101092338562012
CL_Loss:1.9296619892120361
Loss:8.22309684753418
CL_Loss:2.300551414489746
Loss:7.951543807983398
CL_Loss:1.9638235569000244
Loss:7.971498966217041
CL_Loss:2.197631359100342
-------------------Start Predicting---------------------:  2026-02-09 13:52:38.700212
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1733  Recall@5:0.1180
HiT@20: 0.2352 HiT@10: 0.1733  HiT@5:0.1180
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11803081581759886, 0.17331670822942644, 0.23521553259707872, tensor(0.0659), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:8.005430221557617
CL_Loss:2.0114526748657227
Loss:8.417688369750977
CL_Loss:2.035025119781494
Loss:7.811559677124023
CL_Loss:1.8568540811538696
Loss:8.003508567810059
CL_Loss:1.974656343460083
Loss:7.594592571258545
CL_Loss:1.8863204717636108
Loss:7.6505279541015625
CL_Loss:1.916818380355835
Loss:8.814287185668945
CL_Loss:2.322998046875
Loss:7.6031999588012695
CL_Loss:1.926385760307312
Loss:7.571159839630127
CL_Loss:1.8632203340530396
-------------------Start Predicting---------------------:  2026-02-09 14:03:16.749990
Results of LocalSession:

Recall@20: 0.2352 Recall@10: 0.1734  Recall@5:0.1180
HiT@20: 0.2352 HiT@10: 0.1734  HiT@5:0.1180
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11803081581759886, 0.17331670822942644, 0.23521553259707872, tensor(0.0659), tensor(0.0732), tensor(0.0775, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:7.785563945770264
CL_Loss:2.110076904296875
Loss:7.275998592376709
CL_Loss:1.8150283098220825
Loss:7.938229084014893
CL_Loss:2.159933090209961
Loss:8.154325485229492
CL_Loss:2.209712505340576
Loss:8.270365715026855
CL_Loss:2.1480140686035156
Loss:8.264911651611328
CL_Loss:2.2692933082580566
Loss:8.251675605773926
CL_Loss:2.1890804767608643
Loss:7.660378932952881
CL_Loss:1.8039482831954956
Loss:7.813580513000488
CL_Loss:1.7387930154800415
-------------------Start Predicting---------------------:  2026-02-09 14:13:52.945151
Results of LocalSession:

Recall@20: 0.2353 Recall@10: 0.1734  Recall@5:0.1180
HiT@20: 0.2353 HiT@10: 0.1734  HiT@5:0.1180
MRR@20:0.0775 MRR@10:0.0732 MRR@5:0.0659


Best Results:

[0.11803081581759886, 0.17339463840399003, 0.2352600641254008, tensor(0.0659), tensor(0.0732), tensor(0.0775, device='cuda:0')]
