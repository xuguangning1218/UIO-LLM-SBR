Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='diginetica', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=45)
model is on gpu
  0%|          | 0/719470 [00:00<?, ?it/s] 22%|██▏       | 158300/719470 [00:00<00:00, 1582937.35it/s] 44%|████▍     | 316594/719470 [00:00<00:00, 938415.08it/s]  66%|██████▌   | 475711/719470 [00:00<00:00, 1155456.70it/s] 84%|████████▍ | 607125/719470 [00:00<00:00, 874021.42it/s] 100%|██████████| 719470/719470 [00:00<00:00, 1022870.94it/s]
the number of nodes is :43098
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:10.596651077270508
CL_Loss:0.19015629589557648
Loss:8.406942367553711
CL_Loss:0.321745365858078
Loss:6.805352687835693
CL_Loss:0.12832330167293549
Loss:6.018260955810547
CL_Loss:0.21491385996341705
Loss:6.080722808837891
CL_Loss:0.1618170142173767
Loss:5.602363109588623
CL_Loss:0.2055102437734604
Loss:6.261483192443848
CL_Loss:0.2261911779642105
Loss:5.4116950035095215
CL_Loss:0.23383578658103943
-------------------Start Predicting---------------------:  2026-02-08 16:08:04.950459
Results of LocalSession:

Recall@20: 0.5130 Recall@10: 0.3874  Recall@5:0.2785
HiT@20: 0.5130 HiT@10: 0.3874  HiT@5:0.2785
MRR@20:0.1829 MRR@10:0.1742 MRR@5:0.1597


Best Results:

[0.27851720398304247, 0.3874264681718098, 0.5129974695192087, tensor(0.1597), tensor(0.1742), tensor(0.1829, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:4.844202041625977
CL_Loss:0.22375212609767914
Loss:4.460662841796875
CL_Loss:0.1437394767999649
Loss:5.083421230316162
CL_Loss:0.2302156388759613
Loss:5.132686614990234
CL_Loss:0.11623815447092056
Loss:5.674191474914551
CL_Loss:0.2207915484905243
Loss:4.795576095581055
CL_Loss:0.16531135141849518
Loss:5.180686950683594
CL_Loss:0.19373252987861633
Loss:4.589848518371582
CL_Loss:0.14837948977947235
-------------------Start Predicting---------------------:  2026-02-08 16:18:17.210255
Results of LocalSession:

Recall@20: 0.5345 Recall@10: 0.4075  Recall@5:0.2891
HiT@20: 0.5345 HiT@10: 0.4075  HiT@5:0.2891
MRR@20:0.1886 MRR@10:0.1798 MRR@5:0.1641


Best Results:

[0.28909921456505305, 0.40747313418120873, 0.5344572611653357, tensor(0.1641), tensor(0.1798), tensor(0.1886, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:4.578906536102295
CL_Loss:0.15195618569850922
Loss:4.826164722442627
CL_Loss:0.17325572669506073
Loss:4.414388179779053
CL_Loss:0.1243637427687645
Loss:4.991738319396973
CL_Loss:0.13303521275520325
Loss:4.49405574798584
CL_Loss:0.1980239301919937
Loss:5.15299654006958
CL_Loss:0.2136695832014084
Loss:4.886178016662598
CL_Loss:0.15759333968162537
Loss:4.416855812072754
CL_Loss:0.14753007888793945
-------------------Start Predicting---------------------:  2026-02-08 16:27:28.447449
Results of LocalSession:

Recall@20: 0.5438 Recall@10: 0.4136  Recall@5:0.2955
HiT@20: 0.5438 HiT@10: 0.4136  HiT@5:0.2955
MRR@20:0.1912 MRR@10:0.1822 MRR@5:0.1665


Best Results:

[0.29554043839758126, 0.41363501922508134, 0.5438068947385718, tensor(0.1665), tensor(0.1822), tensor(0.1912, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:4.216039657592773
CL_Loss:0.16247248649597168
Loss:4.667295455932617
CL_Loss:0.23752547800540924
Loss:4.882424831390381
CL_Loss:0.3428482115268707
Loss:4.589159965515137
CL_Loss:0.32319143414497375
Loss:4.87960958480835
CL_Loss:0.30759182572364807
Loss:4.6524553298950195
CL_Loss:0.15334895253181458
Loss:4.69309663772583
CL_Loss:0.20703037083148956
Loss:4.808776378631592
CL_Loss:0.20481204986572266
-------------------Start Predicting---------------------:  2026-02-08 16:36:37.130869
Results of LocalSession:

Recall@20: 0.5466 Recall@10: 0.4151  Recall@5:0.2960
HiT@20: 0.5466 HiT@10: 0.4151  HiT@5:0.2960
MRR@20:0.1917 MRR@10:0.1826 MRR@5:0.1668


Best Results:

[0.29603338920109107, 0.41508100824871014, 0.5466002826251274, tensor(0.1668), tensor(0.1826), tensor(0.1917, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:4.40265417098999
CL_Loss:0.15019045770168304
Loss:4.312995433807373
CL_Loss:0.15879467129707336
Loss:4.42638635635376
CL_Loss:0.13152681291103363
Loss:4.629310131072998
CL_Loss:0.19061830639839172
Loss:4.405914306640625
CL_Loss:0.22136130928993225
Loss:4.569990634918213
CL_Loss:0.16854186356067657
Loss:4.771186828613281
CL_Loss:0.26424771547317505
Loss:4.839250087738037
CL_Loss:0.15448780357837677
-------------------Start Predicting---------------------:  2026-02-08 16:45:45.178776
Results of LocalSession:

Recall@20: 0.5475 Recall@10: 0.4160  Recall@5:0.2969
HiT@20: 0.5475 HiT@10: 0.4160  HiT@5:0.2969
MRR@20:0.1925 MRR@10:0.1833 MRR@5:0.1675


Best Results:

[0.2969207006474087, 0.4160340464688291, 0.547536889151796, tensor(0.1675), tensor(0.1833), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:4.155355930328369
CL_Loss:0.2377454936504364
Loss:4.505434513092041
CL_Loss:0.12817031145095825
Loss:4.672448635101318
CL_Loss:0.2549459636211395
Loss:4.714730262756348
CL_Loss:0.17985349893569946
Loss:4.435300350189209
CL_Loss:0.14603494107723236
Loss:4.938158988952637
CL_Loss:0.24658025801181793
Loss:4.311429977416992
CL_Loss:0.16016557812690735
Loss:4.1104960441589355
CL_Loss:0.1169189065694809
-------------------Start Predicting---------------------:  2026-02-08 16:54:50.354433
Results of LocalSession:

Recall@20: 0.5473 Recall@10: 0.4161  Recall@5:0.2973
HiT@20: 0.5473 HiT@10: 0.4161  HiT@5:0.2973
MRR@20:0.1925 MRR@10:0.1834 MRR@5:0.1676


Best Results:

[0.2969207006474087, 0.4160340464688291, 0.547536889151796, tensor(0.1675), tensor(0.1833), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:4.3050408363342285
CL_Loss:0.16273382306098938
Loss:4.951259136199951
CL_Loss:0.3704772889614105
Loss:4.290080547332764
CL_Loss:0.16652482748031616
Loss:4.581730842590332
CL_Loss:0.22665585577487946
Loss:4.406705379486084
CL_Loss:0.13526231050491333
Loss:4.646098613739014
CL_Loss:0.19812163710594177
Loss:4.539255619049072
CL_Loss:0.10443418473005295
Loss:4.457109451293945
CL_Loss:0.20378127694129944
-------------------Start Predicting---------------------:  2026-02-08 17:04:09.511246
Results of LocalSession:

Recall@20: 0.5478 Recall@10: 0.4160  Recall@5:0.2977
HiT@20: 0.5478 HiT@10: 0.4160  HiT@5:0.2977
MRR@20:0.1925 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.29772585362647475, 0.4159683196950278, 0.5478162279404516, tensor(0.1677), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:4.502452373504639
CL_Loss:0.2598995864391327
Loss:4.051558494567871
CL_Loss:0.18276500701904297
Loss:4.614307403564453
CL_Loss:0.20998957753181458
Loss:4.418570041656494
CL_Loss:0.11298494786024094
Loss:4.5196380615234375
CL_Loss:0.17215700447559357
Loss:4.254173278808594
CL_Loss:0.1927213817834854
Loss:4.528316497802734
CL_Loss:0.12977610528469086
Loss:4.469449520111084
CL_Loss:0.1487295925617218
-------------------Start Predicting---------------------:  2026-02-08 17:13:49.258090
Results of LocalSession:

Recall@20: 0.5478 Recall@10: 0.4162  Recall@5:0.2974
HiT@20: 0.5478 HiT@10: 0.4162  HiT@5:0.2974
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1678


Best Results:

[0.29743008314436886, 0.41618193170988205, 0.5478326596339018, tensor(0.1678), tensor(0.1835), tensor(0.1927, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:4.328747272491455
CL_Loss:0.12418439239263535
Loss:4.028028964996338
CL_Loss:0.12205597758293152
Loss:4.621339797973633
CL_Loss:0.15750165283679962
Loss:4.1708831787109375
CL_Loss:0.2106502801179886
Loss:4.342618465423584
CL_Loss:0.1630261242389679
Loss:4.7651262283325195
CL_Loss:0.2935429811477661
Loss:4.659512996673584
CL_Loss:0.21347469091415405
Loss:4.32125997543335
CL_Loss:0.10539444535970688
-------------------Start Predicting---------------------:  2026-02-08 17:23:33.798838
Results of LocalSession:

Recall@20: 0.5480 Recall@10: 0.4162  Recall@5:0.2974
HiT@20: 0.5480 HiT@10: 0.4162  HiT@5:0.2974
MRR@20:0.1925 MRR@10:0.1834 MRR@5:0.1676


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:4.165472984313965
CL_Loss:0.14416120946407318
Loss:4.063310146331787
CL_Loss:0.13716045022010803
Loss:4.409793376922607
CL_Loss:0.12536998093128204
Loss:4.315758228302002
CL_Loss:0.14244180917739868
Loss:4.645920753479004
CL_Loss:0.18224596977233887
Loss:4.579051494598389
CL_Loss:0.22106555104255676
Loss:4.78204870223999
CL_Loss:0.21173478662967682
Loss:3.898946523666382
CL_Loss:0.11718955636024475
-------------------Start Predicting---------------------:  2026-02-08 17:32:50.291410
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4162  Recall@5:0.2974
HiT@20: 0.5476 HiT@10: 0.4162  HiT@5:0.2974
MRR@20:0.1926 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:4.626149654388428
CL_Loss:0.1779978722333908
Loss:4.5515007972717285
CL_Loss:0.233056902885437
Loss:4.804965496063232
CL_Loss:0.16617651283740997
Loss:4.434656143188477
CL_Loss:0.12210103869438171
Loss:4.459348201751709
CL_Loss:0.15562376379966736
Loss:4.739063739776611
CL_Loss:0.1899954229593277
Loss:4.89760160446167
CL_Loss:0.2520790100097656
Loss:4.3699564933776855
CL_Loss:0.12556906044483185
-------------------Start Predicting---------------------:  2026-02-08 17:41:58.063625
Results of LocalSession:

Recall@20: 0.5478 Recall@10: 0.4162  Recall@5:0.2976
HiT@20: 0.5478 HiT@10: 0.4162  HiT@5:0.2976
MRR@20:0.1926 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:4.801082611083984
CL_Loss:0.1662561446428299
Loss:4.381036758422852
CL_Loss:0.182631254196167
Loss:4.492274284362793
CL_Loss:0.21084091067314148
Loss:4.482527256011963
CL_Loss:0.18043865263462067
Loss:4.511531829833984
CL_Loss:0.17805083096027374
Loss:4.686138153076172
CL_Loss:0.282357782125473
Loss:4.347033977508545
CL_Loss:0.19635161757469177
Loss:4.43084716796875
CL_Loss:0.24963386356830597
-------------------Start Predicting---------------------:  2026-02-08 17:51:10.604152
Results of LocalSession:

Recall@20: 0.5477 Recall@10: 0.4161  Recall@5:0.2976
HiT@20: 0.5477 HiT@10: 0.4161  HiT@5:0.2976
MRR@20:0.1926 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:4.522946357727051
CL_Loss:0.16835084557533264
Loss:4.227935314178467
CL_Loss:0.11142108589410782
Loss:4.236185550689697
CL_Loss:0.12281663715839386
Loss:4.283501625061035
CL_Loss:0.10575342178344727
Loss:4.7291669845581055
CL_Loss:0.19201308488845825
Loss:4.450106143951416
CL_Loss:0.12803898751735687
Loss:4.422372817993164
CL_Loss:0.12171392142772675
Loss:4.566041469573975
CL_Loss:0.18136721849441528
-------------------Start Predicting---------------------:  2026-02-08 18:00:23.878889
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4161  Recall@5:0.2976
HiT@20: 0.5476 HiT@10: 0.4161  HiT@5:0.2976
MRR@20:0.1925 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:4.3231024742126465
CL_Loss:0.16473287343978882
Loss:4.414479732513428
CL_Loss:0.21936357021331787
Loss:4.331612586975098
CL_Loss:0.12063010036945343
Loss:4.628839015960693
CL_Loss:0.26961812376976013
Loss:4.309319019317627
CL_Loss:0.13442091643810272
Loss:4.13401985168457
CL_Loss:0.21116973459720612
Loss:4.35067892074585
CL_Loss:0.204232320189476
Loss:4.418169021606445
CL_Loss:0.28003066778182983
-------------------Start Predicting---------------------:  2026-02-08 18:10:02.897154
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4161  Recall@5:0.2977
HiT@20: 0.5476 HiT@10: 0.4161  HiT@5:0.2977
MRR@20:0.1925 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:4.38895845413208
CL_Loss:0.14664657413959503
Loss:4.3567633628845215
CL_Loss:0.17168483138084412
Loss:4.317495822906494
CL_Loss:0.2203393280506134
Loss:4.214054107666016
CL_Loss:0.1304878443479538
Loss:4.533067226409912
CL_Loss:0.16317664086818695
Loss:3.9679980278015137
CL_Loss:0.11994136869907379
Loss:3.9856948852539062
CL_Loss:0.21589764952659607
Loss:4.577025890350342
CL_Loss:0.280141144990921
-------------------Start Predicting---------------------:  2026-02-08 18:19:08.343927
Results of LocalSession:

Recall@20: 0.5476 Recall@10: 0.4160  Recall@5:0.2976
HiT@20: 0.5476 HiT@10: 0.4160  HiT@5:0.2976
MRR@20:0.1926 MRR@10:0.1834 MRR@5:0.1677


Best Results:

[0.2974465148378192, 0.41624765848368334, 0.5479805448749548, tensor(0.1676), tensor(0.1834), tensor(0.1925, device='cuda:0')]
