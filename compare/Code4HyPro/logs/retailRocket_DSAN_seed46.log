Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='retailRocket_DSAN', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=46)
model is on gpu
  0%|          | 0/433648 [00:00<?, ?it/s] 23%|██▎       | 98387/433648 [00:00<00:00, 484945.65it/s] 47%|████▋     | 202967/433648 [00:00<00:00, 716677.03it/s] 69%|██████▉   | 300676/433648 [00:00<00:00, 580417.86it/s] 96%|█████████▋| 418456/433648 [00:00<00:00, 744403.45it/s]100%|██████████| 433648/433648 [00:00<00:00, 696309.47it/s]
the number of nodes is :36969
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:17.584753036499023
CL_Loss:3.1815779209136963
Loss:9.668533325195312
CL_Loss:3.126262664794922
Loss:10.631629943847656
CL_Loss:3.3216552734375
Loss:8.848897933959961
CL_Loss:3.250683546066284
Loss:8.092193603515625
CL_Loss:3.3259098529815674
-------------------Start Predicting---------------------:  2026-02-09 03:24:16.328225
Results of LocalSession:

Recall@20: 0.5267 Recall@10: 0.4689  Recall@5:0.4090
HiT@20: 0.5267 HiT@10: 0.4689  HiT@5:0.4090
MRR@20:0.2999 MRR@10:0.2959 MRR@5:0.2878


Best Results:

[0.40900079302141157, 0.4689399947131906, 0.5266983875231298, tensor(0.2878), tensor(0.2959), tensor(0.2999, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:8.27210521697998
CL_Loss:3.063258409500122
Loss:7.743015289306641
CL_Loss:3.215914487838745
Loss:8.231951713562012
CL_Loss:3.1361687183380127
Loss:7.19022274017334
CL_Loss:2.9522955417633057
Loss:7.897066593170166
CL_Loss:2.896904945373535
-------------------Start Predicting---------------------:  2026-02-09 03:43:10.865999
Results of LocalSession:

Recall@20: 0.5550 Recall@10: 0.4862  Recall@5:0.4146
HiT@20: 0.5550 HiT@10: 0.4862  HiT@5:0.4146
MRR@20:0.3026 MRR@10:0.2979 MRR@5:0.2882


Best Results:

[0.4145519429024584, 0.48618821041501453, 0.5549828178694158, tensor(0.2882), tensor(0.2979), tensor(0.3026, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:6.69075870513916
CL_Loss:2.7005646228790283
Loss:7.099041938781738
CL_Loss:2.9380552768707275
Loss:7.102651596069336
CL_Loss:2.955960512161255
Loss:7.0760674476623535
CL_Loss:2.7988858222961426
Loss:7.340694427490234
CL_Loss:3.170954465866089
-------------------Start Predicting---------------------:  2026-02-09 04:01:07.320335
Results of LocalSession:

Recall@20: 0.5619 Recall@10: 0.4902  Recall@5:0.4171
HiT@20: 0.5619 HiT@10: 0.4902  HiT@5:0.4171
MRR@20:0.3037 MRR@10:0.2988 MRR@5:0.2888


Best Results:

[0.41706317737245574, 0.4902194025905366, 0.5618556701030928, tensor(0.2888), tensor(0.2988), tensor(0.3037, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:7.089437484741211
CL_Loss:2.959080696105957
Loss:7.154221057891846
CL_Loss:2.909153461456299
Loss:7.077944755554199
CL_Loss:2.8801329135894775
Loss:6.641669750213623
CL_Loss:2.88036847114563
Loss:6.960326194763184
CL_Loss:2.782994270324707
-------------------Start Predicting---------------------:  2026-02-09 04:19:49.715562
Results of LocalSession:

Recall@20: 0.5644 Recall@10: 0.4907  Recall@5:0.4153
HiT@20: 0.5644 HiT@10: 0.4907  HiT@5:0.4153
MRR@20:0.3036 MRR@10:0.2984 MRR@5:0.2882


Best Results:

[0.4153449643140365, 0.49068199841395715, 0.5643669045730901, tensor(0.2882), tensor(0.2984), tensor(0.3036, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:7.291467666625977
CL_Loss:3.187427282333374
Loss:6.61965274810791
CL_Loss:2.8495635986328125
Loss:6.397556304931641
CL_Loss:2.590101480484009
Loss:7.138671398162842
CL_Loss:3.0555529594421387
Loss:7.154614448547363
CL_Loss:3.3170459270477295
-------------------Start Predicting---------------------:  2026-02-09 04:37:51.994029
Results of LocalSession:

Recall@20: 0.5658 Recall@10: 0.4931  Recall@5:0.4161
HiT@20: 0.5658 HiT@10: 0.4931  HiT@5:0.4161
MRR@20:0.3039 MRR@10:0.2989 MRR@5:0.2884


Best Results:

[0.4161379857256146, 0.49306106264869154, 0.5657546920433518, tensor(0.2884), tensor(0.2989), tensor(0.3039, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:6.340427875518799
CL_Loss:2.731304883956909
Loss:6.92174768447876
CL_Loss:2.7077341079711914
Loss:6.813808441162109
CL_Loss:2.8593392372131348
Loss:7.467778205871582
CL_Loss:3.0293333530426025
Loss:7.054003715515137
CL_Loss:2.9513838291168213
-------------------Start Predicting---------------------:  2026-02-09 04:55:22.593082
Results of LocalSession:

Recall@20: 0.5662 Recall@10: 0.4927  Recall@5:0.4174
HiT@20: 0.5662 HiT@10: 0.4927  HiT@5:0.4174
MRR@20:0.3040 MRR@10:0.2989 MRR@5:0.2886


Best Results:

[0.4173936029606133, 0.492730637060534, 0.5662172878667724, tensor(0.2886), tensor(0.2989), tensor(0.3040, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:6.650337219238281
CL_Loss:2.8510141372680664
Loss:6.1374053955078125
CL_Loss:2.800366163253784
Loss:6.143751621246338
CL_Loss:2.53303861618042
Loss:6.522820472717285
CL_Loss:2.9053587913513184
Loss:6.817196846008301
CL_Loss:2.957943916320801
-------------------Start Predicting---------------------:  2026-02-09 05:13:45.894535
Results of LocalSession:

Recall@20: 0.5660 Recall@10: 0.4935  Recall@5:0.4177
HiT@20: 0.5660 HiT@10: 0.4935  HiT@5:0.4177
MRR@20:0.3041 MRR@10:0.2990 MRR@5:0.2887


Best Results:

[0.4173936029606133, 0.492730637060534, 0.5662172878667724, tensor(0.2886), tensor(0.2989), tensor(0.3040, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:7.346133708953857
CL_Loss:3.0431652069091797
Loss:7.522669315338135
CL_Loss:3.1640572547912598
Loss:6.27701473236084
CL_Loss:2.8522441387176514
Loss:6.794277191162109
CL_Loss:2.7739474773406982
Loss:6.788734436035156
CL_Loss:2.6990606784820557
-------------------Start Predicting---------------------:  2026-02-09 05:31:55.381048
Results of LocalSession:

Recall@20: 0.5663 Recall@10: 0.4946  Recall@5:0.4176
HiT@20: 0.5663 HiT@10: 0.4946  HiT@5:0.4176
MRR@20:0.3041 MRR@10:0.2991 MRR@5:0.2887


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:7.432141304016113
CL_Loss:3.1373703479766846
Loss:6.956191062927246
CL_Loss:2.936772108078003
Loss:6.501757621765137
CL_Loss:2.854940414428711
Loss:7.486086368560791
CL_Loss:3.1445155143737793
Loss:6.704319953918457
CL_Loss:2.749729871749878
-------------------Start Predicting---------------------:  2026-02-09 05:49:56.742318
Results of LocalSession:

Recall@20: 0.5657 Recall@10: 0.4941  Recall@5:0.4173
HiT@20: 0.5657 HiT@10: 0.4941  HiT@5:0.4173
MRR@20:0.3043 MRR@10:0.2992 MRR@5:0.2888


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:6.339988708496094
CL_Loss:2.62923002243042
Loss:6.1985673904418945
CL_Loss:2.702066659927368
Loss:7.029848098754883
CL_Loss:2.850417375564575
Loss:6.542666435241699
CL_Loss:2.99609375
Loss:7.411035060882568
CL_Loss:3.2750673294067383
-------------------Start Predicting---------------------:  2026-02-09 06:08:45.542888
Results of LocalSession:

Recall@20: 0.5661 Recall@10: 0.4944  Recall@5:0.4173
HiT@20: 0.5661 HiT@10: 0.4944  HiT@5:0.4173
MRR@20:0.3043 MRR@10:0.2993 MRR@5:0.2888


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:7.025997161865234
CL_Loss:3.0096447467803955
Loss:7.173289775848389
CL_Loss:3.063725471496582
Loss:6.86128568649292
CL_Loss:2.7832393646240234
Loss:6.865897178649902
CL_Loss:2.9373250007629395
Loss:7.63345193862915
CL_Loss:3.4090685844421387
-------------------Start Predicting---------------------:  2026-02-09 06:27:52.403592
Results of LocalSession:

Recall@20: 0.5662 Recall@10: 0.4946  Recall@5:0.4175
HiT@20: 0.5662 HiT@10: 0.4946  HiT@5:0.4175
MRR@20:0.3044 MRR@10:0.2994 MRR@5:0.2889


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:6.760819435119629
CL_Loss:2.73559832572937
Loss:6.26140832901001
CL_Loss:2.5419363975524902
Loss:6.87342643737793
CL_Loss:3.2430334091186523
Loss:7.078280448913574
CL_Loss:2.8635852336883545
Loss:6.861027717590332
CL_Loss:3.029864549636841
-------------------Start Predicting---------------------:  2026-02-09 06:47:12.125540
Results of LocalSession:

Recall@20: 0.5662 Recall@10: 0.4944  Recall@5:0.4177
HiT@20: 0.5662 HiT@10: 0.4944  HiT@5:0.4177
MRR@20:0.3042 MRR@10:0.2992 MRR@5:0.2888


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:6.971640586853027
CL_Loss:3.0007832050323486
Loss:6.788017272949219
CL_Loss:3.1191210746765137
Loss:6.972064971923828
CL_Loss:3.259411334991455
Loss:6.553098678588867
CL_Loss:2.8028032779693604
Loss:6.626531600952148
CL_Loss:2.7574501037597656
-------------------Start Predicting---------------------:  2026-02-09 07:04:16.490287
Results of LocalSession:

Recall@20: 0.5662 Recall@10: 0.4944  Recall@5:0.4176
HiT@20: 0.5662 HiT@10: 0.4944  HiT@5:0.4176
MRR@20:0.3044 MRR@10:0.2994 MRR@5:0.2890


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:7.253286361694336
CL_Loss:2.9309136867523193
Loss:6.405306816101074
CL_Loss:2.645551919937134
Loss:6.329537868499756
CL_Loss:2.761524200439453
Loss:6.701534271240234
CL_Loss:2.885307550430298
Loss:6.801302909851074
CL_Loss:2.7917964458465576
-------------------Start Predicting---------------------:  2026-02-09 07:20:31.016251
Results of LocalSession:

Recall@20: 0.5663 Recall@10: 0.4947  Recall@5:0.4177
HiT@20: 0.5663 HiT@10: 0.4947  HiT@5:0.4177
MRR@20:0.3042 MRR@10:0.2992 MRR@5:0.2888


Best Results:

[0.4175918583135078, 0.49458102035421625, 0.5662833729844039, tensor(0.2887), tensor(0.2991), tensor(0.3041, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:6.931891441345215
CL_Loss:2.963855504989624
Loss:6.85901403427124
CL_Loss:2.699498176574707
Loss:7.110308647155762
CL_Loss:3.095148801803589
Loss:6.2797393798828125
CL_Loss:2.8812146186828613
Loss:6.685540199279785
CL_Loss:2.882563829421997
-------------------Start Predicting---------------------:  2026-02-09 07:36:39.120051
Results of LocalSession:

Recall@20: 0.5664 Recall@10: 0.4946  Recall@5:0.4177
HiT@20: 0.5664 HiT@10: 0.4946  HiT@5:0.4177
MRR@20:0.3044 MRR@10:0.2994 MRR@5:0.2890


Best Results:

[0.41772402854877083, 0.49464710547184776, 0.5664155432196669, tensor(0.2890), tensor(0.2994), tensor(0.3044, device='cuda:0')]
