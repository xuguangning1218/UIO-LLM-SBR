Namespace(path='/home/xuguangning/work/UIO-LLM-SBR/datasets/', dataset='diginetica', epoch=15, batchSize=100, l2=1e-05, lr=0.001, lr_dc=0.6, lr_dc_step=1, embedding=100, posembedding=100, gnn_layer=1, en_layer=1, heads=1, k=500, threshold=0.0, p=0.99, theta=1.0, temp=0.1, semantic_cluster=False, dropout_in=0.1, dropout_hid=0.1, isvalidation=False, seed=42)
model is on gpu
  0%|          | 0/719470 [00:00<?, ?it/s] 21%|██▏       | 153012/719470 [00:00<00:00, 1530063.09it/s] 43%|████▎     | 306019/719470 [00:00<00:00, 856547.78it/s]  65%|██████▍   | 464689/719470 [00:00<00:00, 1090126.50it/s] 82%|████████▏ | 592302/719470 [00:00<00:00, 861130.45it/s] 100%|██████████| 719470/719470 [00:00<00:00, 1002832.32it/s]
the number of nodes is :43098
the number of clusters is is :500
--------------------------Start Training--------------------------
---------------This is epoch: 0---------------
Loss:13.174962997436523
CL_Loss:0.2382064312696457
Loss:7.718265056610107
CL_Loss:0.1532953381538391
Loss:6.832350730895996
CL_Loss:0.19681048393249512
Loss:6.339875221252441
CL_Loss:0.2215520441532135
Loss:5.877480506896973
CL_Loss:0.23445773124694824
Loss:5.198412895202637
CL_Loss:0.3392969071865082
Loss:5.51742696762085
CL_Loss:0.26356860995292664
Loss:5.480967998504639
CL_Loss:0.2117432951927185
-------------------Start Predicting---------------------:  2026-02-08 13:44:34.707958
Results of LocalSession:

Recall@20: 0.5139 Recall@10: 0.3890  Recall@5:0.2816
HiT@20: 0.5139 HiT@10: 0.3890  HiT@5:0.2816
MRR@20:0.1840 MRR@10:0.1754 MRR@5:0.1611


Best Results:

[0.28158993065825366, 0.38898747904959086, 0.5139012126589766, tensor(0.1611), tensor(0.1754), tensor(0.1840, device='cuda:0')]
---------------This is epoch: 1---------------
Loss:4.5377068519592285
CL_Loss:0.19169889390468597
Loss:4.51657247543335
CL_Loss:0.1283983439207077
Loss:5.362109661102295
CL_Loss:0.20441967248916626
Loss:5.096804618835449
CL_Loss:0.16721320152282715
Loss:5.0245161056518555
CL_Loss:0.173817977309227
Loss:5.077187538146973
CL_Loss:0.18245196342468262
Loss:4.9672136306762695
CL_Loss:0.14352433383464813
Loss:4.848175525665283
CL_Loss:0.1879960149526596
-------------------Start Predicting---------------------:  2026-02-08 13:54:47.454532
Results of LocalSession:

Recall@20: 0.5372 Recall@10: 0.4058  Recall@5:0.2908
HiT@20: 0.5372 HiT@10: 0.4058  HiT@5:0.2908
MRR@20:0.1898 MRR@10:0.1807 MRR@5:0.1654


Best Results:

[0.2907588156035361, 0.4057971014492754, 0.5372013539715403, tensor(0.1654), tensor(0.1807), tensor(0.1898, device='cuda:0')]
---------------This is epoch: 2---------------
Loss:4.985249996185303
CL_Loss:0.16205303370952606
Loss:4.4483489990234375
CL_Loss:0.12436942011117935
Loss:4.763930320739746
CL_Loss:0.22683726251125336
Loss:4.50945520401001
CL_Loss:0.1328413188457489
Loss:4.447937965393066
CL_Loss:0.08439663052558899
Loss:4.820517539978027
CL_Loss:0.20421957969665527
Loss:4.59607458114624
CL_Loss:0.1530851125717163
Loss:4.873015403747559
CL_Loss:0.17434531450271606
-------------------Start Predicting---------------------:  2026-02-08 14:04:03.149203
Results of LocalSession:

Recall@20: 0.5455 Recall@10: 0.4123  Recall@5:0.2965
HiT@20: 0.5455 HiT@10: 0.4123  HiT@5:0.2965
MRR@20:0.1919 MRR@10:0.1826 MRR@5:0.1673


Best Results:

[0.2964934766177002, 0.41228762036215455, 0.5454500640836044, tensor(0.1673), tensor(0.1826), tensor(0.1919, device='cuda:0')]
---------------This is epoch: 3---------------
Loss:4.2974042892456055
CL_Loss:0.15647263824939728
Loss:4.7503743171691895
CL_Loss:0.21266572177410126
Loss:4.213597297668457
CL_Loss:0.12256297469139099
Loss:4.768630504608154
CL_Loss:0.114201121032238
Loss:4.605201721191406
CL_Loss:0.1355542540550232
Loss:4.802562236785889
CL_Loss:0.0857098177075386
Loss:4.752616882324219
CL_Loss:0.20049412548542023
Loss:5.462118625640869
CL_Loss:0.24667909741401672
-------------------Start Predicting---------------------:  2026-02-08 14:13:14.974480
Results of LocalSession:

Recall@20: 0.5478 Recall@10: 0.4152  Recall@5:0.2976
HiT@20: 0.5478 HiT@10: 0.4152  HiT@5:0.2976
MRR@20:0.1927 MRR@10:0.1835 MRR@5:0.1679


Best Results:

[0.29761083177232245, 0.4151795984094121, 0.5477997962470013, tensor(0.1679), tensor(0.1835), tensor(0.1927, device='cuda:0')]
---------------This is epoch: 4---------------
Loss:4.7419514656066895
CL_Loss:0.17233845591545105
Loss:4.392429351806641
CL_Loss:0.10344581305980682
Loss:4.641155242919922
CL_Loss:0.15345701575279236
Loss:4.537179946899414
CL_Loss:0.1554269641637802
Loss:4.551205635070801
CL_Loss:0.2670164108276367
Loss:4.852555274963379
CL_Loss:0.15495997667312622
Loss:4.668725490570068
CL_Loss:0.15042120218276978
Loss:4.446664810180664
CL_Loss:0.26364031434059143
-------------------Start Predicting---------------------:  2026-02-08 14:23:29.739194
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4161  Recall@5:0.2978
HiT@20: 0.5490 HiT@10: 0.4161  HiT@5:0.2978
MRR@20:0.1933 MRR@10:0.1841 MRR@5:0.1685


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 5---------------
Loss:4.359862804412842
CL_Loss:0.37706729769706726
Loss:4.021307468414307
CL_Loss:0.16539405286312103
Loss:4.383060455322266
CL_Loss:0.17852683365345
Loss:4.6900858879089355
CL_Loss:0.15398994088172913
Loss:4.690779685974121
CL_Loss:0.1616693139076233
Loss:4.896559715270996
CL_Loss:0.14506162703037262
Loss:4.7089972496032715
CL_Loss:0.23390987515449524
Loss:4.47979736328125
CL_Loss:0.1989666372537613
-------------------Start Predicting---------------------:  2026-02-08 14:33:34.467843
Results of LocalSession:

Recall@20: 0.5489 Recall@10: 0.4162  Recall@5:0.2985
HiT@20: 0.5489 HiT@10: 0.4162  HiT@5:0.2985
MRR@20:0.1934 MRR@10:0.1842 MRR@5:0.1686


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 6---------------
Loss:4.552798271179199
CL_Loss:0.29184389114379883
Loss:4.416079998016357
CL_Loss:0.20154571533203125
Loss:3.9785990715026855
CL_Loss:0.15202641487121582
Loss:4.20453405380249
CL_Loss:0.13719114661216736
Loss:4.373379707336426
CL_Loss:0.1211511418223381
Loss:4.313776969909668
CL_Loss:0.13187694549560547
Loss:4.285688400268555
CL_Loss:0.16642546653747559
Loss:4.5672287940979
CL_Loss:0.1459379941225052
-------------------Start Predicting---------------------:  2026-02-08 14:42:45.979528
Results of LocalSession:

Recall@20: 0.5489 Recall@10: 0.4163  Recall@5:0.2986
HiT@20: 0.5489 HiT@10: 0.4163  HiT@5:0.2986
MRR@20:0.1934 MRR@10:0.1841 MRR@5:0.1686


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 7---------------
Loss:4.618607044219971
CL_Loss:0.1735459268093109
Loss:4.693130970001221
CL_Loss:0.24449963867664337
Loss:4.536528587341309
CL_Loss:0.18680493533611298
Loss:3.955005645751953
CL_Loss:0.1792565882205963
Loss:4.998857021331787
CL_Loss:0.21587175130844116
Loss:4.454639911651611
CL_Loss:0.12856540083885193
Loss:4.3552985191345215
CL_Loss:0.16437499225139618
Loss:4.732060432434082
CL_Loss:0.24179761111736298
-------------------Start Predicting---------------------:  2026-02-08 14:51:57.864225
Results of LocalSession:

Recall@20: 0.5487 Recall@10: 0.4162  Recall@5:0.2986
HiT@20: 0.5487 HiT@10: 0.4162  HiT@5:0.2986
MRR@20:0.1935 MRR@10:0.1843 MRR@5:0.1687


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 8---------------
Loss:4.107112884521484
CL_Loss:0.10451113432645798
Loss:4.1596479415893555
CL_Loss:0.11522375047206879
Loss:4.051974296569824
CL_Loss:0.1098410040140152
Loss:4.8954691886901855
CL_Loss:0.24142517149448395
Loss:4.4395856857299805
CL_Loss:0.21039414405822754
Loss:4.722955703735352
CL_Loss:0.14007161557674408
Loss:4.563440799713135
CL_Loss:0.13737963140010834
Loss:4.494899272918701
CL_Loss:0.07735190540552139
-------------------Start Predicting---------------------:  2026-02-08 15:01:16.714332
Results of LocalSession:

Recall@20: 0.5487 Recall@10: 0.4159  Recall@5:0.2988
HiT@20: 0.5487 HiT@10: 0.4159  HiT@5:0.2988
MRR@20:0.1935 MRR@10:0.1843 MRR@5:0.1687


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 9---------------
Loss:3.9223058223724365
CL_Loss:0.13234704732894897
Loss:4.724079608917236
CL_Loss:0.27025336027145386
Loss:4.260512351989746
CL_Loss:0.09810042381286621
Loss:4.4923248291015625
CL_Loss:0.11694145947694778
Loss:4.176124095916748
CL_Loss:0.18180687725543976
Loss:4.4312214851379395
CL_Loss:0.18255503475666046
Loss:4.262479782104492
CL_Loss:0.15591645240783691
Loss:4.578210353851318
CL_Loss:0.1503046602010727
-------------------Start Predicting---------------------:  2026-02-08 15:10:39.661136
Results of LocalSession:

Recall@20: 0.5489 Recall@10: 0.4160  Recall@5:0.2985
HiT@20: 0.5489 HiT@10: 0.4160  HiT@5:0.2985
MRR@20:0.1935 MRR@10:0.1843 MRR@5:0.1687


Best Results:

[0.29779158040027603, 0.41609977324263037, 0.5489828781754248, tensor(0.1685), tensor(0.1841), tensor(0.1933, device='cuda:0')]
---------------This is epoch: 10---------------
Loss:4.426072597503662
CL_Loss:0.11876603960990906
Loss:4.409231185913086
CL_Loss:0.1910865604877472
Loss:4.603156089782715
CL_Loss:0.29902422428131104
Loss:4.4955549240112305
CL_Loss:0.16665512323379517
Loss:4.3962578773498535
CL_Loss:0.17825686931610107
Loss:4.702738285064697
CL_Loss:0.26938995718955994
Loss:4.374361515045166
CL_Loss:0.2516617476940155
Loss:4.429924964904785
CL_Loss:0.19243645668029785
-------------------Start Predicting---------------------:  2026-02-08 15:19:53.979717
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4159  Recall@5:0.2984
HiT@20: 0.5490 HiT@10: 0.4159  HiT@5:0.2984
MRR@20:0.1936 MRR@10:0.1844 MRR@5:0.1688


Best Results:

[0.29844884813828915, 0.4158861612277761, 0.5489993098688751, tensor(0.1688), tensor(0.1844), tensor(0.1936, device='cuda:0')]
---------------This is epoch: 11---------------
Loss:4.5946245193481445
CL_Loss:0.2141873836517334
Loss:4.89912223815918
CL_Loss:0.19213369488716125
Loss:4.545202255249023
CL_Loss:0.2433488368988037
Loss:4.525687217712402
CL_Loss:0.2499111145734787
Loss:4.388348579406738
CL_Loss:0.1579863280057907
Loss:4.587291240692139
CL_Loss:0.19493429362773895
Loss:4.834179878234863
CL_Loss:0.14938099682331085
Loss:4.428579330444336
CL_Loss:0.15325193107128143
-------------------Start Predicting---------------------:  2026-02-08 15:29:57.749791
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4159  Recall@5:0.2984
HiT@20: 0.5490 HiT@10: 0.4159  HiT@5:0.2984
MRR@20:0.1936 MRR@10:0.1843 MRR@5:0.1687


Best Results:

[0.29844884813828915, 0.4158861612277761, 0.5489993098688751, tensor(0.1688), tensor(0.1844), tensor(0.1936, device='cuda:0')]
---------------This is epoch: 12---------------
Loss:4.507776737213135
CL_Loss:0.21805118024349213
Loss:4.016646385192871
CL_Loss:0.10587354749441147
Loss:4.44670295715332
CL_Loss:0.1817740947008133
Loss:4.1610846519470215
CL_Loss:0.11362346261739731
Loss:4.012969970703125
CL_Loss:0.15755894780158997
Loss:4.427089214324951
CL_Loss:0.18544623255729675
Loss:4.607585906982422
CL_Loss:0.18102607131004333
Loss:4.340859889984131
CL_Loss:0.17320723831653595
-------------------Start Predicting---------------------:  2026-02-08 15:39:12.321108
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4159  Recall@5:0.2986
HiT@20: 0.5490 HiT@10: 0.4159  HiT@5:0.2986
MRR@20:0.1936 MRR@10:0.1844 MRR@5:0.1688


Best Results:

[0.2985803016858917, 0.41590259292122644, 0.5490157415623255, tensor(0.1688), tensor(0.1844), tensor(0.1936, device='cuda:0')]
---------------This is epoch: 13---------------
Loss:4.351568698883057
CL_Loss:0.21721035242080688
Loss:4.617384910583496
CL_Loss:0.2631213068962097
Loss:4.269334316253662
CL_Loss:0.24195300042629242
Loss:4.1413960456848145
CL_Loss:0.1668500304222107
Loss:4.604373455047607
CL_Loss:0.22708381712436676
Loss:4.501871109008789
CL_Loss:0.19988730549812317
Loss:4.386928558349609
CL_Loss:0.17723985016345978
Loss:4.598959445953369
CL_Loss:0.18981824815273285
-------------------Start Predicting---------------------:  2026-02-08 15:48:28.338645
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4159  Recall@5:0.2986
HiT@20: 0.5490 HiT@10: 0.4159  HiT@5:0.2986
MRR@20:0.1936 MRR@10:0.1844 MRR@5:0.1688


Best Results:

[0.29859673337934206, 0.4159354563081271, 0.5490321732557757, tensor(0.1688), tensor(0.1844), tensor(0.1936, device='cuda:0')]
---------------This is epoch: 14---------------
Loss:4.409093379974365
CL_Loss:0.17365720868110657
Loss:4.189361572265625
CL_Loss:0.19677944481372833
Loss:4.115167617797852
CL_Loss:0.15790292620658875
Loss:4.470428943634033
CL_Loss:0.16732971370220184
Loss:4.534823417663574
CL_Loss:0.17735590040683746
Loss:4.810873985290527
CL_Loss:0.2059803009033203
Loss:4.345056533813477
CL_Loss:0.11973290890455246
Loss:5.059209823608398
CL_Loss:0.25201278924942017
-------------------Start Predicting---------------------:  2026-02-08 15:58:26.388670
Results of LocalSession:

Recall@20: 0.5490 Recall@10: 0.4160  Recall@5:0.2986
HiT@20: 0.5490 HiT@10: 0.4160  HiT@5:0.2986
MRR@20:0.1937 MRR@10:0.1844 MRR@5:0.1688


Best Results:

[0.29859673337934206, 0.4159354563081271, 0.5490321732557757, tensor(0.1688), tensor(0.1844), tensor(0.1936, device='cuda:0')]
