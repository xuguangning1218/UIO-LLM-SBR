/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py:66: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:644.)
  sparse_matrix = torch.sparse.LongTensor(i, v, torch.Size(shape))
Namespace(dataset='Tmall', batchSize=64, hiddenSize=100, epoch=15, lr=0.001, lr_dc=0.1, lr_dc_step=5, l2=1e-05, step=1, patience=3, nonhybrid=False, validation=False, valid_portion=0.1, w_ne=1.7, gama=1.7, seed=42, num_attention_heads=5, neighbor_n=3, contrastive_weight=1.0)
random_seed: 42
self.neighbor: 3
-------------------------------------------------------
epoch:  0
start training:  2026-02-06 04:46:34.437219
contrastive_weight: 1.0
[0/5489] Loss: 21.9126
[1098/5489] Loss: 12.5912
[2196/5489] Loss: 11.6743
[3294/5489] Loss: 10.4641
[4392/5489] Loss: 10.2105
	Loss:	62169.715
start predicting:  2026-02-06 04:53:36.618137
P@5: 22.0480	MRR@5: 14.7601	Epoch: 0,  0
P@10: 26.0870	MRR@10: 15.3026	Epoch: 0,  0
P@20: 29.7320	MRR@20: 15.5578	Epoch: 0,  0
Best Result:
	P@20:	29.7320	MRR@20:	15.5578	Epoch:	0,	0
-------------------------------------------------------
epoch:  1
start training:  2026-02-06 04:54:08.310611
contrastive_weight: 1.0
[0/5489] Loss: 9.2696
[1098/5489] Loss: 9.2606
[2196/5489] Loss: 8.6935
[3294/5489] Loss: 9.1589
[4392/5489] Loss: 9.2828
	Loss:	47376.266
start predicting:  2026-02-06 05:00:57.606544
P@5: 29.3729	MRR@5: 18.4359	Epoch: 1,  1
P@10: 35.8097	MRR@10: 19.2945	Epoch: 1,  1
P@20: 41.5283	MRR@20: 19.6934	Epoch: 1,  1
Best Result:
	P@20:	41.5283	MRR@20:	19.6934	Epoch:	1,	1
-------------------------------------------------------
epoch:  2
start training:  2026-02-06 05:01:29.155093
contrastive_weight: 1.0
[0/5489] Loss: 7.3427
[1098/5489] Loss: 8.0816
[2196/5489] Loss: 7.1710
[3294/5489] Loss: 7.9258
[4392/5489] Loss: 7.8397
	Loss:	42646.609
start predicting:  2026-02-06 05:08:22.315022
P@5: 29.4038	MRR@5: 18.4359	Epoch: 2,  1
P@10: 36.4700	MRR@10: 19.2945	Epoch: 2,  1
P@20: 42.5940	MRR@20: 19.6934	Epoch: 2,  1
Best Result:
	P@20:	42.5940	MRR@20:	19.6934	Epoch:	2,	1
-------------------------------------------------------
epoch:  3
start training:  2026-02-06 05:08:53.953762
contrastive_weight: 1.0
[0/5489] Loss: 7.5453
[1098/5489] Loss: 7.9479
[2196/5489] Loss: 7.3558
[3294/5489] Loss: 7.4407
[4392/5489] Loss: 7.6326
	Loss:	40730.848
start predicting:  2026-02-06 05:15:46.991611
P@5: 29.4038	MRR@5: 18.4359	Epoch: 2,  1
P@10: 36.4700	MRR@10: 19.2945	Epoch: 2,  1
P@20: 42.5940	MRR@20: 19.6934	Epoch: 2,  1
Best Result:
	P@20:	42.5940	MRR@20:	19.6934	Epoch:	2,	1
-------------------------------------------------------
epoch:  4
start training:  2026-02-06 05:16:18.758529
contrastive_weight: 1.0
[0/5489] Loss: 6.8222
[1098/5489] Loss: 6.3987
[2196/5489] Loss: 6.7462
[3294/5489] Loss: 6.9124
[4392/5489] Loss: 6.9339
	Loss:	39446.367
start predicting:  2026-02-06 05:23:09.413999
P@5: 29.4038	MRR@5: 18.4359	Epoch: 2,  1
P@10: 36.4700	MRR@10: 19.2945	Epoch: 2,  1
P@20: 42.5940	MRR@20: 19.6934	Epoch: 2,  1
Best Result:
	P@20:	42.5940	MRR@20:	19.6934	Epoch:	2,	1
-------------------------------------------------------
epoch:  5
start training:  2026-02-06 05:23:41.158306
contrastive_weight: 1.0
[0/5489] Loss: 5.7351
[1098/5489] Loss: 5.7079
[2196/5489] Loss: 6.3842
[3294/5489] Loss: 6.2908
[4392/5489] Loss: 6.2585
	Loss:	34115.859
start predicting:  2026-02-06 05:30:30.638775
P@5: 29.4038	MRR@5: 18.4359	Epoch: 2,  1
P@10: 36.4700	MRR@10: 19.2945	Epoch: 2,  1
P@20: 42.5940	MRR@20: 19.6934	Epoch: 2,  1
Best Result:
	P@20:	42.5940	MRR@20:	19.6934	Epoch:	2,	1
-------------------------------------------------------
Run time: 2668.942235 s
Traceback (most recent call last):
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 181, in <module>
    main()
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 165, in main
    torch.save(model, PATH)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 810, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 781, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name, _compute_crc32))
RuntimeError: Parent directory ./final_model does not exist.
