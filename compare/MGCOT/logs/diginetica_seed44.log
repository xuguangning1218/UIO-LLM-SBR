/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py:66: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:644.)
  sparse_matrix = torch.sparse.LongTensor(i, v, torch.Size(shape))
Namespace(dataset='diginetica', batchSize=64, hiddenSize=100, epoch=15, lr=0.001, lr_dc=0.1, lr_dc_step=5, l2=1e-05, step=1, patience=3, nonhybrid=False, validation=False, valid_portion=0.1, w_ne=1.7, gama=1.7, seed=44, num_attention_heads=5, neighbor_n=3, contrastive_weight=1.0)
random_seed: 44
self.neighbor: 3
-------------------------------------------------------
epoch:  0
start training:  2026-02-05 18:08:55.247005
contrastive_weight: 1.0
[0/11242] Loss: 21.9312
[2249/11242] Loss: 11.8450
[4498/11242] Loss: 11.5047
[6747/11242] Loss: 9.6212
[8996/11242] Loss: 8.6163
	Loss:	121129.336
start predicting:  2026-02-05 18:24:28.747272
P@5: 38.6391	MRR@5: 22.0813	Epoch: 0,  0
P@10: 48.6542	MRR@10: 23.4225	Epoch: 0,  0
P@20: 57.7903	MRR@20: 24.0602	Epoch: 0,  0
Best Result:
	P@20:	57.7903	MRR@20:	24.0602	Epoch:	0,	0
-------------------------------------------------------
epoch:  1
start training:  2026-02-05 18:25:35.886962
contrastive_weight: 1.0
[0/11242] Loss: 9.4227
[2249/11242] Loss: 8.6722
[4498/11242] Loss: 9.1168
[6747/11242] Loss: 8.3455
[8996/11242] Loss: 8.9280
	Loss:	95257.703
start predicting:  2026-02-05 18:40:59.188322
P@5: 41.0529	MRR@5: 23.3240	Epoch: 1,  1
P@10: 51.9176	MRR@10: 24.7810	Epoch: 1,  1
P@20: 61.9393	MRR@20: 25.4773	Epoch: 1,  1
Best Result:
	P@20:	61.9393	MRR@20:	25.4773	Epoch:	1,	1
-------------------------------------------------------
epoch:  2
start training:  2026-02-05 18:42:06.957559
contrastive_weight: 1.0
[0/11242] Loss: 7.3806
[2249/11242] Loss: 8.3415
[4498/11242] Loss: 7.7496
[6747/11242] Loss: 7.8840
[8996/11242] Loss: 7.7157
	Loss:	90850.688
start predicting:  2026-02-05 18:57:32.401203
P@5: 41.7299	MRR@5: 23.7984	Epoch: 2,  2
P@10: 52.7835	MRR@10: 25.2806	Epoch: 2,  2
P@20: 63.1108	MRR@20: 26.0029	Epoch: 2,  2
Best Result:
	P@20:	63.1108	MRR@20:	26.0029	Epoch:	2,	2
-------------------------------------------------------
epoch:  3
start training:  2026-02-05 18:58:39.696680
contrastive_weight: 1.0
[0/11242] Loss: 7.3040
[2249/11242] Loss: 7.7109
[4498/11242] Loss: 7.9354
[6747/11242] Loss: 7.7890
[8996/11242] Loss: 8.2532
	Loss:	88628.945
start predicting:  2026-02-05 19:14:41.212082
P@5: 41.7299	MRR@5: 23.9095	Epoch: 2,  3
P@10: 52.7835	MRR@10: 25.4344	Epoch: 2,  3
P@20: 63.4444	MRR@20: 26.1769	Epoch: 3,  3
Best Result:
	P@20:	63.4444	MRR@20:	26.1769	Epoch:	3,	3
-------------------------------------------------------
epoch:  4
start training:  2026-02-05 19:15:51.396303
contrastive_weight: 1.0
[0/11242] Loss: 7.7639
[2249/11242] Loss: 7.3827
[4498/11242] Loss: 8.1003
[6747/11242] Loss: 8.0036
[8996/11242] Loss: 7.9707
	Loss:	86950.562
start predicting:  2026-02-05 19:31:58.411849
P@5: 41.7299	MRR@5: 23.9542	Epoch: 2,  4
P@10: 52.7835	MRR@10: 25.5206	Epoch: 2,  4
P@20: 63.4444	MRR@20: 26.2693	Epoch: 3,  4
Best Result:
	P@20:	63.4444	MRR@20:	26.2693	Epoch:	3,	4
-------------------------------------------------------
epoch:  5
start training:  2026-02-05 19:33:07.837221
contrastive_weight: 1.0
[0/11242] Loss: 7.3645
[2249/11242] Loss: 6.7803
[4498/11242] Loss: 7.9430
[6747/11242] Loss: 6.4418
[8996/11242] Loss: 7.1774
	Loss:	78841.430
start predicting:  2026-02-05 19:49:13.062832
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.3436	MRR@10: 27.6558	Epoch: 5,  5
P@20: 65.9190	MRR@20: 28.3917	Epoch: 5,  5
Best Result:
	P@20:	65.9190	MRR@20:	28.3917	Epoch:	5,	5
-------------------------------------------------------
epoch:  6
start training:  2026-02-05 19:50:22.769549
contrastive_weight: 1.0
[0/11242] Loss: 6.5692
[2249/11242] Loss: 6.5228
[4498/11242] Loss: 6.9336
[6747/11242] Loss: 7.4294
[8996/11242] Loss: 7.2070
	Loss:	76713.312
start predicting:  2026-02-05 20:06:29.079834
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6674	Epoch: 6,  6
P@20: 65.9190	MRR@20: 28.4005	Epoch: 5,  6
Best Result:
	P@20:	65.9190	MRR@20:	28.4005	Epoch:	5,	6
-------------------------------------------------------
epoch:  7
start training:  2026-02-05 20:07:39.761219
contrastive_weight: 1.0
[0/11242] Loss: 7.0255
[2249/11242] Loss: 6.7923
[4498/11242] Loss: 6.3431
[6747/11242] Loss: 6.3527
[8996/11242] Loss: 6.7658
	Loss:	75846.367
start predicting:  2026-02-05 20:23:46.721230
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6674	Epoch: 6,  6
P@20: 66.0045	MRR@20: 28.4005	Epoch: 7,  6
Best Result:
	P@20:	66.0045	MRR@20:	28.4005	Epoch:	7,	6
-------------------------------------------------------
epoch:  8
start training:  2026-02-05 20:24:56.684492
contrastive_weight: 1.0
[0/11242] Loss: 6.7520
[2249/11242] Loss: 6.0775
[4498/11242] Loss: 6.8782
[6747/11242] Loss: 6.4293
[8996/11242] Loss: 7.1081
	Loss:	75319.258
start predicting:  2026-02-05 20:41:08.767293
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6832	Epoch: 6,  8
P@20: 66.0045	MRR@20: 28.4222	Epoch: 7,  8
Best Result:
	P@20:	66.0045	MRR@20:	28.4222	Epoch:	7,	8
-------------------------------------------------------
epoch:  9
start training:  2026-02-05 20:42:18.011848
contrastive_weight: 1.0
[0/11242] Loss: 6.5282
[2249/11242] Loss: 7.1219
[4498/11242] Loss: 6.2813
[6747/11242] Loss: 7.0928
[8996/11242] Loss: 6.6369
	Loss:	74919.797
start predicting:  2026-02-05 20:58:21.406573
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6832	Epoch: 6,  8
P@20: 66.0045	MRR@20: 28.4222	Epoch: 7,  8
Best Result:
	P@20:	66.0045	MRR@20:	28.4222	Epoch:	7,	8
-------------------------------------------------------
epoch:  10
start training:  2026-02-05 20:59:30.865711
contrastive_weight: 1.0
[0/11242] Loss: 6.3745
[2249/11242] Loss: 6.7908
[4498/11242] Loss: 6.3616
[6747/11242] Loss: 6.0578
[8996/11242] Loss: 7.1552
	Loss:	73413.734
start predicting:  2026-02-05 21:15:34.707808
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6832	Epoch: 6,  8
P@20: 66.0045	MRR@20: 28.4222	Epoch: 7,  8
Best Result:
	P@20:	66.0045	MRR@20:	28.4222	Epoch:	7,	8
-------------------------------------------------------
epoch:  11
start training:  2026-02-05 21:16:44.111062
contrastive_weight: 1.0
[0/11242] Loss: 6.8368
[2249/11242] Loss: 5.2046
[4498/11242] Loss: 6.6412
[6747/11242] Loss: 6.6414
[8996/11242] Loss: 6.3370
	Loss:	73281.008
start predicting:  2026-02-05 21:32:46.732146
P@5: 44.0271	MRR@5: 26.1366	Epoch: 5,  5
P@10: 55.4257	MRR@10: 27.6832	Epoch: 6,  8
P@20: 66.0045	MRR@20: 28.4222	Epoch: 7,  8
Best Result:
	P@20:	66.0045	MRR@20:	28.4222	Epoch:	7,	8
-------------------------------------------------------
Run time: 12302.666558 s
Traceback (most recent call last):
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 181, in <module>
    main()
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 165, in main
    torch.save(model, PATH)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 810, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 781, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name, _compute_crc32))
RuntimeError: Parent directory ./final_model does not exist.
