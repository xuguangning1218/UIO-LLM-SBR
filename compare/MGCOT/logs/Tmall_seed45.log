/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py:66: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:644.)
  sparse_matrix = torch.sparse.LongTensor(i, v, torch.Size(shape))
Namespace(dataset='Tmall', batchSize=64, hiddenSize=100, epoch=15, lr=0.001, lr_dc=0.1, lr_dc_step=5, l2=1e-05, step=1, patience=3, nonhybrid=False, validation=False, valid_portion=0.1, w_ne=1.7, gama=1.7, seed=45, num_attention_heads=5, neighbor_n=3, contrastive_weight=1.0)
random_seed: 45
self.neighbor: 3
-------------------------------------------------------
epoch:  0
start training:  2026-02-06 06:31:27.232275
contrastive_weight: 1.0
[0/5489] Loss: 21.3112
[1098/5489] Loss: 11.4475
[2196/5489] Loss: 10.8547
[3294/5489] Loss: 10.5549
[4392/5489] Loss: 10.5526
	Loss:	60572.863
start predicting:  2026-02-06 06:38:13.392086
P@5: 25.8437	MRR@5: 17.0067	Epoch: 0,  0
P@10: 30.5738	MRR@10: 17.6484	Epoch: 0,  0
P@20: 34.8444	MRR@20: 17.9476	Epoch: 0,  0
Best Result:
	P@20:	34.8444	MRR@20:	17.9476	Epoch:	0,	0
-------------------------------------------------------
epoch:  1
start training:  2026-02-06 06:38:44.606057
contrastive_weight: 1.0
[0/5489] Loss: 8.4104
[1098/5489] Loss: 8.1894
[2196/5489] Loss: 7.7990
[3294/5489] Loss: 8.0887
[4392/5489] Loss: 8.2758
	Loss:	46346.590
start predicting:  2026-02-06 06:45:28.422038
P@5: 29.2223	MRR@5: 18.2011	Epoch: 1,  1
P@10: 36.0723	MRR@10: 19.1247	Epoch: 1,  1
P@20: 41.7716	MRR@20: 19.5235	Epoch: 1,  1
Best Result:
	P@20:	41.7716	MRR@20:	19.5235	Epoch:	1,	1
-------------------------------------------------------
epoch:  2
start training:  2026-02-06 06:45:59.714459
contrastive_weight: 1.0
[0/5489] Loss: 7.2660
[1098/5489] Loss: 6.9043
[2196/5489] Loss: 7.4755
[3294/5489] Loss: 7.8018
[4392/5489] Loss: 8.0116
	Loss:	41873.996
start predicting:  2026-02-06 06:52:44.777051
P@5: 29.2223	MRR@5: 18.2011	Epoch: 1,  1
P@10: 36.0723	MRR@10: 19.1247	Epoch: 1,  1
P@20: 42.2002	MRR@20: 19.5235	Epoch: 2,  1
Best Result:
	P@20:	42.2002	MRR@20:	19.5235	Epoch:	2,	1
-------------------------------------------------------
epoch:  3
start training:  2026-02-06 06:53:16.006049
contrastive_weight: 1.0
[0/5489] Loss: 6.7046
[1098/5489] Loss: 7.5664
[2196/5489] Loss: 7.6538
[3294/5489] Loss: 7.5545
[4392/5489] Loss: 8.2256
	Loss:	39860.129
start predicting:  2026-02-06 06:59:59.956233
P@5: 29.2223	MRR@5: 18.2011	Epoch: 1,  1
P@10: 36.0723	MRR@10: 19.1247	Epoch: 1,  1
P@20: 42.2002	MRR@20: 19.5235	Epoch: 2,  1
Best Result:
	P@20:	42.2002	MRR@20:	19.5235	Epoch:	2,	1
-------------------------------------------------------
epoch:  4
start training:  2026-02-06 07:00:31.501406
contrastive_weight: 1.0
[0/5489] Loss: 6.6584
[1098/5489] Loss: 6.9430
[2196/5489] Loss: 6.9405
[3294/5489] Loss: 7.1788
[4392/5489] Loss: 7.1335
	Loss:	38539.656
start predicting:  2026-02-06 07:07:11.544580
P@5: 29.2223	MRR@5: 18.2011	Epoch: 1,  1
P@10: 36.0723	MRR@10: 19.1247	Epoch: 1,  1
P@20: 42.2002	MRR@20: 19.5235	Epoch: 2,  1
Best Result:
	P@20:	42.2002	MRR@20:	19.5235	Epoch:	2,	1
-------------------------------------------------------
epoch:  5
start training:  2026-02-06 07:07:42.437638
contrastive_weight: 1.0
[0/5489] Loss: 6.3109
[1098/5489] Loss: 6.1625
[2196/5489] Loss: 6.4655
[3294/5489] Loss: 6.1044
[4392/5489] Loss: 6.3155
	Loss:	33481.773
start predicting:  2026-02-06 07:14:22.872341
P@5: 29.2223	MRR@5: 18.2011	Epoch: 1,  1
P@10: 36.0723	MRR@10: 19.1247	Epoch: 1,  1
P@20: 42.2002	MRR@20: 19.5235	Epoch: 2,  1
Best Result:
	P@20:	42.2002	MRR@20:	19.5235	Epoch:	2,	1
-------------------------------------------------------
Run time: 2608.141471 s
Traceback (most recent call last):
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 181, in <module>
    main()
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 165, in main
    torch.save(model, PATH)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 810, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 781, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name, _compute_crc32))
RuntimeError: Parent directory ./final_model does not exist.
