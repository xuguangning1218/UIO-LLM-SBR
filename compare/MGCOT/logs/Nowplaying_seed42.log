/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py:66: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:644.)
  sparse_matrix = torch.sparse.LongTensor(i, v, torch.Size(shape))
Namespace(dataset='Nowplaying', batchSize=64, hiddenSize=100, epoch=15, lr=0.001, lr_dc=0.1, lr_dc_step=5, l2=1e-05, step=1, patience=3, nonhybrid=False, validation=False, valid_portion=0.1, w_ne=1.7, gama=1.7, seed=42, num_attention_heads=5, neighbor_n=3, contrastive_weight=1.0)
random_seed: 42
self.neighbor: 3
-------------------------------------------------------
epoch:  0
start training:  2026-02-06 07:15:07.059342
contrastive_weight: 1.0
[0/12896] Loss: 22.5552
[2580/12896] Loss: 12.7030
[5160/12896] Loss: 12.9656
[7740/12896] Loss: 11.8707
[10320/12896] Loss: 11.5755
	Loss:	155247.469
start predicting:  2026-02-06 07:30:26.163265
P@5: 18.5941	MRR@5: 11.6756	Epoch: 0,  0
P@10: 23.4826	MRR@10: 12.3255	Epoch: 0,  0
P@20: 28.4189	MRR@20: 12.6677	Epoch: 0,  0
Best Result:
	P@20:	28.4189	MRR@20:	12.6677	Epoch:	0,	0
-------------------------------------------------------
epoch:  1
start training:  2026-02-06 07:32:00.746906
contrastive_weight: 1.0
[0/12896] Loss: 10.2281
[2580/12896] Loss: 10.0707
[5160/12896] Loss: 9.2498
[7740/12896] Loss: 11.0900
[10320/12896] Loss: 10.0422
	Loss:	132953.234
start predicting:  2026-02-06 07:47:15.547514
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7039	Epoch: 1,  1
P@20: 33.4053	MRR@20: 14.1390	Epoch: 1,  1
Best Result:
	P@20:	33.4053	MRR@20:	14.1390	Epoch:	1,	1
-------------------------------------------------------
epoch:  2
start training:  2026-02-06 07:48:49.745604
contrastive_weight: 1.0
[0/12896] Loss: 9.3789
[2580/12896] Loss: 9.3253
[5160/12896] Loss: 10.4306
[7740/12896] Loss: 10.3169
[10320/12896] Loss: 9.3219
	Loss:	125945.570
start predicting:  2026-02-06 08:04:00.501726
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7039	Epoch: 1,  1
P@20: 33.6903	MRR@20: 14.1390	Epoch: 2,  1
Best Result:
	P@20:	33.6903	MRR@20:	14.1390	Epoch:	2,	1
-------------------------------------------------------
epoch:  3
start training:  2026-02-06 08:05:34.560974
contrastive_weight: 1.0
[0/12896] Loss: 8.7834
[2580/12896] Loss: 9.2091
[5160/12896] Loss: 9.6448
[7740/12896] Loss: 10.3646
[10320/12896] Loss: 10.4289
	Loss:	121721.258
start predicting:  2026-02-06 08:20:50.057066
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7039	Epoch: 1,  1
P@20: 33.6903	MRR@20: 14.1390	Epoch: 2,  1
Best Result:
	P@20:	33.6903	MRR@20:	14.1390	Epoch:	2,	1
-------------------------------------------------------
epoch:  4
start training:  2026-02-06 08:22:24.527942
contrastive_weight: 1.0
[0/12896] Loss: 9.3950
[2580/12896] Loss: 9.3691
[5160/12896] Loss: 8.8434
[7740/12896] Loss: 10.2695
[10320/12896] Loss: 9.0783
	Loss:	118813.039
start predicting:  2026-02-06 08:37:34.469082
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7039	Epoch: 1,  1
P@20: 33.6903	MRR@20: 14.1390	Epoch: 2,  1
Best Result:
	P@20:	33.6903	MRR@20:	14.1390	Epoch:	2,	1
-------------------------------------------------------
epoch:  5
start training:  2026-02-06 08:39:12.038413
contrastive_weight: 1.0
[0/12896] Loss: 8.4203
[2580/12896] Loss: 8.9998
[5160/12896] Loss: 8.5935
[7740/12896] Loss: 8.5858
[10320/12896] Loss: 8.8025
	Loss:	107405.789
start predicting:  2026-02-06 08:54:34.812758
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7243	Epoch: 1,  5
P@20: 33.7115	MRR@20: 14.1984	Epoch: 5,  5
Best Result:
	P@20:	33.7115	MRR@20:	14.1984	Epoch:	5,	5
-------------------------------------------------------
epoch:  6
start training:  2026-02-06 08:56:10.512355
contrastive_weight: 1.0
[0/12896] Loss: 7.7929
[2580/12896] Loss: 7.6916
[5160/12896] Loss: 8.6160
[7740/12896] Loss: 8.2067
[10320/12896] Loss: 8.1944
	Loss:	103938.352
start predicting:  2026-02-06 09:11:28.097558
P@5: 21.1892	MRR@5: 12.9110	Epoch: 1,  1
P@10: 27.1008	MRR@10: 13.7243	Epoch: 1,  5
P@20: 33.7115	MRR@20: 14.1984	Epoch: 5,  5
Best Result:
	P@20:	33.7115	MRR@20:	14.1984	Epoch:	5,	5
-------------------------------------------------------
Run time: 7077.949217 s
Traceback (most recent call last):
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 181, in <module>
    main()
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 165, in main
    torch.save(model, PATH)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 810, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 781, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name, _compute_crc32))
RuntimeError: Parent directory ./final_model does not exist.
