/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py:66: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:644.)
  sparse_matrix = torch.sparse.LongTensor(i, v, torch.Size(shape))
Namespace(dataset='Tmall', batchSize=64, hiddenSize=100, epoch=15, lr=0.001, lr_dc=0.1, lr_dc_step=5, l2=1e-05, step=1, patience=3, nonhybrid=False, validation=False, valid_portion=0.1, w_ne=1.7, gama=1.7, seed=44, num_attention_heads=5, neighbor_n=3, contrastive_weight=1.0)
random_seed: 44
self.neighbor: 3
-------------------------------------------------------
epoch:  0
start training:  2026-02-06 06:22:01.448284
contrastive_weight: 1.0
[0/5489] Loss: 21.6418
[1098/5489] Loss: 12.1225
[2196/5489] Loss: 10.6241
[3294/5489] Loss: 10.4345
[4392/5489] Loss: 10.8848
	Loss:	61084.043
start predicting:  2026-02-06 06:28:42.458456
P@5: 25.5580	MRR@5: 16.3529	Epoch: 0,  0
P@10: 30.3576	MRR@10: 17.0016	Epoch: 0,  0
P@20: 34.7865	MRR@20: 17.3098	Epoch: 0,  0
Best Result:
	P@20:	34.7865	MRR@20:	17.3098	Epoch:	0,	0
-------------------------------------------------------
epoch:  1
start training:  2026-02-06 06:29:13.476977
contrastive_weight: 1.0
[0/5489] Loss: 8.1507
[1098/5489] Loss: 8.5770
[2196/5489] Loss: 8.5848
[3294/5489] Loss: 8.3586
[4392/5489] Loss: 9.8767
	Loss:	47413.398
start predicting:  2026-02-06 06:35:56.631063
P@5: 29.8093	MRR@5: 18.5480	Epoch: 1,  1
P@10: 36.3580	MRR@10: 19.4287	Epoch: 1,  1
P@20: 42.3662	MRR@20: 19.8436	Epoch: 1,  1
Best Result:
	P@20:	42.3662	MRR@20:	19.8436	Epoch:	1,	1
-------------------------------------------------------
epoch:  2
start training:  2026-02-06 06:36:27.802393
contrastive_weight: 1.0
[0/5489] Loss: 8.0336
[1098/5489] Loss: 6.8998
[2196/5489] Loss: 7.2797
[3294/5489] Loss: 8.1909
[4392/5489] Loss: 7.9742
	Loss:	42872.363
start predicting:  2026-02-06 06:43:08.325464
P@5: 29.8093	MRR@5: 18.5480	Epoch: 1,  1
P@10: 36.7596	MRR@10: 19.4287	Epoch: 2,  1
P@20: 43.2273	MRR@20: 19.8436	Epoch: 2,  1
Best Result:
	P@20:	43.2273	MRR@20:	19.8436	Epoch:	2,	1
-------------------------------------------------------
epoch:  3
start training:  2026-02-06 06:43:39.691266
contrastive_weight: 1.0
[0/5489] Loss: 7.6432
[1098/5489] Loss: 7.2439
[2196/5489] Loss: 7.0117
[3294/5489] Loss: 7.2582
[4392/5489] Loss: 7.1917
	Loss:	40760.461
start predicting:  2026-02-06 06:50:21.392075
P@5: 29.8093	MRR@5: 18.5480	Epoch: 1,  1
P@10: 36.7596	MRR@10: 19.4287	Epoch: 2,  1
P@20: 43.2273	MRR@20: 19.8436	Epoch: 2,  1
Best Result:
	P@20:	43.2273	MRR@20:	19.8436	Epoch:	2,	1
-------------------------------------------------------
epoch:  4
start training:  2026-02-06 06:50:52.525554
contrastive_weight: 1.0
[0/5489] Loss: 6.6530
[1098/5489] Loss: 8.2622
[2196/5489] Loss: 6.8441
[3294/5489] Loss: 6.8140
[4392/5489] Loss: 7.1228
	Loss:	39316.750
start predicting:  2026-02-06 06:57:34.152999
P@5: 29.8093	MRR@5: 18.5480	Epoch: 1,  1
P@10: 36.7596	MRR@10: 19.4287	Epoch: 2,  1
P@20: 43.2273	MRR@20: 19.8436	Epoch: 2,  1
Best Result:
	P@20:	43.2273	MRR@20:	19.8436	Epoch:	2,	1
-------------------------------------------------------
epoch:  5
start training:  2026-02-06 06:58:05.357647
contrastive_weight: 1.0
[0/5489] Loss: 6.3664
[1098/5489] Loss: 5.8321
[2196/5489] Loss: 6.5823
[3294/5489] Loss: 5.2348
[4392/5489] Loss: 6.3347
	Loss:	33956.055
start predicting:  2026-02-06 07:04:44.022449
P@5: 29.8093	MRR@5: 18.5480	Epoch: 1,  1
P@10: 36.7596	MRR@10: 19.4287	Epoch: 2,  1
P@20: 43.2273	MRR@20: 19.8436	Epoch: 2,  1
Best Result:
	P@20:	43.2273	MRR@20:	19.8436	Epoch:	2,	1
-------------------------------------------------------
Run time: 2594.510769 s
Traceback (most recent call last):
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 181, in <module>
    main()
  File "/home/guangxu/work/UIO-SBR/compare/MGCOT/main.py", line 165, in main
    torch.save(model, PATH)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 810, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/guangxu/miniconda3/envs/sbr/lib/python3.10/site-packages/torch/serialization.py", line 781, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name, _compute_crc32))
RuntimeError: Parent directory ./final_model does not exist.
